---
output: html_document
editor_options: 
  chunk_output_type: console
---

## R Markdown

This is an R Markdown document where data from Acropora_manipulation_2021 was read in (logged values of respiration and gross photosynthesis rates in 3 genotypes of acropora over an 8 temperature heat-stress experiment) and analyzed as Thermal Performance Curves (TPC) and performance metrics (E, Eh, Topt, Th, Pmax, and lnc). Raw data was collected in April 2017 at the University of North Carolina at Chapel Hill for Katelyn Gould's dissertation research. Raw data includes oxygen evolution during a light and dark respirometry incubation over multiple assay temperatures (heat-stress methodology). Corals were acclimatized at UNC for 2 months and underwent various treatments, overhead sprinkler designed to refract light intensity under temperature stress, and assisted feeding with the addition of submersible lights. The aim of this research was to identify if these manipulations would ease thermal stress by reducing bleaching severity and maintain metabolic rates. 

Libraries

```{r}
library(tidyverse) #data wrangling & cleaning incl. ggplot
library(janitor) # more data cleaning functions
library(kableExtra) # making pretty tables
library(cowplot) # making publication quality figures or multi-panel figures
library(skimr) # tool to get quick overview of dataset
library(measurements) # useful to convert units
library(readr)
library(esquisse)
library(rvg)
library(car)
library(ggpubr)
library(plotrix)
library(mvnormtest)
library("dunn.test")
library(effects)
library(Rmisc)
library(rstatix)
library(dplyr)
library(boot)
library(car)
library(rTPC)
library(nls.multstart)
library(broom)
library(patchwork)
library(minpack.lm)

```

Working Directory
load data

```{r}


setwd("C:/Github/TPC_Acropora/")
getwd()

mydata_M50Cd<-read.csv("C:/Github/TPC_Acropora/R_output_Data_Frames/mydata_M50Cd.csv")

str(mydata_M50Cd)


treat1<-mydata_M50Cd%>%
  filter(treatment=="T1")
treat2<-mydata_M50Cd%>%
  filter(treatment=="T2")
treat3<-mydata_M50Cd%>%
  filter(treatment=="T3")
treatC<-mydata_M50Cd%>%
  filter(treatment=="C")

#write.csv(treat1, "C:/Github/TPC_Acropora/R_output_Data_Frames/treat1.csv")
#write.csv(treat2, "C:/Github/TPC_Acropora/R_output_Data_Frames/treat2.csv")
#write.csv(treat3, "C:/Github/TPC_Acropora/R_output_Data_Frames/treat3.csv")
#write.csv(treatC, "C:/Github/TPC_Acropora/R_output_Data_Frames/treatC.csv")
```

Fit schoolfield_High model for treatment*genotype- Bootstraps

```{r}
#treatment, rate.type, genotype
#treatment,genotype,rate.type
# run nls.multstart on each curve of the original data ####
fit_many_test <- group_by(mydata_M50Cd,treatment,genotype,rate.type) %>%
  nest() %>%
  mutate(., fit = purrr::map(data, ~nls_multstart(log.rate ~ schoolfield_high(lnc, E, Eh, Th, temp = K, Tc = 20),
                                   data = .x,
                                   iter = 500,
                                   start_lower = c(lnc = -10, E = 0.1, Eh = 0.2, Th = 285),
                                   start_upper = c(lnc = 10, E = 2, Eh = 5, Th = 330),
                                   supp_errors = 'Y',
                                   na.action = na.omit,
                                   lower = c(lnc = -10, E = 0, Eh = 0, Th = 0))))

# run bootstrap over many curves ####
boot_many <- group_by(mydata_M50Cd, treatment, genotype, rate.type) %>%
  # create 200 bootstrap replicates per curve
  do(., boot = modelr::bootstrap(., n = 2, id = 'boot_num')) %>%
  # unnest to show bootstrap number, .id
  unnest() %>%
  # regroup to include the boot_num
  group_by(., treatment, genotype, rate.type, boot_num) %>%
  # run the model using map()
  mutate(fit = map(strap, ~nls_multstart(log.rate ~ schoolfield_high(lnc, E, Eh, Th, temp = K, Tc = 20),
                        data = data.frame(.),
                        iter = 50,
                        start_lower = c(lnc = -10, E = 0.1, Eh = 0.2, Th = 285),
                        start_upper = c(lnc = 10, E = 2, Eh = 5, Th = 330),
                        lower = c(lnc=-10, E=0, Eh=0, Th=0),
                        supp_errors = 'Y')
))
```

Bootstraps treatment*genotype-

```{r}
# new data frame for smooth predictions
new_preds <- mydata_M50Cd %>%
  do(., data.frame(K = seq(min(.$K), max(.$K), length.out = 150), stringsAsFactors = FALSE))

# get max and min for each curve ### 
max_min <- group_by(mydata_M50Cd, treatment, genotype, rate.type) %>%
    dplyr::summarise(., min_K = min(K), max_K = max(K)) %>%
  ungroup()

# create smoother predictions for unbootstrapped models
preds_many <- fit_many %>%
  unnest_legacy(fit %>% map(augment, newdata = new_preds))

# create smoother predictions for bootstrapped replicates
# CODE IS ERRORRED OUT HERE CHECK 1/20/2021 https://padpadpadpad.github.io/post/bootstrapping-non-linear-regressions-with-purrr/
# Fixed error 1/27/2021- grouping error
preds_many <- boot_many %>%
   unnest_legacy(fit %>% map(augment, newdata = new_preds)) %>%
  ungroup() %>%
  # group by each value of K and get quantiles
  group_by(., treatment, genotype, rate.type, K) %>%
  dplyr::summarise(lwr_CI = quantile(.fitted, 0.025),
            upr_CI = quantile(.fitted, 0.975)) %>%
  ungroup() %>%
  merge(., preds_many, by = c("K", "treatment", "genotype", "rate.type")) %>%
  # merge with max_min to delete predictions outside of the max and min temperatures of each curve
  merge(., max_min, by = c("treatment", "genotype", "rate.type")) %>%
  group_by(., treatment, genotype, rate.type) %>%
  filter(., K >= unique(min_K) & K <= unique(max_K))  %>%
  ungroup()

preds_many<-preds_many%>% 
 dplyr::rename(
     log.rate=.fitted)

#write.csv(preds_many, "C:/Github/TPC_Acropora/R_output_Data_Frames/preds_many.csv")



```

Fit schoolfield_High model for treatment*genotype*fragment.ID-

```{r}
fit_manyFrag <- group_by(mydata_M50Cd,treatment,genotype, fragment.ID, rate.type) %>%
  nest() %>%
  dplyr::mutate(., fit = purrr::map(data, ~nls_multstart(log.rate ~ schoolfield_high(lnc, E, Eh, Th, temp = K, Tc = 20),
                                   data = .x,
                                   iter = 500,
                                   start_lower = c(lnc = -10, E = 0.1, Eh = 0.2, Th = 285),
                                   start_upper = c(lnc = 10, E = 2, Eh = 5, Th = 330),
                                   supp_errors = 'Y',
                                   na.action = na.omit,
                                   lower = c(lnc = -10, E = 0, Eh = 0, Th = 0))))

# run bootstrap over many curves ####
boot_manyFrag <- group_by(mydata_M50Cd, treatment, genotype, fragment.ID, rate.type) %>%
  # create 200 bootstrap replicates per curve
  do(., boot = modelr::bootstrap(., n = 20, id = 'boot_num')) %>%
  # unnest to show bootstrap number, .id
  unnest() %>%
  # regroup to include the boot_num
  group_by(., treatment, genotype, rate.type, fragment.ID, boot_num) %>%
  # run the model using map()
  mutate(fit = map(strap, ~nls_multstart(log.rate ~ schoolfield_high(lnc, E, Eh, Th, temp = K, Tc = 20),
                        data = data.frame(.),
                        iter = 50,
                        start_lower = c(lnc = -10, E = 0.1, Eh = 0.2, Th = 285),
                        start_upper = c(lnc = 10, E = 2, Eh = 5, Th = 330),
                        lower = c(lnc=-10, E=0, Eh=0, Th=0),
                        supp_errors = 'Y')
  ))
```

Bootstraps treatment*genotype*fragment.ID-

```{r}
# new data frame for smooth predictions
new_predsFrag <- mydata_M50Cd %>%
  do(., data.frame(K = seq(min(.$K), max(.$K), length.out = 150), stringsAsFactors = FALSE))

# get max and min for each curve ### 
max_minFrag <- group_by(mydata_M50Cd, treatment, genotype, fragment.ID, rate.type) %>%
    dplyr::summarise(., min_K = min(K), max_K = max(K)) %>%
  ungroup()

# create smoother predictions for unbootstrapped models
preds_manyFrag <- fit_manyFrag %>%
  unnest_legacy(fit %>% map(augment, newdata = new_predsFrag))

# create smoother predictions for bootstrapped replicates
# CODE IS ERRORRED OUT HERE CHECK 1/20/2021 https://padpadpadpad.github.io/post/bootstrapping-non-linear-regressions-with-purrr/
# Fixed error 1/27/2021- grouping error
preds_manyFrag <- boot_manyFrag %>%
   unnest_legacy(fit %>% map(augment, newdata = new_predsFrag)) %>%
  ungroup() %>%
  # group by each value of K and get quantiles
  group_by(., treatment, genotype, fragment.ID, rate.type, K) %>%
  dplyr::summarise(lwr_CI = quantile(.fitted, 0.025),
            upr_CI = quantile(.fitted, 0.975)) %>%
  ungroup() %>%
  merge(., preds_manyFrag, by = c("K", "treatment", "genotype", "fragment.ID", "rate.type")) %>%
  # merge with max_min to delete predictions outside of the max and min temperatures of each curve
  merge(., max_minFrag, by = c("treatment", "genotype", "fragment.ID", "rate.type")) %>%
  group_by(., treatment, genotype, fragment.ID, rate.type) %>%
  filter(., K >= unique(min_K) & K <= unique(max_K))  %>%
  ungroup()

preds_manyFrag<-preds_manyFrag%>% 
 dplyr::rename(
     log.rate=.fitted)

#write.csv(preds_manyFrag, "C:/Github/TPC_Acropora/R_output_Data_Frames/preds_manyFrag.csv")

```

Filtering predictions to treatment and genotype and fragment.ID

```{r}

  avgmydata_M50Cd <- mydata_M50Cd%>%
  group_by(temp.Cat,treatment, genotype, rate.type) %>%
  dplyr::summarise(., sd = sd(log.rate),
            ave_rate = mean(log.rate))

avgmydata_M50Cd

preds_manyFrag<-read.csv("C:/Github/TPC_Acropora/R_output_Data_Frames/preds_manyFrag.csv")
preds_manyFrag

treat1Frag<-preds_manyFrag%>%
  filter(treatment=="T1")
treat2Frag<-preds_manyFrag%>%
  filter(treatment=="T2")
treat3Frag<-preds_manyFrag%>%
  filter(treatment=="T3")
treatCFrag<-preds_manyFrag%>%
  filter(treatment=="C")

#write.csv(treat1Frag, "C:/Github/TPC_Acropora/R_output_Data_Frames/treat1FragP.csv")
#write.csv(treat2Frag, "C:/Github/TPC_Acropora/R_output_Data_Frames/treat2FragP.csv")
#write.csv(treat3Frag, "C:/Github/TPC_Acropora/R_output_Data_Frames/treat3FragP.csv")
#write.csv(treatCFrag, "C:/Github/TPC_Acropora/R_output_Data_Frames/treatCFragP.csv")
#predicted data

treat1FGP<-treat1Frag%>%
  filter(rate.type=="GP")
treat2FGP<-treat2Frag%>%
  filter(rate.type=="GP")
treat3FGP<-treat3Frag%>%
  filter(rate.type=="GP")
treatCFGP<-treatCFrag%>%
  filter(rate.type=="GP")

treat1FGR<-treat1Frag%>%
  filter(rate.type=="R")
treat2FGR<-treat2Frag%>%
  filter(rate.type=="R")
treat3FGR<-treat3Frag%>%
  filter(rate.type=="R")
treatCFGR<-treatCFrag%>%
  filter(rate.type=="R")

#raw data
treat1GP<-treat1%>%
  filter(rate.type=="GP")
treat2GP<-treat2%>%
  filter(rate.type=="GP")
treat3GP<-treat3%>%
  filter(rate.type=="GP")
treatCGP<-treatC%>%
  filter(rate.type=="GP")

treat1GR<-treat1%>%
  filter(rate.type=="R")
treat2GR<-treat2%>%
  filter(rate.type=="R")
treat3GR<-treat3%>%
  filter(rate.type=="R")
treatCGR<-treatC%>%
  filter(rate.type=="R")
```

Fragment Filter

```{r}

#treat1GP
K201aGP<-treat1GP%>%filter(fragment.ID=="K201a")
K201bGP<-treat1GP%>%filter(fragment.ID=="K201b")
K201cGP<-treat1GP%>%filter(fragment.ID=="K201c")
K201dGP<-treat1GP%>%filter(fragment.ID=="K201d")
M501aGP<-treat1GP%>%filter(fragment.ID=="M501a")
M501bGP<-treat1GP%>%filter(fragment.ID=="M501b")
M501cGP<-treat1GP%>%filter(fragment.ID=="M501c")
M501dGP<-treat1GP%>%filter(fragment.ID=="M501d")
M601aGP<-treat1GP%>%filter(fragment.ID=="M601a")
M601bGP<-treat1GP%>%filter(fragment.ID=="M601b")
M601cGP<-treat1GP%>%filter(fragment.ID=="M601c")
M601dGP<-treat1GP%>%filter(fragment.ID=="M601d")
#treat2GP
K202aGP<-treat2GP%>%filter(fragment.ID=="K202a")
K202bGP<-treat2GP%>%filter(fragment.ID=="K202b")
K202cGP<-treat2GP%>%filter(fragment.ID=="K202c")
K202dGP<-treat2GP%>%filter(fragment.ID=="K202d")
M502aGP<-treat2GP%>%filter(fragment.ID=="M502a")
M502bGP<-treat2GP%>%filter(fragment.ID=="M502b")
M502cGP<-treat2GP%>%filter(fragment.ID=="M502c")
M502dGP<-treat2GP%>%filter(fragment.ID=="M502d")
M602aGP<-treat2GP%>%filter(fragment.ID=="M602a")
M602bGP<-treat2GP%>%filter(fragment.ID=="M602b")
M602cGP<-treat2GP%>%filter(fragment.ID=="M602c")
M602dGP<-treat2GP%>%filter(fragment.ID=="M602d")
#treat3GP
K203aGP<-treat3GP%>%filter(fragment.ID=="K203a")
K203bGP<-treat3GP%>%filter(fragment.ID=="K203b")
K203cGP<-treat3GP%>%filter(fragment.ID=="K203c")
K203dGP<-treat3GP%>%filter(fragment.ID=="K203d")
M503aGP<-treat3GP%>%filter(fragment.ID=="M503a")
M503bGP<-treat3GP%>%filter(fragment.ID=="M503b")
M503cGP<-treat3GP%>%filter(fragment.ID=="M503c")
M503dGP<-treat3GP%>%filter(fragment.ID=="M503d")
M603aGP<-treat3GP%>%filter(fragment.ID=="M603a")
M603bGP<-treat3GP%>%filter(fragment.ID=="M603b")
M603cGP<-treat3GP%>%filter(fragment.ID=="M603c")
M603dGP<-treat3GP%>%filter(fragment.ID=="M603d")
#treatCGP
K20CaGP<-treatCGP%>%filter(fragment.ID=="K20Ca")
K20CbGP<-treatCGP%>%filter(fragment.ID=="K20Cb")
K20CcGP<-treatCGP%>%filter(fragment.ID=="K20Cc")
K20CdGP<-treatCGP%>%filter(fragment.ID=="K20Cd")
M50CaGP<-treatCGP%>%filter(fragment.ID=="M50Ca")
M50CbGP<-treatCGP%>%filter(fragment.ID=="M50Cb")
M50CcGP<-treatCGP%>%filter(fragment.ID=="M50Cc")
#M50CdGP<-treatCGP%>%filter(fragment.ID=="M50Cd")
M60CaGP<-treatCGP%>%filter(fragment.ID=="M60Ca")
M60CbGP<-treatCGP%>%filter(fragment.ID=="M60Cb")
M60CcGP<-treatCGP%>%filter(fragment.ID=="M60Cc")
M60CdGP<-treatCGP%>%filter(fragment.ID=="M60Cd")
#treat1GR
K201aGR<-treat1GR%>%filter(fragment.ID=="K201a")
K201bGR<-treat1GR%>%filter(fragment.ID=="K201b")
K201cGR<-treat1GR%>%filter(fragment.ID=="K201c")
K201dGR<-treat1GR%>%filter(fragment.ID=="K201d")
M501aGR<-treat1GR%>%filter(fragment.ID=="M501a")
M501bGR<-treat1GR%>%filter(fragment.ID=="M501b")
M501cGR<-treat1GR%>%filter(fragment.ID=="M501c")
M501dGR<-treat1GR%>%filter(fragment.ID=="M501d")
M601aGR<-treat1GR%>%filter(fragment.ID=="M601a")
M601bGR<-treat1GR%>%filter(fragment.ID=="M601b")
M601cGR<-treat1GR%>%filter(fragment.ID=="M601c")
M601dGR<-treat1GR%>%filter(fragment.ID=="M601d")
#treat2GR
K202aGR<-treat2GR%>%filter(fragment.ID=="K202a")
K202bGR<-treat2GR%>%filter(fragment.ID=="K202b")
K202cGR<-treat2GR%>%filter(fragment.ID=="K202c")
K202dGR<-treat2GR%>%filter(fragment.ID=="K202d")
M502aGR<-treat2GR%>%filter(fragment.ID=="M502a")
M502bGR<-treat2GR%>%filter(fragment.ID=="M502b")
M502cGR<-treat2GR%>%filter(fragment.ID=="M502c")
M502dGR<-treat2GR%>%filter(fragment.ID=="M502d")
M602aGR<-treat2GR%>%filter(fragment.ID=="M602a")
M602bGR<-treat2GR%>%filter(fragment.ID=="M602b")
M602cGR<-treat2GR%>%filter(fragment.ID=="M602c")
M602dGR<-treat2GR%>%filter(fragment.ID=="M602d")
#treat3GR
K203aGR<-treat3GR%>%filter(fragment.ID=="K203a")
K203bGR<-treat3GR%>%filter(fragment.ID=="K203b")
K203cGR<-treat3GR%>%filter(fragment.ID=="K203c")
K203dGR<-treat3GR%>%filter(fragment.ID=="K203d")
M503aGR<-treat3GR%>%filter(fragment.ID=="M503a")
M503bGR<-treat3GR%>%filter(fragment.ID=="M503b")
M503cGR<-treat3GR%>%filter(fragment.ID=="M503c")
M503dGR<-treat3GR%>%filter(fragment.ID=="M503d")
M603aGR<-treat3GR%>%filter(fragment.ID=="M603a")
M603bGR<-treat3GR%>%filter(fragment.ID=="M603b")
M603cGR<-treat3GR%>%filter(fragment.ID=="M603c")
M603dGR<-treat3GR%>%filter(fragment.ID=="M603d")
#treatCGR
K20CaGR<-treatCGR%>%filter(fragment.ID=="K20Ca")
K20CbGR<-treatCGR%>%filter(fragment.ID=="K20Cb")
K20CcGR<-treatCGR%>%filter(fragment.ID=="K20Cc")
K20CdGR<-treatCGR%>%filter(fragment.ID=="K20Cd")
M50CaGR<-treatCGR%>%filter(fragment.ID=="M50Ca")
M50CbGR<-treatCGR%>%filter(fragment.ID=="M50Cb")
M50CcGR<-treatCGR%>%filter(fragment.ID=="M50Cc")
M50CdGR<-treatCGR%>%filter(fragment.ID=="M50Cd")
M60CaGR<-treatCGR%>%filter(fragment.ID=="M60Ca")
M60CbGR<-treatCGR%>%filter(fragment.ID=="M60Cb")
M60CcGR<-treatCGR%>%filter(fragment.ID=="M60Cc")
M60CdGR<-treatCGR%>%filter(fragment.ID=="M60Cd")

#All fragments predictions (total 96 curves)
K201aGPFP<-preds_manyFrag%>%filter(fragment.ID=="K201a")
K201bGPFP<-preds_manyFrag%>%filter(fragment.ID=="K201b")
K201cGPFP<-preds_manyFrag%>%filter(fragment.ID=="K201c")
K201dGPFP<-preds_manyFrag%>%filter(fragment.ID=="K201d")
M501aGPFP<-preds_manyFrag%>%filter(fragment.ID=="M501a")
M501bGPFP<-preds_manyFrag%>%filter(fragment.ID=="M501b")
M501cGPFP<-preds_manyFrag%>%filter(fragment.ID=="M501c")
M501dGPFP<-preds_manyFrag%>%filter(fragment.ID=="M501d")
M601aGPFP<-preds_manyFrag%>%filter(fragment.ID=="M601a")
M601bGPFP<-preds_manyFrag%>%filter(fragment.ID=="M601b")
M601cGPFP<-preds_manyFrag%>%filter(fragment.ID=="M601c")
M601dGPFP<-preds_manyFrag%>%filter(fragment.ID=="M601d")
K202aGPFP<-preds_manyFrag%>%filter(fragment.ID=="K202a")
K202bGPFP<-preds_manyFrag%>%filter(fragment.ID=="K202b")
K202cGPFP<-preds_manyFrag%>%filter(fragment.ID=="K202c")
K202dGPFP<-preds_manyFrag%>%filter(fragment.ID=="K202d")
M502aGPFP<-preds_manyFrag%>%filter(fragment.ID=="M502a")
M502bGPFP<-preds_manyFrag%>%filter(fragment.ID=="M502b")
M502cGPFP<-preds_manyFrag%>%filter(fragment.ID=="M502c")
M502dGPFP<-preds_manyFrag%>%filter(fragment.ID=="M502d")
M602aGPFP<-preds_manyFrag%>%filter(fragment.ID=="M602a")
M602bGPFP<-preds_manyFrag%>%filter(fragment.ID=="M602b")
M602cGPFP<-preds_manyFrag%>%filter(fragment.ID=="M602c")
M602dGPFP<-preds_manyFrag%>%filter(fragment.ID=="M602d")
K203aGPFP<-preds_manyFrag%>%filter(fragment.ID=="K203a")
K203bGPFP<-preds_manyFrag%>%filter(fragment.ID=="K203b")
K203cGPFP<-preds_manyFrag%>%filter(fragment.ID=="K203c")
K203dGPFP<-preds_manyFrag%>%filter(fragment.ID=="K203d")
M503aGPFP<-preds_manyFrag%>%filter(fragment.ID=="M503a")
M503bGPFP<-preds_manyFrag%>%filter(fragment.ID=="M503b")
M503cGPFP<-preds_manyFrag%>%filter(fragment.ID=="M503c")
M503dGPFP<-preds_manyFrag%>%filter(fragment.ID=="M503d")
M603aGPFP<-preds_manyFrag%>%filter(fragment.ID=="M603a")
M603bGPFP<-preds_manyFrag%>%filter(fragment.ID=="M603b")
M603cGPFP<-preds_manyFrag%>%filter(fragment.ID=="M603c")
M603dGPFP<-preds_manyFrag%>%filter(fragment.ID=="M603d")
K20CaGPFP<-preds_manyFrag%>%filter(fragment.ID=="K20Ca")
K20CbGPFP<-preds_manyFrag%>%filter(fragment.ID=="K20Cb")
K20CcGPFP<-preds_manyFrag%>%filter(fragment.ID=="K20Cc")
K20CdGPFP<-preds_manyFrag%>%filter(fragment.ID=="K20Cd")
M50CaGPFP<-preds_manyFrag%>%filter(fragment.ID=="M50Ca")
M50CbGPFP<-preds_manyFrag%>%filter(fragment.ID=="M50Cb")
M50CcGPFP<-preds_manyFrag%>%filter(fragment.ID=="M50Cc")
#M50CdGFP<-preds_manyFrag%>%filter(fragment.ID=="#M50C)
M60CaGPFP<-preds_manyFrag%>%filter(fragment.ID=="M60Ca")
M60CbGPFP<-preds_manyFrag%>%filter(fragment.ID=="M60Cb")
M60CcGPFP<-preds_manyFrag%>%filter(fragment.ID=="M60Cc")
M60CdGPFP<-preds_manyFrag%>%filter(fragment.ID=="M60Cd")
K201aGRFP<-preds_manyFrag%>%filter(fragment.ID=="K201a")
K201bGRFP<-preds_manyFrag%>%filter(fragment.ID=="K201b")
K201cGRFP<-preds_manyFrag%>%filter(fragment.ID=="K201c")
K201dGRFP<-preds_manyFrag%>%filter(fragment.ID=="K201d")
M501aGRFP<-preds_manyFrag%>%filter(fragment.ID=="M501a")
M501bGRFP<-preds_manyFrag%>%filter(fragment.ID=="M501b")
M501cGRFP<-preds_manyFrag%>%filter(fragment.ID=="M501c")
M501dGRFP<-preds_manyFrag%>%filter(fragment.ID=="M501d")
M601aGRFP<-preds_manyFrag%>%filter(fragment.ID=="M601a")
M601bGRFP<-preds_manyFrag%>%filter(fragment.ID=="M601b")
M601cGRFP<-preds_manyFrag%>%filter(fragment.ID=="M601c")
M601dGRFP<-preds_manyFrag%>%filter(fragment.ID=="M601d")
K202aGRFP<-preds_manyFrag%>%filter(fragment.ID=="K202a")
K202bGRFP<-preds_manyFrag%>%filter(fragment.ID=="K202b")
K202cGRFP<-preds_manyFrag%>%filter(fragment.ID=="K202c")
K202dGRFP<-preds_manyFrag%>%filter(fragment.ID=="K202d")
M502aGRFP<-preds_manyFrag%>%filter(fragment.ID=="M502a")
M502bGRFP<-preds_manyFrag%>%filter(fragment.ID=="M502b")
M502cGRFP<-preds_manyFrag%>%filter(fragment.ID=="M502c")
M502dGRFP<-preds_manyFrag%>%filter(fragment.ID=="M502d")
M602aGRFP<-preds_manyFrag%>%filter(fragment.ID=="M602a")
M602bGRFP<-preds_manyFrag%>%filter(fragment.ID=="M602b")
M602cGRFP<-preds_manyFrag%>%filter(fragment.ID=="M602c")
M602dGRFP<-preds_manyFrag%>%filter(fragment.ID=="M602d")
K203aGRFP<-preds_manyFrag%>%filter(fragment.ID=="K203a")
K203bGRFP<-preds_manyFrag%>%filter(fragment.ID=="K203b")
K203cGRFP<-preds_manyFrag%>%filter(fragment.ID=="K203c")
K203dGRFP<-preds_manyFrag%>%filter(fragment.ID=="K203d")
M503aGRFP<-preds_manyFrag%>%filter(fragment.ID=="M503a")
M503bGRFP<-preds_manyFrag%>%filter(fragment.ID=="M503b")
M503cGRFP<-preds_manyFrag%>%filter(fragment.ID=="M503c")
M503dGRFP<-preds_manyFrag%>%filter(fragment.ID=="M503d")
M603aGRFP<-preds_manyFrag%>%filter(fragment.ID=="M603a")
M603bGRFP<-preds_manyFrag%>%filter(fragment.ID=="M603b")
M603cGRFP<-preds_manyFrag%>%filter(fragment.ID=="M603c")
M603dGRFP<-preds_manyFrag%>%filter(fragment.ID=="M603d")
K20CaGRFP<-preds_manyFrag%>%filter(fragment.ID=="K20Ca")
K20CbGRFP<-preds_manyFrag%>%filter(fragment.ID=="K20Cb")
K20CcGRFP<-preds_manyFrag%>%filter(fragment.ID=="K20Cc")
K20CdGRFP<-preds_manyFrag%>%filter(fragment.ID=="K20Cd")
M50CaGRFP<-preds_manyFrag%>%filter(fragment.ID=="M50Ca")
M50CbGRFP<-preds_manyFrag%>%filter(fragment.ID=="M50Cb")
M50CcGRFP<-preds_manyFrag%>%filter(fragment.ID=="M50Cc")
M50CdGRFP<-preds_manyFrag%>%filter(fragment.ID=="M50Cd")
M60CaGRFP<-preds_manyFrag%>%filter(fragment.ID=="M60Ca")
M60CbGRFP<-preds_manyFrag%>%filter(fragment.ID=="M60Cb")
M60CcGRFP<-preds_manyFrag%>%filter(fragment.ID=="M60Cc")
M60CdGRFP<-preds_manyFrag%>%filter(fragment.ID=="M60Cd")
```

Filter by treatment

```{r}

#preds_many<-read.csv("C:/Github/TPC_Acropora/R_output_Data_Frames/preds_manyCheck.csv")

treat1P<-preds_many%>%
  filter(treatment=="T1")
treat2P<-preds_many%>%
  filter(treatment=="T2")
treat3P<-preds_many%>%
  filter(treatment=="T3")
treatCP<-preds_many%>%
  filter(treatment=="C")

#write.csv(treat1, "C:/Github/TPC_Acropora/R_output_Data_Frames/treat1.csv")
#write.csv(treat2, "C:/Github/TPC_Acropora/R_output_Data_Frames/treat2.csv")
#write.csv(treat3, "C:/Github/TPC_Acropora/R_output_Data_Frames/treat3.csv")
#write.csv(treatC, "C:/Github/TPC_Acropora/R_output_Data_Frames/treatC.csv")
#write.csv(treat1P, "C:/Github/TPC_Acropora/R_output_Data_Frames/treat1P.csv")
#write.csv(treat2P, "C:/Github/TPC_Acropora/R_output_Data_Frames/treat2P.csv")
#write.csv(treat3P, "C:/Github/TPC_Acropora/R_output_Data_Frames/treat3P.csv")
#write.csv(treatCP, "C:/Github/TPC_Acropora/R_output_Data_Frames/treatCP.csv")
```

"C:/Github/TPC_Acropora/R_output_Data_Frames/treat1P.csv"
"C:/Github/TPC_Acropora/R_output_Data_Frames/treat2P.csv"
"C:/Github/TPC_Acropora/R_output_Data_Frames/treat3P.csv"
"C:/Github/TPC_Acropora/R_output_Data_Frames/treatCP.csv"
reload data

```{r}
treat1P<-read.csv("C:/Github/TPC_Acropora/R_output_Data_Frames/treat1P.csv")
treat2P<-read.csv("C:/Github/TPC_Acropora/R_output_Data_Frames/treat2P.csv")
treat3P<-read.csv("C:/Github/TPC_Acropora/R_output_Data_Frames/treat3P.csv")
treatCP<-read.csv("C:/Github/TPC_Acropora/R_output_Data_Frames/treatCP.csv")
```

TPC graphs Treatment*genotype 1

```{r}
library(ggpubr)
setwd("C:/Github/TPC_Acropora/graphs")

T1plot<-ggplot(treat1, aes(K - 273.15, log.rate, group = genotype, shape=genotype)) +
  geom_point(size=2) +
  geom_line(data = treat1P, size= .8) +
  geom_ribbon(aes(ymin = lwr_CI, ymax = upr_CI, fill = genotype), data = treat1P, alpha = .35) + 
  theme_bw(base_size = 12, base_family = 'Helvetica') +
  ylab('log Metabolic rate') +
  xlab('Temperature (ºC)') +
  facet_wrap(~ rate.type, labeller = labeller(.multi_line = FALSE)) +
  theme_classic() +
   ylim(0,1)+
    ylab(expression(paste("log ", mu,"mol", O[2],"cm"^{-2}, "hr"^{-1})))+
  ggtitle('Sprinkler Shading')+ scale_fill_manual(values = c('red','green4', 'blue'))+ geom_point(colour = "black", size = .4) 

T1plot

T1TPC<-T1plot
T1TPC

ggexport(T1TPC, filename = "Fig1aB.pdf")

```

TPC graphs Treatment*genotype 2

```{r}

T2plot<-ggplot(treat2, aes(K - 273.15, log.rate, group = genotype, shape=genotype)) +
  geom_point(size=2) +
  geom_line(data = treat2P, size= .8) +
  geom_ribbon(aes(ymin = lwr_CI, ymax = upr_CI, fill = genotype), data = treat2P, alpha = .35) + 
  theme_bw(base_size = 12, base_family = 'Helvetica') +
  ylab('log Metabolic rate') +
  xlab('Temperature (ºC)') +
  facet_wrap(~ rate.type, labeller = labeller(.multi_line = FALSE)) +
  theme_classic() +
   ylim(0,1)+
    ylab(expression(paste("log ", mu,"mol", O[2],"cm"^{-2}, "hr"^{-1})))+
  ggtitle('Light-mediated Feeding')

T2TPC<-T2plot+ scale_fill_manual(values = c('red','green4', 'blue'))+ geom_point(colour = "black", size = .4) 
T2TPC
ggexport(T2TPC, filename = "Fig1bB.pdf")

```

TPC graphs Treatment*genotype 3

```{r}
T3plot<-ggplot(treat3, aes(K - 273.15, log.rate, group = genotype, shape=genotype)) +
  geom_point(size=2) +
  geom_line(data = treat3P, size= .8) +
  geom_ribbon(aes(ymin = lwr_CI, ymax = upr_CI, fill = genotype), data = treat3P, alpha = .35) + 
  theme_bw(base_size = 12, base_family = 'Helvetica') +
  ylab('log Metabolic rate') +
  xlab('Temperature (ºC)') +
  facet_wrap(~ rate.type, labeller = labeller(.multi_line = FALSE)) +
  theme_classic() +
   ylim(0,1)+
    ylab(expression(paste("log ", mu,"mol", O[2],"cm"^{-2}, "hr"^{-1})))+
  ggtitle('Interactive')

T3TPC<-T3plot+ scale_fill_manual(values = c('red','green4', 'blue'))+ geom_point(colour = "black", size = .4) 
T3TPC
ggexport(T3TPC, filename = "Fig1cB.pdf")

```

TPC graphs Treatment*genotype Control

```{r}
TCplot<-ggplot(treatC, aes(K - 273.15, log.rate, group = genotype, shape=genotype)) +
  geom_point(size=2) +
  geom_line(data = treatCP, size= .8) +
  geom_ribbon(aes(ymin = lwr_CI, ymax = upr_CI, fill = genotype), data = treatCP, alpha = .35) + 
  theme_bw(base_size = 12, base_family = 'Helvetica') +
  ylab('log Metabolic rate') +
  xlab('Temperature (ºC)') +
  facet_wrap(~ rate.type, labeller = labeller(.multi_line = FALSE)) +
  theme_classic() +
   ylim(0,1)+
  ylab(expression(paste("log ", mu,"mol", O[2],"cm"^{-2}, "hr"^{-1})))+
  ggtitle('Control')

CTPC<-TCplot+ scale_fill_manual(values = c('red','green4', 'blue'))+ geom_point(colour = "black", size = .4) 
CTPC
ggexport(CTPC, filename = "Fig1dB.pdf")

```

Run sharpeschool_field NLS by treatment only 

```{r}
#treatment, rate.type
# run nls.multstart on each curve of the original data ####
fit_manyT <-  group_by(mydata_M50Cd,treatment,rate.type) %>%
  nest() %>%
  mutate(., fit = purrr::map(data, ~nls_multstart(log.rate ~ schoolfield_high(lnc, E, Eh, Th, temp = K, Tc = 20),
                                   data = .x,
                                   iter = 500,
                                   start_lower = c(lnc = -10, E = 0.1, Eh = 0.2, Th = 285),
                                   start_upper = c(lnc = 10, E = 2, Eh = 5, Th = 330),
                                   supp_errors = 'Y',
                                   na.action = na.omit,
                                   lower = c(lnc = -10, E = 0, Eh = 0, Th = 0))))

ggplot(fit_manyTt[[3]][[1]])+
  geom_point(aes(x=temp.Cat, y=log.rate))

# run bootstrap over many curves ####
boot_manyT <- dplyr::group_by(mydata_M50Cd, treatment, rate.type) %>%
  # create 200 bootstrap replicates per curve
  dplyr::do(., boot = modelr::bootstrap(., n = 2, id = 'boot_num')) %>%
  # unnest to show bootstrap number, .id
  unnest_legacy() %>%
  # regroup to include the boot_num
  dplyr::group_by(., treatment, rate.type, boot_num) %>%
  # run the model using map()
  dplyr::mutate(fit = map(strap, ~nls_multstart(log.rate ~ schoolfield_high(lnc, E, Eh, Th, temp = K, Tc = 20),
                        data = data.frame(.),
                        iter = 50,
                        start_lower = c(lnc = -10, E = 0.1, Eh = 0.2, Th = 285),
                        start_upper = c(lnc = 10, E = 2, Eh = 5, Th = 330),
                        lower = c(lnc=-10, E=0, Eh=0, Th=0),
                        supp_errors = 'Y')))


```

Bootstraps and predictions 

```{r}
# new data frame for smooth predictions
new_predsT <- mydata_M50Cd %>%
  do(., data.frame(K = seq(min(.$K), max(.$K), length.out = 150), stringsAsFactors = FALSE))

# get max and min for each curve ### 
max_minT <- group_by(mydata_M50Cd, treatment, rate.type) %>%
    dplyr::summarise(., min_K = min(K), max_K = max(K)) %>%
  ungroup()

# create smoother predictions for unbootstrapped models
preds_manysT <- fit_manyT %>%
  unnest_legacy(fit %>% map(augment, newdata = new_predsT))

# create smoother predictions for bootstrapped replicates
# CODE IS ERRORRED OUT HERE CHECK 1/20/2021 https://padpadpadpad.github.io/post/bootstrapping-non-linear-regressions-with-purrr/
# Fixed error 1/27/2021- grouping error
preds_manyT <- boot_manyT %>%
   unnest_legacy(fit %>% map(augment, newdata = new_predsT)) %>%
  ungroup() %>%
  # group by each value of K and get quantiles
  group_by(., treatment, rate.type, K) %>%
  dplyr::summarise(lwr_CI = quantile(.fitted, 0.025),
            upr_CI = quantile(.fitted, 0.975)) %>%
  ungroup() %>%
  merge(., preds_manysT, by = c("K", "treatment", "rate.type")) %>%
  # merge with max_min to delete predictions outside of the max and min temperatures of each curve
  merge(., max_minT, by = c("treatment", "rate.type")) %>%
  group_by(., treatment, rate.type) %>%
  filter(., K >= unique(min_K) & K <= unique(max_K))  %>%
  ungroup()

preds_manyT<-preds_manyT%>% 
 dplyr::rename(
     log.rate=.fitted)

ggplot(data = preds_manyT)+
  geom_point(aes(x=K, y=log.rate)) +
  facet_wrap(rate.type~treatment)

class(preds_manyT$K)

#write.csv(preds_manyT, "C:/Github/TPC_Acropora/R_output_Data_Frames/preds_manyT.csv")
#
```

Filtering predictions to each treatment

```{r}
#preds_manyT<-read.csv("C:/Github/TPC_Acropora/R_output_Data_Frames/preds_manyT.csv")

treat1PT<-preds_manyT%>%
  filter(treatment=="T1")
treat2PT<-preds_manyT%>%
  filter(treatment=="T2")
treat3PT<-preds_manyT%>%
  filter(treatment=="T3")
treatCPT<-preds_manyT%>%
  filter(treatment=="C")

#write.csv(treat1PT, "C:/Github/TPC_Acropora/R_output_Data_Frames/treat1PT.csv")
#write.csv(treat2PT, "C:/Github/TPC_Acropora/R_output_Data_Frames/treat2PT.csv")
#write.csv(treat3PT, "C:/Github/TPC_Acropora/R_output_Data_Frames/treat3PT.csv")
#write.csv(treatCPT, "C:/Github/TPC_Acropora/R_output_Data_Frames/treatCPT.csv")


```

TPC graph by treatment 1

```{r}

setwd("C:/Github/TPC_Acropora/graphs")
T1Tplot<- ggplot(treat1, aes(K - 273.15, log.rate,shape=rate.type))+
  geom_point(size=2) +
  #geom_ribbon(aes(ymin = lwr_CI, ymax = upr_CI), data = treat1PT, alpha = .35) + 
  #geom_smooth(data=treat1PT, aes(x=(K - 273.15), y=log.rate),size=1.25) + #remove tight sd ribbon on smooth
  geom_point(aes(x=(K - 273.15), y=log.rate),treat1PT, color='green')+
  theme_bw(base_size = 12, base_family = 'Helvetica') +
  ylab('log Metabolic rate') +
  xlab('Temperature (ºC)') +
  facet_wrap(~ rate.type, labeller = labeller(.multi_line = FALSE)) +
  theme_classic() +
   ylim(0,1)+
    ylab(expression(paste("log ", mu,"mol", O[2],"cm"^{-2}, "hr"^{-1})))+
  ggtitle('Sprinkler Shading')

T1Tplot

nrow(treat1PT)
nrow(treat1)

ggexport(T1Tplot, filename = "Fig2a.pdf")

```

TPC graph by treatment 2

```{r}

T2Tplot<-ggplot(treat2, aes(K - 273.15, log.rate, shape=rate.type)) +
  geom_point(size=2) +
  geom_ribbon(aes(ymin = lwr_CI, ymax = upr_CI), data = treat2PT, alpha = .35) + 
  geom_smooth(data=treat2PT, aes(x=(K - 273.15), y=log.rate),size=1.25) +
  theme_bw(base_size = 12, base_family = 'Helvetica') +
  ylab('log Metabolic rate') +
  xlab('Temperature (ºC)') +
  facet_wrap(~ rate.type, labeller = labeller(.multi_line = FALSE)) +
  theme_classic() +
   ylim(0,1)+
    ylab(expression(paste("log ", mu,"mol", O[2],"cm"^{-2}, "hr"^{-1})))+
  ggtitle('Enhanced Feeding')

T2Tplot

ggexport(T2Tplot, filename = "Fig2b.pdf")


```

TPC graph by treatment 3

```{r}
T3Tplot<-ggplot(treat3, aes(K - 273.15, log.rate, shape=rate.type)) +
  geom_point(size=2) +
  geom_ribbon(aes(ymin = lwr_CI, ymax = upr_CI), data = treat3PT, alpha = .35) + 
  geom_smooth(data=treat3PT, aes(x=(K - 273.15), y=log.rate),size=1.25) +
  theme_bw(base_size = 12, base_family = 'Helvetica') +
  ylab('log Metabolic rate') +
  xlab('Temperature (ºC)') +
  facet_wrap(~ rate.type, labeller = labeller(.multi_line = FALSE)) +
  theme_classic() +
   ylim(0,1)+
    ylab(expression(paste("log ", mu,"mol", O[2],"cm"^{-2}, "hr"^{-1})))+
  ggtitle('Interactive')

T3Tplot

ggexport(T3Tplot, filename = "Fig2c.pdf")

```

TPC graph by treatment C

```{r}
TCTplot<-ggplot(treatC, aes(K - 273.15, log.rate, shape=rate.type)) +
  geom_point(size=2) +
  geom_ribbon(aes(ymin = lwr_CI, ymax = upr_CI), data = treatCPT, alpha = .35) + 
  geom_smooth(data=treatCPT, aes(x=(K - 273.15), y=log.rate),size=1.25) +
  theme_bw(base_size = 12, base_family = 'Helvetica') +
  ylab('log Metabolic rate') +
  xlab('Temperature (ºC)') +
  facet_wrap(~ rate.type, labeller = labeller(.multi_line = FALSE)) +
  theme_classic() +
   ylim(0,1)+
    ylab(expression(paste("log ", mu,"mol", O[2],"cm"^{-2}, "hr"^{-1})))+
  ggtitle('Control')

TCTplot

ggexport(TCTplot, filename = "Fig2d.pdf")

```


treat1Frag
preds
treat1FGP
treat2FGP
treat3FGP
treatCFGP
treat1FGR
treat2FGR
treat3FGR
Raw
treat1GP
treat2GP
treat3GP
treatCGP
treat1GR
treat2GR
treat3GR

ggplot(treat1, aes(K - 273.15, log.rate, group = genotype, shape=genotype)) +
  geom_point(size=2) +
  geom_line(data = treat1P, size= .8) +
  geom_ribbon(aes(ymin = lwr_CI, ymax = upr_CI, fill = genotype), data = treat1P, alpha = .35) + 
  theme_bw(base_size = 12, base_family = 'Helvetica') +
  ylab('log Metabolic rate') +
  xlab('Temperature (ºC)') +
  facet_wrap(~ rate.type, labeller = labeller(.multi_line = FALSE)) +
  theme_classic() +
   ylim(0,1)+
    ylab(expression(paste("log ", mu,"mol", O[2],"cm"^{-2}, "hr"^{-1})))+
  ggtitle('Sprinkler Shading')+ scale_fill_manual(values = c('red','green4', 'blue'))+ geom_point(colour = "black", size = .4) 


```{r}
ggplot(treat1GP, aes(K - 273.15, log.rate))+
  geom_point() +
  geom_line(aes(K - 273.15, log.rate),data=treat1FGP)
  geom_ribbon(aes(ymin = lwr_CI, ymax = upr_CI), data = treat1FGP, alpha = .35) + 
  geom_smooth(data=treat1FGP, aes(x=(K - 273.15), y=log.rate),size=1.25) +
  theme_bw(base_size = 12, base_family = 'Helvetica') +
  ylab('log Metabolic rate') +
  xlab('Temperature (ºC)') +
  facet_wrap(~ rate.type, labeller = labeller(.multi_line = FALSE)) +
  theme_classic() +
   ylim(0,1)+
    ylab(expression(paste("log ", mu,"mol", O[2],"cm"^{-2}, "hr"^{-1})))+
  ggtitle('Control')

  
  ggplot(treat1, aes(K - 273.15, log.rate, group = genotype, shape=genotype)) +
  geom_point(size=2) +
  geom_line(data = treat1P, size= .8) +
  geom_ribbon(aes(ymin = lwr_CI, ymax = upr_CI, fill = genotype), data = treat1P, alpha = .35) + 
  theme_bw(base_size = 12, base_family = 'Helvetica') +
  ylab('log Metabolic rate') +
  xlab('Temperature (ºC)') +
  facet_wrap(~ rate.type, labeller = labeller(.multi_line = FALSE)) +
  theme_classic() +
   ylim(0,1)+
    ylab(expression(paste("log ", mu,"mol", O[2],"cm"^{-2}, "hr"^{-1})))+
  ggtitle('Sprinkler Shading')+ scale_fill_manual(values = c('red','green4', 'blue'))+ geom_point(colour = "black", size = .4) 


```

Filter parameters by Genotype

```{r}

T1GP<-treat1%>%
  filter(rate.type=="GP")
T1GPK2<-T1GP%>%
  filter(genotype=="K2")
T1GPM5<-T1GP%>%
  filter(genotype=="M5")
T1GPM6<-T1GP%>%
  filter(genotype=="M6")

T1Re<-treat1%>%
  filter(rate.type=="R")
T1ReK2<-T1Re%>%
  filter(genotype=="K2")
T1ReM5<-T1Re%>%
  filter(genotype=="M5")
T1ReM6<-T1Re%>%
  filter(genotype=="M6")

T2GP<-treat2%>%
  filter(rate.type=="GP")
T2GPK2<-T2GP%>%
  filter(genotype=="K2")
T2GPM5<-T2GP%>%
  filter(genotype=="M5")
T2GPM6<-T2GP%>%
  filter(genotype=="M6")

T2Re<-treat2%>%
  filter(rate.type=="R")
T2ReK2<-T2Re%>%
  filter(genotype=="K2")
T2ReM5<-T2Re%>%
  filter(genotype=="M5")
T2ReM6<-T2Re%>%
  filter(genotype=="M6")

T3GP<-treat3%>%
  filter(rate.type=="GP")
T3GPK2<-T3GP%>%
  filter(genotype=="K2")
T3GPM5<-T3GP%>%
  filter(genotype=="M5")
T3GPM6<-T3GP%>%
  filter(genotype=="M6")

T3Re<-treat3%>%
  filter(rate.type=="R")
T3ReK2<-T3Re%>%
  filter(genotype=="K2")
T3ReM5<-T3Re%>%
  filter(genotype=="M5")
T3ReM6<-T3Re%>%
  filter(genotype=="M6")

TCGP<-treatC%>%
  filter(rate.type=="GP")
TCGPK2<-TCGP%>%
  filter(genotype=="K2")
TCGPM5<-TCGP%>%
  filter(genotype=="M5")
TCGPM6<-TCGP%>%
  filter(genotype=="M6")

TCRe<-treatC%>%
  filter(rate.type=="R")
TCReK2<-TCRe%>%
  filter(genotype=="K2")
TCReM5<-TCRe%>%
  filter(genotype=="M5")
TCReM6<-TCRe%>%
  filter(genotype=="M6")

```

Treatment 1 GP and R parameters (estimation by genotype)

```{r}
# get start values and fit model T1GPK2
head(T1GPK2)
start_vals <- get_start_vals(T1GPK2$temp.Cat, T1GPK2$log.rate, model_name = 'sharpeschoolhigh_1981')

modT1GPK2 <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = T1GPK2,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(T1GPK2$temp.Cat, T1GPK2$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(T1GPK2$temp.Cat, T1GPK2$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))


calc_params <- function(model){
  t <- data.frame(rmax = suppressWarnings(tryCatch(rTPC::get_rmax(model), error = function(err) NA)),
                  topt = suppressWarnings(tryCatch(rTPC::get_topt(model), error = function(err) NA)),
                  ctmin = suppressWarnings(tryCatch(rTPC::get_ctmin(model), error = function(err) NA)),
                  ctmax = suppressWarnings(tryCatch(rTPC::get_ctmax(model), error = function(err) NA)),
                  e = suppressWarnings(tryCatch(rTPC::get_e(model), error = function(err) NA)),
                  eh = suppressWarnings(tryCatch(rTPC::get_eh(model), error = function(err) NA)),
                  q10 = suppressWarnings(tryCatch(rTPC::get_q10(model), error = function(err) NA)),
                  thermal_safety_margin = suppressWarnings(tryCatch(rTPC::get_thermalsafetymargin(model), error = function(err) NA)),
                  thermal_tolerance = suppressWarnings(tryCatch(rTPC::get_thermaltolerance(model), error = function(err) NA)),
                  breadth = suppressWarnings(tryCatch(rTPC::get_breadth(model), error = function(err) NA)),
                  skewness = suppressWarnings(tryCatch(rTPC::get_skewness(model), error = function(err) NA)),
                  stringsAsFactors = FALSE)

  return(t)
}
calc_params(modT1GPK2)


# get start values and fit model T1GPM5 
head(T1GPM5)

start_vals <- get_start_vals(T1GPM5$temp.Cat, T1GPM5$log.rate, model_name = 'sharpeschoolhigh_1981')

modT1GPM5 <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = T1GPM5,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(T1GPM5$temp.Cat, T1GPM5$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(T1GPM5$temp.Cat, T1GPM5$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modT1GPM5)


# get start values and fit model T1GPM6 
head(T1GPM6)
start_vals <- get_start_vals(T1GPM6$temp.Cat, T1GPM6$log.rate, model_name = 'sharpeschoolhigh_1981')

modT1GPM6 <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = T1GPM6,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(T1GPM6$temp.Cat, T1GPM6$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(T1GPM6$temp.Cat, T1GPM6$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))



calc_params(modT1GPM6)

# respiration
# get start values and fit model T1ReK2
head(T1ReK2)
start_vals <- get_start_vals(T1ReK2$temp.Cat, T1ReK2$log.rate, model_name = 'sharpeschoolhigh_1981')

modT1ReK2 <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = T1ReK2,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(T1ReK2$temp.Cat, T1ReK2$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(T1ReK2$temp.Cat, T1ReK2$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modT1ReK2)

# get start values and fit model T1ReM5 
head(T1ReM5)

start_vals <- get_start_vals(T1ReM5$temp.Cat, T1ReM5$log.rate, model_name = 'sharpeschoolhigh_1981')

modT1ReM5 <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = T1ReM5,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(T1ReM5$temp.Cat, T1ReM5$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(T1ReM5$temp.Cat, T1ReM5$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modT1ReM5)

# get start values and fit model T1ReM6 
head(T1ReM6)
start_vals <- get_start_vals(T1ReM6$temp.Cat, T1ReM6$log.rate, model_name = 'sharpeschoolhigh_1981')

modT1ReM6 <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = T1ReM6,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(T1ReM6$temp.Cat, T1ReM6$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(T1ReM6$temp.Cat, T1ReM6$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))



calc_params(modT1ReM6)
```

Treatment 2 GP and R parameters

```{r}
# get start values and fit model T2GPK2
head(T2GPK2)
start_vals <- get_start_vals(T2GPK2$temp.Cat, T2GPK2$log.rate, model_name = 'sharpeschoolhigh_1981')

modT2GPK2 <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = T2GPK2,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(T2GPK2$temp.Cat, T2GPK2$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(T2GPK2$temp.Cat, T2GPK2$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))


calc_params(modT2GPK2)


# get start values and fit model T2GPM5 
head(T2GPM5)

start_vals <- get_start_vals(T2GPM5$temp.Cat, T2GPM5$log.rate, model_name = 'sharpeschoolhigh_1981')

modT2GPM5 <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = T2GPM5,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(T2GPM5$temp.Cat, T2GPM5$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(T2GPM5$temp.Cat, T2GPM5$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modT2GPM5)

# get start values and fit model T2GPM6 
head(T2GPM6)
start_vals <- get_start_vals(T2GPM6$temp.Cat, T2GPM6$log.rate, model_name = 'sharpeschoolhigh_1981')

modT2GPM6 <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = T2GPM6,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(T2GPM6$temp.Cat, T2GPM6$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(T2GPM6$temp.Cat, T2GPM6$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))



calc_params(modT2GPM6)

# respiration
# get start values and fit model T2ReK2
head(T2ReK2)
start_vals <- get_start_vals(T2ReK2$temp.Cat, T2ReK2$log.rate, model_name = 'sharpeschoolhigh_1981')

modT2ReK2 <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = T2ReK2,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(T2ReK2$temp.Cat, T2ReK2$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(T2ReK2$temp.Cat, T2ReK2$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modT2ReK2)

# get start values and fit model T2ReM5 
head(T2ReM5)

start_vals <- get_start_vals(T2ReM5$temp.Cat, T2ReM5$log.rate, model_name = 'sharpeschoolhigh_1981')

modT2ReM5 <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = T2ReM5,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(T2ReM5$temp.Cat, T2ReM5$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(T2ReM5$temp.Cat, T2ReM5$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modT2ReM5)

# get start values and fit model T2ReM6 
head(T2ReM6)
start_vals <- get_start_vals(T2ReM6$temp.Cat, T2ReM6$log.rate, model_name = 'sharpeschoolhigh_1981')

modT2ReM6 <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = T2ReM6,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(T2ReM6$temp.Cat, T2ReM6$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(T2ReM6$temp.Cat, T2ReM6$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))



calc_params(modT2ReM6)
```

Treatment 3 GP and R parameters

```{r}
# get start values and fit model T3GPK2
head(T3GPK2)
start_vals <- get_start_vals(T3GPK2$temp.Cat, T3GPK2$log.rate, model_name = 'sharpeschoolhigh_1981')

modT3GPK2 <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = T3GPK2,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(T3GPK2$temp.Cat, T3GPK2$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(T3GPK2$temp.Cat, T3GPK2$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modT3GPK2)


# get start values and fit model T3GPM5 
head(T3GPM5)

start_vals <- get_start_vals(T3GPM5$temp.Cat, T3GPM5$log.rate, model_name = 'sharpeschoolhigh_1981')

modT3GPM5 <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = T3GPM5,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(T3GPM5$temp.Cat, T3GPM5$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(T3GPM5$temp.Cat, T3GPM5$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modT3GPM5)


# get start values and fit model T3GPM6 
head(T3GPM6)
start_vals <- get_start_vals(T3GPM6$temp.Cat, T3GPM6$log.rate, model_name = 'sharpeschoolhigh_1981')

modT3GPM6 <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = T3GPM6,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(T3GPM6$temp.Cat, T3GPM6$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(T3GPM6$temp.Cat, T3GPM6$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))



calc_params(modT3GPM6)

# respiration
# get start values and fit model T3ReK2
head(T3ReK2)
start_vals <- get_start_vals(T3ReK2$temp.Cat, T3ReK2$log.rate, model_name = 'sharpeschoolhigh_1981')

modT3ReK2 <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = T3ReK2,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(T3ReK2$temp.Cat, T3ReK2$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(T3ReK2$temp.Cat, T3ReK2$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modT3ReK2)


# get start values and fit model T3ReM5 
head(T3ReM5)

start_vals <- get_start_vals(T3ReM5$temp.Cat, T3ReM5$log.rate, model_name = 'sharpeschoolhigh_1981')

modT3ReM5 <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = T3ReM5,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(T3ReM5$temp.Cat, T3ReM5$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(T3ReM5$temp.Cat, T3ReM5$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modT3ReM5)


# get start values and fit model T3ReM6 
head(T3ReM6)
start_vals <- get_start_vals(T3ReM6$temp.Cat, T3ReM6$log.rate, model_name = 'sharpeschoolhigh_1981')

modT3ReM6 <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = T3ReM6,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(T3ReM6$temp.Cat, T3ReM6$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(T3ReM6$temp.Cat, T3ReM6$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))



calc_params(modT3ReM6)

```

Treatment C GP and R parameters 

```{r}
# get start values and fit model TCGPK2
head(TCGPK2)
start_vals <- get_start_vals(TCGPK2$temp.Cat, TCGPK2$log.rate, model_name = 'sharpeschoolhigh_1981')

modTCGPK2 <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = TCGPK2,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(TCGPK2$temp.Cat, TCGPK2$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(TCGPK2$temp.Cat, TCGPK2$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modTCGPK2)


# get start values and fit model TCGPM5 
head(TCGPM5)

start_vals <- get_start_vals(TCGPM5$temp.Cat, TCGPM5$log.rate, model_name = 'sharpeschoolhigh_1981')

modTCGPM5 <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = TCGPM5,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(TCGPM5$temp.Cat, TCGPM5$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(TCGPM5$temp.Cat, TCGPM5$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modTCGPM5)


# get start values and fit model TCGPM6 
head(TCGPM6)
start_vals <- get_start_vals(TCGPM6$temp.Cat, TCGPM6$log.rate, model_name = 'sharpeschoolhigh_1981')

modTCGPM6 <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = TCGPM6,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(TCGPM6$temp.Cat, TCGPM6$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(TCGPM6$temp.Cat, TCGPM6$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))



calc_params(modTCGPM6)

# respiration
# get start values and fit model TCReK2
head(TCReK2)
start_vals <- get_start_vals(TCReK2$temp.Cat, TCReK2$log.rate, model_name = 'sharpeschoolhigh_1981')

modTCReK2 <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = TCReK2,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(TCReK2$temp.Cat, TCReK2$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(TCReK2$temp.Cat, TCReK2$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modTCReK2)


# get start values and fit model TCReM5 
head(TCReM5)

start_vals <- get_start_vals(TCReM5$temp.Cat, TCReM5$log.rate, model_name = 'sharpeschoolhigh_1981')

modTCReM5 <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = TCReM5,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(TCReM5$temp.Cat, TCReM5$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(TCReM5$temp.Cat, TCReM5$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modTCReM5)


# get start values and fit model TCReM6 
head(TCReM6)
start_vals <- get_start_vals(TCReM6$temp.Cat, TCReM6$log.rate, model_name = 'sharpeschoolhigh_1981')

modTCReM6 <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = TCReM6,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(TCReM6$temp.Cat, TCReM6$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(TCReM6$temp.Cat, TCReM6$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))



calc_params(modTCReM6)

```


All Curve parameters T*G

```{r}

para_TCReM6<-calc_params(modTCReM6)
TCReM6col<-'TCReM6'
genTCReM6<-'M6'
treTCReM6<-'TC'
ratTCReM6<-'R'
para_TCReM6$curve.id<-TCReM6col
para_TCReM6$genotype<-genTCReM6
para_TCReM6$treatment<-treTCReM6
para_TCReM6$rate.type<-ratTCReM6

para_TCReM5<-calc_params(modTCReM5)
TCReM5col<-'TCReM5'
genTCReM5<-'M5'
treTCReM5<-'TC'
ratTCReM5<-'R'
para_TCReM5$curve.id<-TCReM5col
para_TCReM5$genotype<-genTCReM5
para_TCReM5$treatment<-treTCReM5
para_TCReM5$rate.type<-ratTCReM5

para_TCReK2<-calc_params(modTCReK2)
TCReK2col<-'TCReK2'
genTCReK2<-'K2'
treTCReK2<-'TC'
ratTCReK2<-'R'
para_TCReK2$curve.id<-TCReK2col
para_TCReK2$genotype<-genTCReK2
para_TCReK2$treatment<-treTCReK2
para_TCReK2$rate.type<-ratTCReK2

para_TCGPM6<-calc_params(modTCGPM6)
TCGPM6col<-'TCGPM6'
genTCGPM6<-'M6'
treTCGPM6<-'TC'
ratTCGPM6<-'GP'
para_TCGPM6$curve.id<-TCGPM6col
para_TCGPM6$genotype<-genTCGPM6
para_TCGPM6$treatment<-treTCGPM6
para_TCGPM6$rate.type<-ratTCGPM6

para_TCGPM5<-calc_params(modTCGPM5)
TCGPM5col<-'TCGPM5'
genTCGPM5<-'M5'
treTCGPM5<-'TC'
ratTCGPM5<-'GP'
para_TCGPM5$curve.id<-TCGPM5col
para_TCGPM5$genotype<-genTCGPM5
para_TCGPM5$treatment<-treTCGPM5
para_TCGPM5$rate.type<-ratTCGPM5

para_TCGPK2<-calc_params(modTCGPK2)
TCGPK2col<-'TCGPK2'
genTCGPK2<-'K2'
treTCGPK2<-'TC'
ratTCGPK2<-'GP'
para_TCGPK2$curve.id<-TCGPK2col
para_TCGPK2$genotype<-genTCGPK2
para_TCGPK2$treatment<-treTCGPK2
para_TCGPK2$rate.type<-ratTCGPK2

para_T3ReM6<-calc_params(modT3ReM6)
T3ReM6col<-'T3ReM6'
genT3ReM6<-'M6'
treT3ReM6<-'T3'
ratT3ReM6<-'R'
para_T3ReM6$curve.id<-T3ReM6col
para_T3ReM6$genotype<-genT3ReM6
para_T3ReM6$treatment<-treT3ReM6
para_T3ReM6$rate.type<-ratT3ReM6

para_T3ReM5<-calc_params(modT3ReM5)
T3ReM5col<-'T3ReM5'
genT3ReM5<-'M5'
treT3ReM5<-'T3'
ratT3ReM5<-'R'
para_T3ReM5$curve.id<-T3ReM5col
para_T3ReM5$genotype<-genT3ReM5
para_T3ReM5$treatment<-treT3ReM5
para_T3ReM5$rate.type<-ratT3ReM5

para_T3ReK2<-calc_params(modT3ReK2)
T3ReK2col<-'T3ReK2'
genT3ReK2<-'K2'
treT3ReK2<-'T3'
ratT3ReK2<-'R'
para_T3ReK2$curve.id<-T3ReK2col
para_T3ReK2$genotype<-genT3ReK2
para_T3ReK2$treatment<-treT3ReK2
para_T3ReK2$rate.type<-ratT3ReK2

para_T3GPM6<-calc_params(modT3GPM6)
T3GPM6col<-'T3GPM6'
genT3GPM6<-'M6'
treT3GPM6<-'T3'
ratT3GPM6<-'GP'
para_T3GPM6$curve.id<-T3GPM6col
para_T3GPM6$genotype<-genT3GPM6
para_T3GPM6$treatment<-treT3GPM6
para_T3GPM6$rate.type<-ratT3GPM6


para_T3GPM5<-calc_params(modT3GPM5)
T3GPM5col<-'T3GPM5'
genT3GPM5<-'M5'
treT3GPM5<-'T3'
ratT3GPM5<-'GP'
para_T3GPM5$curve.id<-T3GPM5col
para_T3GPM5$genotype<-genT3GPM5
para_T3GPM5$treatment<-treT3GPM5
para_T3GPM5$rate.type<-ratT3GPM5

para_T3GPK2<-calc_params(modT3GPK2)
T3GPK2col<-'T3GPK2'
genT3GPK2<-'K2'
treT3GPK2<-'T3'
ratT3GPK2<-'GP'
para_T3GPK2$curve.id<-T3GPK2col
para_T3GPK2$genotype<-genT3GPK2
para_T3GPK2$treatment<-treT3GPK2
para_T3GPK2$rate.type<-ratT3GPK2

para_T2ReM6<-calc_params(modT2ReM6)
T2ReM6col<-'T2ReM6'
genT2ReM6<-'M6'
treT2ReM6<-'T2'
ratT2ReM6<-'R'
para_T2ReM6$curve.id<-T2ReM6col
para_T2ReM6$genotype<-genT2ReM6
para_T2ReM6$treatment<-treT2ReM6
para_T2ReM6$rate.type<-ratT2ReM6

para_T2ReM5<-calc_params(modT2ReM5)
T2ReM5col<-'T2ReM5'
genT2ReM5<-'M5'
treT2ReM5<-'T2'
ratT2ReM5<-'R'
para_T2ReM5$curve.id<-T2ReM5col
para_T2ReM5$genotype<-genT2ReM5
para_T2ReM5$treatment<-treT2ReM5
para_T2ReM5$rate.type<-ratT2ReM5

para_T2ReK2<-calc_params(modT2ReK2)
T2ReK2col<-'T2ReK2'
genT2ReK2<-'K2'
treT2ReK2<-'T2'
ratT2ReK2<-'R'
para_T2ReK2$curve.id<-T2ReK2col
para_T2ReK2$genotype<-genT2ReK2
para_T2ReK2$treatment<-treT2ReK2
para_T2ReK2$rate.type<-ratT2ReK2

para_T2GPM6<-calc_params(modT2GPM6)
T2GPM6col<-'T2GPM6'
genT2GPM6<-'M6'
treT2GPM6<-'T2'
ratT2GPM6<-'GP'
para_T2GPM6$curve.id<-T2GPM6col
para_T2GPM6$genotype<-genT2GPM6
para_T2GPM6$treatment<-treT2GPM6
para_T2GPM6$rate.type<-ratT2GPM6

para_T2GPM5<-calc_params(modT2GPM5)
T2GPM5col<-'T2GPM5'
genT2GPM5<-'M5'
treT2GPM5<-'T2'
ratT2GPM5<-'GP'
para_T2GPM5$curve.id<-T2GPM5col
para_T2GPM5$genotype<-genT2GPM5
para_T2GPM5$treatment<-treT2GPM5
para_T2GPM5$rate.type<-ratT2GPM5

para_T2GPK2<-calc_params(modT2GPK2)
T2GPK2col<-'T2GPK2'
genT2GPK2<-'K2'
treT2GPK2<-'T2'
ratT2GPK2<-'GP'
para_T2GPK2$curve.id<-T2GPK2col
para_T2GPK2$genotype<-genT2GPK2
para_T2GPK2$treatment<-treT2GPK2
para_T2GPK2$rate.type<-ratT2GPK2

para_T1ReM6<-calc_params(modT1ReM6)
T1ReM6col<-'T1ReM6'
genT1ReM6<-'M6'
treT1ReM6<-'T1'
ratT1ReM6<-'R'
para_T1ReM6$curve.id<-T1ReM6col
para_T1ReM6$genotype<-genT1ReM6
para_T1ReM6$treatment<-treT1ReM6
para_T1ReM6$rate.type<-ratT1ReM6

para_T1ReM5<-calc_params(modT1ReM5)
T1ReM5col<-'T1ReM5'
genT1ReM5<-'M5'
treT1ReM5<-'T1'
ratT1ReM5<-'R'
para_T1ReM5$curve.id<-T1ReM5col
para_T1ReM5$genotype<-genT1ReM5
para_T1ReM5$treatment<-treT1ReM5
para_T1ReM5$rate.type<-ratT1ReM5

para_T1ReK2<-calc_params(modT1ReK2)
T1ReK2col<-'T1ReK2'
genT1ReK2<-"K2"
treT1ReK2<-'T1'
ratT1ReK2<-'R'
para_T1ReK2$curve.id<-T1ReK2col
para_T1ReK2$genotype<-genT1ReK2
para_T1ReK2$treatment<-treT1ReK2
para_T1ReK2$rate.type<-ratT1ReK2

para_T1GPM6<-calc_params(modT1GPM6)
T1GPM6col<-'T1GPM6'
genT1GPM6<-'M6'
treT1GPM6<-'T1'
ratT1GPM6<-'GP'
para_T1GPM6$curve.id<-T1GPM6col
para_T1GPM6$genotype<-genT1GPM6
para_T1GPM6$treatment<-treT1GPM6
para_T1GPM6$rate.type<-ratT1GPM6

para_T1GPM5<-calc_params(modT1GPM5)
T1GPM5col<-'T1GPM5'
genT1GPM5<-'M5'
treT1GPM5<-'T1'
ratT1GPM5<-'GP'
para_T1GPM5$curve.id<-T1GPM5col
para_T1GPM5$genotype<-genT1GPM5
para_T1GPM5$treatment<-treT1GPM5
para_T1GPM5$rate.type<-ratT1GPM5

para_T1GPK2<-calc_params(modT1GPK2)
T1GPK2col<-'T1GPK2'
genT1GPK2<-'K2'
treT1GPK2<-'T1'
ratT1GPK2<-'GP'
para_T1GPK2$curve.id<-T1GPK2col
para_T1GPK2$genotype<-genT1GPK2
para_T1GPK2$treatment<-treT1GPK2
para_T1GPK2$rate.type<-ratT1GPK2


parameters<-rbind(para_TCReM6,para_TCReM5,para_TCReK2,para_TCGPM6,para_TCGPM5,para_TCGPK2,para_T3ReM6,para_T3ReM5,para_T3ReK2,para_T3GPM6,para_T3GPM5,para_T3GPK2,para_T2ReM6,para_T2ReM5,para_T2ReK2,para_T2GPM6,para_T2GPM5,para_T2GPK2,para_T1ReM6,para_T1ReM5,para_T1ReK2,para_T1GPM6,para_T1GPM5,para_T1GPK2)

View(parameters)
#write.csv(parameters, "C:/Github/TPC_Acropora/R_output_Data_Frames/TPCparameters.csv")
```

Curve Parameters by Treatment only

```{r}
T1Re
T1GP
T2Re
T2GP
T3Re
T3GP
TCRe
TCGP

#R
head(T1Re)
start_vals <- get_start_vals(T1Re$temp.Cat, T1Re$log.rate, model_name = 'sharpeschoolhigh_1981')

modT1Re <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = T1Re,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(T1Re$temp.Cat, T1Re$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(T1Re$temp.Cat, T1Re$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))



calc_params(modT1Re)
#GP
head(T1GP)
start_vals <- get_start_vals(T1GP$temp.Cat, T1GP$log.rate, model_name = 'sharpeschoolhigh_1981')

modT1GP <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = T1GP,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(T1GP$temp.Cat, T1GP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(T1GP$temp.Cat, T1GP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))



calc_params(modT1GP)

#R
head(T2Re)
start_vals <- get_start_vals(T2Re$temp.Cat, T2Re$log.rate, model_name = 'sharpeschoolhigh_1981')

modT2Re <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = T2Re,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(T2Re$temp.Cat, T2Re$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(T2Re$temp.Cat, T2Re$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))



calc_params(modT2Re)
#GP
head(T2GP)
start_vals <- get_start_vals(T2GP$temp.Cat, T2GP$log.rate, model_name = 'sharpeschoolhigh_1981')

modT2GP <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = T2GP,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(T2GP$temp.Cat, T2GP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(T2GP$temp.Cat, T2GP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))



calc_params(modT2GP)

#R
head(T3Re)
start_vals <- get_start_vals(T3Re$temp.Cat, T3Re$log.rate, model_name = 'sharpeschoolhigh_1981')

modT3Re <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = T3Re,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(T3Re$temp.Cat, T3Re$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(T3Re$temp.Cat, T3Re$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))



calc_params(modT3Re)
#GP
head(T3GP)
start_vals <- get_start_vals(T3GP$temp.Cat, T3GP$log.rate, model_name = 'sharpeschoolhigh_1981')

modT3GP <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = T3GP,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(T3GP$temp.Cat, T3GP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(T3GP$temp.Cat, T3GP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))



calc_params(modT3GP)

#R
head(TCRe)
start_vals <- get_start_vals(TCRe$temp.Cat, TCRe$log.rate, model_name = 'sharpeschoolhigh_1981')

modTCRe <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = TCRe,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(TCRe$temp.Cat, TCRe$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(TCRe$temp.Cat, TCRe$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))



calc_params(modTCRe)
#GP
head(TCGP)
start_vals <- get_start_vals(TCGP$temp.Cat, TCGP$log.rate, model_name = 'sharpeschoolhigh_1981')

modTCGP <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = TCGP,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(TCGP$temp.Cat, TCGP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(TCGP$temp.Cat, TCGP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))



calc_params(modTCGP)

```

Filter parameters by treatment

```{r}
para_T1GP<-calc_params(modT1GP)
T1GPcol<-'T1GP'
treT1GP<-'T1'
ratT1GP<-'GP'
para_T1GP$curve.id<- T1GPcol
para_T1GP$treatment<-treT1GP
para_T1GP$rate.type<-ratT1GP

para_T2GP<-calc_params(modT2GP)
T2GPcol<-'T2GP'
treT2GP<-'T2'
ratT2GP<-'GP'
para_T2GP$curve.id<- T2GPcol
para_T2GP$treatment<-treT2GP
para_T2GP$rate.type<-ratT2GP

para_T3GP<-calc_params(modT3GP)
T3GPcol<-'T3GP'
treT3GP<-'T3'
ratT3GP<-'GP'
para_T3GP$curve.id<- T3GPcol
para_T3GP$treatment<-treT3GP
para_T3GP$rate.type<-ratT3GP

para_TCGP<-calc_params(modTCGP)
TCGPcol<-'TCGP'
treTCGP<-'TC'
ratTCGP<-'GP'
para_TCGP$curve.id<- TCGPcol
para_TCGP$treatment<-treTCGP
para_TCGP$rate.type<-ratTCGP

para_T1Re<-calc_params(modT1Re)
T1Recol<-'T1Re'
treT1Re<-'T1'
ratT1Re<-'R'
para_T1Re$curve.id<- T1Recol
para_T1Re$treatment<-treT1Re
para_T1Re$rate.type<-ratT1Re

para_T2Re<-calc_params(modT2Re)
T2Recol<-'T2Re'
treT2Re<-'T2'
ratT2Re<-'R'
para_T2Re$curve.id<- T2Recol
para_T2Re$treatment<-treT2Re
para_T2Re$rate.type<-ratT2Re

para_T3Re<-calc_params(modT3Re)
T3Recol<-'T3Re'
treT3Re<-'T3'
ratT3Re<-'R'
para_T3Re$curve.id<- T3Recol
para_T3Re$treatment<-treT3Re
para_T3Re$rate.type<-ratT3Re

para_TCRe<-calc_params(modTCRe)
TCRecol<-'TCRe'
treTCRe<-'TC'
ratTCRe<-'R'
para_TCRe$curve.id<- TCRecol
para_TCRe$treatment<-treTCRe
para_TCRe$rate.type<-ratTCRe

parametersT<-rbind(para_TCGP,para_T3GP,para_T2GP,para_T1GP,para_TCRe,para_T3Re,para_T2Re,para_T1Re)

View(parametersT)
#write.csv(parametersT, "C:/Github/TPC_Acropora/R_output_Data_Frames/TPCparametersT.csv")
```

Curve parameters By fragment.ID Treatment 1 GP

```{r}
K201aGP

head(K201aGP)
start_vals <- get_start_vals(K201aGP$temp.Cat, K201aGP$log.rate, model_name = 'sharpeschoolhigh_1981')

modK201aGP <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = K201aGP,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(K201aGP$temp.Cat, K201aGP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(K201aGP$temp.Cat, K201aGP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modK201aGP)


K201bGP
start_vals <- get_start_vals(K201bGP$temp.Cat, K201bGP$log.rate, model_name = 'sharpeschoolhigh_1981')

modK201bGP <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = K201bGP,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(K201bGP$temp.Cat, K201bGP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(K201bGP$temp.Cat, K201bGP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modK201bGP)

K201cGP
start_vals <- get_start_vals(K201cGP$temp.Cat, K201cGP$log.rate, model_name = 'sharpeschoolhigh_1981')

modK201cGP <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = K201cGP,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(K201cGP$temp.Cat, K201cGP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(K201cGP$temp.Cat, K201cGP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modK201cGP)

K201dGP
start_vals <- get_start_vals(K201dGP$temp.Cat, K201dGP$log.rate, model_name = 'sharpeschoolhigh_1981')

modK201dGP <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = K201dGP,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(K201dGP$temp.Cat, K201dGP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(K201dGP$temp.Cat, K201dGP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modK201dGP)

M501aGP
start_vals <- get_start_vals(M501aGP$temp.Cat, M501aGP$log.rate, model_name = 'sharpeschoolhigh_1981')

modM501aGP <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = M501aGP,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(M501aGP$temp.Cat, M501aGP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(M501aGP$temp.Cat, M501aGP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modM501aGP)

M501bGP
start_vals <- get_start_vals(M501bGP$temp.Cat, M501bGP$log.rate, model_name = 'sharpeschoolhigh_1981')

modM501bGP <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = M501bGP,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(M501bGP$temp.Cat, M501bGP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(M501bGP$temp.Cat, M501bGP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modM501bGP)

M501cGP
start_vals <- get_start_vals(M501cGP$temp.Cat, M501cGP$log.rate, model_name = 'sharpeschoolhigh_1981')

modM501cGP <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = M501cGP,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(M501cGP$temp.Cat, M501cGP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(M501cGP$temp.Cat, M501cGP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modM501cGP)

M501dGP
start_vals <- get_start_vals(M501dGP$temp.Cat, M501dGP$log.rate, model_name = 'sharpeschoolhigh_1981')

modM501dGP <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = M501dGP,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(M501dGP$temp.Cat, M501dGP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(M501dGP$temp.Cat, M501dGP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modM501dGP)

M601aGP
start_vals <- get_start_vals(M601aGP$temp.Cat, M601aGP$log.rate, model_name = 'sharpeschoolhigh_1981')

modM601aGP <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = M601aGP,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(M601aGP$temp.Cat, M601aGP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(M601aGP$temp.Cat, M601aGP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modM601aGP)

M601bGP
start_vals <- get_start_vals(M601bGP$temp.Cat, M601bGP$log.rate, model_name = 'sharpeschoolhigh_1981')

modM601bGP <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = M601bGP,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(M601bGP$temp.Cat, M601bGP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(M601bGP$temp.Cat, M601bGP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modM601bGP)

M601cGP
start_vals <- get_start_vals(M601cGP$temp.Cat, M601cGP$log.rate, model_name = 'sharpeschoolhigh_1981')

modM601cGP <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = M601cGP,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(M601cGP$temp.Cat, M601cGP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(M601cGP$temp.Cat, M601cGP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modM601cGP)

M601dGP
start_vals <- get_start_vals(M601dGP$temp.Cat, M601dGP$log.rate, model_name = 'sharpeschoolhigh_1981')

modM601dGP <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = M601dGP,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(M601dGP$temp.Cat, M601dGP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(M601dGP$temp.Cat, M601dGP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modM601dGP)

```

Treatment 2 GP curve parameters for fragment.ID 

```{r}

head(K202aGP)
start_vals <- get_start_vals(K202aGP$temp.Cat, K202aGP$log.rate, model_name = 'sharpeschoolhigh_1981')

modK202aGP <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = K202aGP,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(K202aGP$temp.Cat, K202aGP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(K202aGP$temp.Cat, K202aGP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modK202aGP)


K202bGP
start_vals <- get_start_vals(K202bGP$temp.Cat, K202bGP$log.rate, model_name = 'sharpeschoolhigh_1981')

modK202bGP <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = K202bGP,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(K202bGP$temp.Cat, K202bGP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(K202bGP$temp.Cat, K202bGP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modK202bGP)

K202cGP
start_vals <- get_start_vals(K202cGP$temp.Cat, K202cGP$log.rate, model_name = 'sharpeschoolhigh_1981')

modK202cGP <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = K202cGP,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(K202cGP$temp.Cat, K202cGP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(K202cGP$temp.Cat, K202cGP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modK202cGP)

K202dGP
start_vals <- get_start_vals(K202dGP$temp.Cat, K202dGP$log.rate, model_name = 'sharpeschoolhigh_1981')

modK202dGP <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = K202dGP,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(K202dGP$temp.Cat, K202dGP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(K202dGP$temp.Cat, K202dGP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modK202dGP)

M502aGP
start_vals <- get_start_vals(M502aGP$temp.Cat, M502aGP$log.rate, model_name = 'sharpeschoolhigh_1981')

modM502aGP <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = M502aGP,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(M502aGP$temp.Cat, M502aGP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(M502aGP$temp.Cat, M502aGP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modM502aGP)

M502bGP
start_vals <- get_start_vals(M502bGP$temp.Cat, M502bGP$log.rate, model_name = 'sharpeschoolhigh_1981')

modM502bGP <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = M502bGP,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(M502bGP$temp.Cat, M502bGP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(M502bGP$temp.Cat, M502bGP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modM502bGP)

M502cGP
start_vals <- get_start_vals(M502cGP$temp.Cat, M502cGP$log.rate, model_name = 'sharpeschoolhigh_1981')

modM502cGP <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = M502cGP,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(M502cGP$temp.Cat, M502cGP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(M502cGP$temp.Cat, M502cGP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modM502cGP)

M502dGP
start_vals <- get_start_vals(M502dGP$temp.Cat, M502dGP$log.rate, model_name = 'sharpeschoolhigh_1981')

modM502dGP <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = M502dGP,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(M502dGP$temp.Cat, M502dGP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(M502dGP$temp.Cat, M502dGP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modM502dGP)

M602aGP
start_vals <- get_start_vals(M602aGP$temp.Cat, M602aGP$log.rate, model_name = 'sharpeschoolhigh_1981')

modM602aGP <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = M602aGP,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(M602aGP$temp.Cat, M602aGP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(M602aGP$temp.Cat, M602aGP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modM602aGP)

M602bGP
start_vals <- get_start_vals(M602bGP$temp.Cat, M602bGP$log.rate, model_name = 'sharpeschoolhigh_1981')

modM602bGP <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = M602bGP,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(M602bGP$temp.Cat, M602bGP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(M602bGP$temp.Cat, M602bGP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modM602bGP)

M602cGP
start_vals <- get_start_vals(M602cGP$temp.Cat, M602cGP$log.rate, model_name = 'sharpeschoolhigh_1981')

modM602cGP <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = M602cGP,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(M602cGP$temp.Cat, M602cGP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(M602cGP$temp.Cat, M602cGP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modM602cGP)

M602dGP
start_vals <- get_start_vals(M602dGP$temp.Cat, M602dGP$log.rate, model_name = 'sharpeschoolhigh_1981')

modM602dGP <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = M602dGP,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(M602dGP$temp.Cat, M602dGP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(M602dGP$temp.Cat, M602dGP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modM602dGP)
```

Treatment 3 GP curve parameters for fragment.ID 

```{r}

head(K203aGP)
start_vals <- get_start_vals(K203aGP$temp.Cat, K203aGP$log.rate, model_name = 'sharpeschoolhigh_1981')

modK203aGP <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = K203aGP,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(K203aGP$temp.Cat, K203aGP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(K203aGP$temp.Cat, K203aGP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modK203aGP)


K203bGP
start_vals <- get_start_vals(K203bGP$temp.Cat, K203bGP$log.rate, model_name = 'sharpeschoolhigh_1981')

modK203bGP <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = K203bGP,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(K203bGP$temp.Cat, K203bGP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(K203bGP$temp.Cat, K203bGP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modK203bGP)

K203cGP
start_vals <- get_start_vals(K203cGP$temp.Cat, K203cGP$log.rate, model_name = 'sharpeschoolhigh_1981')

modK203cGP <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = K203cGP,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(K203cGP$temp.Cat, K203cGP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(K203cGP$temp.Cat, K203cGP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modK203cGP)

K203dGP
start_vals <- get_start_vals(K203dGP$temp.Cat, K203dGP$log.rate, model_name = 'sharpeschoolhigh_1981')

modK203dGP <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = K203dGP,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(K203dGP$temp.Cat, K203dGP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(K203dGP$temp.Cat, K203dGP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modK203dGP)

M503aGP
start_vals <- get_start_vals(M503aGP$temp.Cat, M503aGP$log.rate, model_name = 'sharpeschoolhigh_1981')

modM503aGP <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = M503aGP,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(M503aGP$temp.Cat, M503aGP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(M503aGP$temp.Cat, M503aGP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modM503aGP)

M503bGP
start_vals <- get_start_vals(M503bGP$temp.Cat, M503bGP$log.rate, model_name = 'sharpeschoolhigh_1981')

modM503bGP <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = M503bGP,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(M503bGP$temp.Cat, M503bGP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(M503bGP$temp.Cat, M503bGP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modM503bGP)

M503cGP
start_vals <- get_start_vals(M503cGP$temp.Cat, M503cGP$log.rate, model_name = 'sharpeschoolhigh_1981')

modM503cGP <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = M503cGP,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(M503cGP$temp.Cat, M503cGP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(M503cGP$temp.Cat, M503cGP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modM503cGP)

M503dGP
start_vals <- get_start_vals(M503dGP$temp.Cat, M503dGP$log.rate, model_name = 'sharpeschoolhigh_1981')

modM503dGP <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = M503dGP,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(M503dGP$temp.Cat, M503dGP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(M503dGP$temp.Cat, M503dGP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modM503dGP)

M603aGP
start_vals <- get_start_vals(M603aGP$temp.Cat, M603aGP$log.rate, model_name = 'sharpeschoolhigh_1981')

modM603aGP <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = M603aGP,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(M603aGP$temp.Cat, M603aGP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(M603aGP$temp.Cat, M603aGP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modM603aGP)

M603bGP
start_vals <- get_start_vals(M603bGP$temp.Cat, M603bGP$log.rate, model_name = 'sharpeschoolhigh_1981')

modM603bGP <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = M603bGP,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(M603bGP$temp.Cat, M603bGP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(M603bGP$temp.Cat, M603bGP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modM603bGP)

M603cGP
start_vals <- get_start_vals(M603cGP$temp.Cat, M603cGP$log.rate, model_name = 'sharpeschoolhigh_1981')

modM603cGP <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = M603cGP,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(M603cGP$temp.Cat, M603cGP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(M603cGP$temp.Cat, M603cGP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modM603cGP)

M603dGP
  start_vals <- get_start_vals(M603dGP$temp.Cat, M603dGP$log.rate, model_name = 'sharpeschoolhigh_1981')

modM603dGP <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = M603dGP,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(M603dGP$temp.Cat, M603dGP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(M603dGP$temp.Cat, M603dGP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modM603dGP)

```

Treatment C GP curve parameters for fragment.ID 

```{r}

head(K20CaGP)
start_vals <- get_start_vals(K20CaGP$temp.Cat, K20CaGP$log.rate, model_name = 'sharpeschoolhigh_1981')

modK20CaGP <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = K20CaGP,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(K20CaGP$temp.Cat, K20CaGP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(K20CaGP$temp.Cat, K20CaGP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modK20CaGP)


K20CbGP
start_vals <- get_start_vals(K20CbGP$temp.Cat, K20CbGP$log.rate, model_name = 'sharpeschoolhigh_1981')

modK20CbGP <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = K20CbGP,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(K20CbGP$temp.Cat, K20CbGP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(K20CbGP$temp.Cat, K20CbGP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modK20CbGP)

K20CcGP
start_vals <- get_start_vals(K20CcGP$temp.Cat, K20CcGP$log.rate, model_name = 'sharpeschoolhigh_1981')

modK20CcGP <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = K20CcGP,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(K20CcGP$temp.Cat, K20CcGP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(K20CcGP$temp.Cat, K20CcGP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modK20CcGP)

K20CdGP
start_vals <- get_start_vals(K20CdGP$temp.Cat, K20CdGP$log.rate, model_name = 'sharpeschoolhigh_1981')

modK20CdGP <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = K20CdGP,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(K20CdGP$temp.Cat, K20CdGP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(K20CdGP$temp.Cat, K20CdGP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modK20CdGP)

M50CaGP
start_vals <- get_start_vals(M50CaGP$temp.Cat, M50CaGP$log.rate, model_name = 'sharpeschoolhigh_1981')

modM50CaGP <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = M50CaGP,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(M50CaGP$temp.Cat, M50CaGP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(M50CaGP$temp.Cat, M50CaGP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modM50CaGP)

M50CbGP
start_vals <- get_start_vals(M50CbGP$temp.Cat, M50CbGP$log.rate, model_name = 'sharpeschoolhigh_1981')

modM50CbGP <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = M50CbGP,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(M50CbGP$temp.Cat, M50CbGP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(M50CbGP$temp.Cat, M50CbGP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modM50CbGP)

M50CcGP
start_vals <- get_start_vals(M50CcGP$temp.Cat, M50CcGP$log.rate, model_name = 'sharpeschoolhigh_1981')

modM50CcGP <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = M50CcGP,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(M50CcGP$temp.Cat, M50CcGP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(M50CcGP$temp.Cat, M50CcGP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modM50CcGP)


M60CaGP
start_vals <- get_start_vals(M60CaGP$temp.Cat, M60CaGP$log.rate, model_name = 'sharpeschoolhigh_1981')

modM60CaGP <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = M60CaGP,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(M60CaGP$temp.Cat, M60CaGP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(M60CaGP$temp.Cat, M60CaGP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modM60CaGP)

M60CbGP
start_vals <- get_start_vals(M60CbGP$temp.Cat, M60CbGP$log.rate, model_name = 'sharpeschoolhigh_1981')

modM60CbGP <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = M60CbGP,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(M60CbGP$temp.Cat, M60CbGP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(M60CbGP$temp.Cat, M60CbGP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modM60CbGP)

M60CcGP
start_vals <- get_start_vals(M60CcGP$temp.Cat, M60CcGP$log.rate, model_name = 'sharpeschoolhigh_1981')

modM60CcGP <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = M60CcGP,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(M60CcGP$temp.Cat, M60CcGP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(M60CcGP$temp.Cat, M60CcGP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modM60CcGP)

M60CdGP
  start_vals <- get_start_vals(M60CdGP$temp.Cat, M60CdGP$log.rate, model_name = 'sharpeschoolhigh_1981')

modM60CdGP <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = M60CdGP,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(M60CdGP$temp.Cat, M60CdGP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(M60CdGP$temp.Cat, M60CdGP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modM60CdGP)

```

Curve parameters By fragment.ID Treatment 1 R
 
```{r}
K201aGR

head(K201aGR)
start_vals <- get_start_vals(K201aGR$temp.Cat, K201aGR$log.rate, model_name = 'sharpeschoolhigh_1981')

modK201aGR <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = K201aGR,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(K201aGR$temp.Cat, K201aGR$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(K201aGR$temp.Cat, K201aGR$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modK201aGR)


K201bGR
start_vals <- get_start_vals(K201bGR$temp.Cat, K201bGR$log.rate, model_name = 'sharpeschoolhigh_1981')

modK201bGR <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = K201bGR,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(K201bGR$temp.Cat, K201bGR$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(K201bGR$temp.Cat, K201bGR$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modK201bGR)

K201cGR
start_vals <- get_start_vals(K201cGR$temp.Cat, K201cGR$log.rate, model_name = 'sharpeschoolhigh_1981')

modK201cGR <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = K201cGR,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(K201cGR$temp.Cat, K201cGR$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(K201cGR$temp.Cat, K201cGR$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modK201cGR)

K201dGR
start_vals <- get_start_vals(K201dGR$temp.Cat, K201dGR$log.rate, model_name = 'sharpeschoolhigh_1981')

modK201dGR <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = K201dGR,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(K201dGR$temp.Cat, K201dGR$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(K201dGR$temp.Cat, K201dGR$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modK201dGR)

M501aGR
start_vals <- get_start_vals(M501aGR$temp.Cat, M501aGR$log.rate, model_name = 'sharpeschoolhigh_1981')

modM501aGR <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = M501aGR,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(M501aGR$temp.Cat, M501aGR$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(M501aGR$temp.Cat, M501aGR$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modM501aGR)

M501bGR
start_vals <- get_start_vals(M501bGR$temp.Cat, M501bGR$log.rate, model_name = 'sharpeschoolhigh_1981')

modM501bGR <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = M501bGR,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(M501bGR$temp.Cat, M501bGR$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(M501bGR$temp.Cat, M501bGR$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modM501bGR)

M501cGR
start_vals <- get_start_vals(M501cGR$temp.Cat, M501cGR$log.rate, model_name = 'sharpeschoolhigh_1981')

modM501cGR <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = M501cGR,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(M501cGR$temp.Cat, M501cGR$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(M501cGR$temp.Cat, M501cGR$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modM501cGR)

M501dGR
start_vals <- get_start_vals(M501dGR$temp.Cat, M501dGR$log.rate, model_name = 'sharpeschoolhigh_1981')

modM501dGR <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = M501dGR,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(M501dGR$temp.Cat, M501dGR$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(M501dGR$temp.Cat, M501dGR$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modM501dGR)

M601aGR
start_vals <- get_start_vals(M601aGR$temp.Cat, M601aGR$log.rate, model_name = 'sharpeschoolhigh_1981')

modM601aGR <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = M601aGR,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(M601aGR$temp.Cat, M601aGR$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(M601aGR$temp.Cat, M601aGR$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modM601aGR)

M601bGR
start_vals <- get_start_vals(M601bGR$temp.Cat, M601bGR$log.rate, model_name = 'sharpeschoolhigh_1981')

modM601bGR <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = M601bGR,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(M601bGR$temp.Cat, M601bGR$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(M601bGR$temp.Cat, M601bGR$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modM601bGR)

M601cGR
start_vals <- get_start_vals(M601cGR$temp.Cat, M601cGR$log.rate, model_name = 'sharpeschoolhigh_1981')

modM601cGR <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = M601cGR,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(M601cGR$temp.Cat, M601cGR$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(M601cGR$temp.Cat, M601cGR$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modM601cGR)

M601dGR
start_vals <- get_start_vals(M601dGR$temp.Cat, M601dGR$log.rate, model_name = 'sharpeschoolhigh_1981')

modM601dGR <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = M601dGR,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(M601dGR$temp.Cat, M601dGR$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(M601dGR$temp.Cat, M601dGR$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modM601dGR)

```

Treatment 2 R curve parameters for fragment.ID 

```{r}

head(K202aGR)
start_vals <- get_start_vals(K202aGR$temp.Cat, K202aGR$log.rate, model_name = 'sharpeschoolhigh_1981')

modK202aGR <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = K202aGR,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(K202aGR$temp.Cat, K202aGR$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(K202aGR$temp.Cat, K202aGR$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modK202aGR)


K202bGR
start_vals <- get_start_vals(K202bGR$temp.Cat, K202bGR$log.rate, model_name = 'sharpeschoolhigh_1981')

modK202bGR <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = K202bGR,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(K202bGR$temp.Cat, K202bGR$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(K202bGR$temp.Cat, K202bGR$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modK202bGR)

K202cGR
start_vals <- get_start_vals(K202cGR$temp.Cat, K202cGR$log.rate, model_name = 'sharpeschoolhigh_1981')

modK202cGR <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = K202cGR,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(K202cGR$temp.Cat, K202cGR$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(K202cGR$temp.Cat, K202cGR$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modK202cGR)

K202dGR
start_vals <- get_start_vals(K202dGR$temp.Cat, K202dGR$log.rate, model_name = 'sharpeschoolhigh_1981')

modK202dGR <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = K202dGR,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(K202dGR$temp.Cat, K202dGR$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(K202dGR$temp.Cat, K202dGR$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modK202dGR)

M502aGR
start_vals <- get_start_vals(M502aGR$temp.Cat, M502aGR$log.rate, model_name = 'sharpeschoolhigh_1981')

modM502aGR <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = M502aGR,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(M502aGR$temp.Cat, M502aGR$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(M502aGR$temp.Cat, M502aGR$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modM502aGR)

M502bGR
start_vals <- get_start_vals(M502bGR$temp.Cat, M502bGR$log.rate, model_name = 'sharpeschoolhigh_1981')

modM502bGR <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = M502bGR,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(M502bGR$temp.Cat, M502bGR$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(M502bGR$temp.Cat, M502bGR$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modM502bGR)

M502cGR
start_vals <- get_start_vals(M502cGR$temp.Cat, M502cGR$log.rate, model_name = 'sharpeschoolhigh_1981')

modM502cGR <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = M502cGR,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(M502cGR$temp.Cat, M502cGR$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(M502cGR$temp.Cat, M502cGR$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modM502cGR)

M502dGR
start_vals <- get_start_vals(M502dGR$temp.Cat, M502dGR$log.rate, model_name = 'sharpeschoolhigh_1981')

modM502dGR <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = M502dGR,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(M502dGR$temp.Cat, M502dGR$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(M502dGR$temp.Cat, M502dGR$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modM502dGR)

M602aGR
start_vals <- get_start_vals(M602aGR$temp.Cat, M602aGR$log.rate, model_name = 'sharpeschoolhigh_1981')

modM602aGR <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = M602aGR,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(M602aGR$temp.Cat, M602aGR$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(M602aGR$temp.Cat, M602aGR$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modM602aGR)

## somethings wrong
## 
M602bGR
start_vals <- get_start_vals(M602bGR$temp.Cat, M602bGR$log.rate, model_name = 'sharpeschoolhigh_1981')

modM602bGR <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = M602bGR,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(M602bGR$temp.Cat, M602bGR$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(M602bGR$temp.Cat, M602bGR$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modM602bGR)

M602cGR
start_vals <- get_start_vals(M602cGR$temp.Cat, M602cGR$log.rate, model_name = 'sharpeschoolhigh_1981')

modM602cGR <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = M602cGR,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(M602cGR$temp.Cat, M602cGR$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(M602cGR$temp.Cat, M602cGR$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modM602cGR)

M602dGR
start_vals <- get_start_vals(M602dGR$temp.Cat, M602dGR$log.rate, model_name = 'sharpeschoolhigh_1981')

modM602dGR <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = M602dGR,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(M602dGR$temp.Cat, M602dGR$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(M602dGR$temp.Cat, M602dGR$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modM602dGR)
```

Treatment 3 R curve parameters for fragment.ID 

```{r}

head(K203aGR)
start_vals <- get_start_vals(K203aGR$temp.Cat, K203aGR$log.rate, model_name = 'sharpeschoolhigh_1981')

modK203aGR <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = K203aGR,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(K203aGR$temp.Cat, K203aGR$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(K203aGR$temp.Cat, K203aGR$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modK203aGR)


K203bGR
start_vals <- get_start_vals(K203bGR$temp.Cat, K203bGR$log.rate, model_name = 'sharpeschoolhigh_1981')

modK203bGR <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = K203bGR,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(K203bGR$temp.Cat, K203bGR$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(K203bGR$temp.Cat, K203bGR$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modK203bGR)

K203cGR
start_vals <- get_start_vals(K203cGR$temp.Cat, K203cGR$log.rate, model_name = 'sharpeschoolhigh_1981')

modK203cGR <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = K203cGR,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(K203cGR$temp.Cat, K203cGR$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(K203cGR$temp.Cat, K203cGR$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modK203cGR)

K203dGR
start_vals <- get_start_vals(K203dGR$temp.Cat, K203dGR$log.rate, model_name = 'sharpeschoolhigh_1981')

modK203dGR <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = K203dGR,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(K203dGR$temp.Cat, K203dGR$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(K203dGR$temp.Cat, K203dGR$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modK203dGR)

M503aGR
start_vals <- get_start_vals(M503aGR$temp.Cat, M503aGR$log.rate, model_name = 'sharpeschoolhigh_1981')

modM503aGR <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = M503aGR,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(M503aGR$temp.Cat, M503aGR$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(M503aGR$temp.Cat, M503aGR$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modM503aGR)

M503bGR
start_vals <- get_start_vals(M503bGR$temp.Cat, M503bGR$log.rate, model_name = 'sharpeschoolhigh_1981')

modM503bGR <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = M503bGR,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(M503bGR$temp.Cat, M503bGR$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(M503bGR$temp.Cat, M503bGR$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modM503bGR)

M503cGR
start_vals <- get_start_vals(M503cGR$temp.Cat, M503cGR$log.rate, model_name = 'sharpeschoolhigh_1981')

modM503cGR <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = M503cGR,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(M503cGR$temp.Cat, M503cGR$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(M503cGR$temp.Cat, M503cGR$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modM503cGR)

M503dGR
start_vals <- get_start_vals(M503dGR$temp.Cat, M503dGR$log.rate, model_name = 'sharpeschoolhigh_1981')

modM503dGR <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = M503dGR,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(M503dGR$temp.Cat, M503dGR$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(M503dGR$temp.Cat, M503dGR$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modM503dGR)

M603aGR
start_vals <- get_start_vals(M603aGR$temp.Cat, M603aGR$log.rate, model_name = 'sharpeschoolhigh_1981')

modM603aGR <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = M603aGR,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(M603aGR$temp.Cat, M603aGR$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(M603aGR$temp.Cat, M603aGR$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modM603aGR)

M603bGR
start_vals <- get_start_vals(M603bGR$temp.Cat, M603bGR$log.rate, model_name = 'sharpeschoolhigh_1981')

modM603bGR <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = M603bGR,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(M603bGR$temp.Cat, M603bGR$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(M603bGR$temp.Cat, M603bGR$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modM603bGR)

M603cGR
start_vals <- get_start_vals(M603cGR$temp.Cat, M603cGR$log.rate, model_name = 'sharpeschoolhigh_1981')

modM603cGR <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = M603cGR,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(M603cGR$temp.Cat, M603cGR$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(M603cGR$temp.Cat, M603cGR$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modM603cGR)

M603dGR
  start_vals <- get_start_vals(M603dGR$temp.Cat, M603dGR$log.rate, model_name = 'sharpeschoolhigh_1981')

modM603dGR <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = M603dGR,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(M603dGR$temp.Cat, M603dGR$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(M603dGR$temp.Cat, M603dGR$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modM603dGR)

```

Treatment C R curve parameters for fragment.ID 

```{r}

head(K20CaGR)
start_vals <- get_start_vals(K20CaGR$temp.Cat, K20CaGR$log.rate, model_name = 'sharpeschoolhigh_1981')

modK20CaGR <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = K20CaGR,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(K20CaGR$temp.Cat, K20CaGR$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(K20CaGR$temp.Cat, K20CaGR$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modK20CaGR)


K20CbGR
start_vals <- get_start_vals(K20CbGR$temp.Cat, K20CbGR$log.rate, model_name = 'sharpeschoolhigh_1981')

modK20CbGR <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = K20CbGR,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(K20CbGR$temp.Cat, K20CbGR$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(K20CbGR$temp.Cat, K20CbGR$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modK20CbGR)

K20CcGR
start_vals <- get_start_vals(K20CcGR$temp.Cat, K20CcGR$log.rate, model_name = 'sharpeschoolhigh_1981')

modK20CcGR <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = K20CcGR,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(K20CcGR$temp.Cat, K20CcGR$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(K20CcGR$temp.Cat, K20CcGR$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modK20CcGR)

K20CdGR
start_vals <- get_start_vals(K20CdGR$temp.Cat, K20CdGR$log.rate, model_name = 'sharpeschoolhigh_1981')

modK20CdGR <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = K20CdGR,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(K20CdGR$temp.Cat, K20CdGR$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(K20CdGR$temp.Cat, K20CdGR$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modK20CdGR)

M50CaGR
start_vals <- get_start_vals(M50CaGR$temp.Cat, M50CaGR$log.rate, model_name = 'sharpeschoolhigh_1981')

modM50CaGR <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = M50CaGR,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(M50CaGR$temp.Cat, M50CaGR$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(M50CaGR$temp.Cat, M50CaGR$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modM50CaGR)

M50CbGR
start_vals <- get_start_vals(M50CbGR$temp.Cat, M50CbGR$log.rate, model_name = 'sharpeschoolhigh_1981')

modM50CbGR <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = M50CbGR,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(M50CbGR$temp.Cat, M50CbGR$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(M50CbGR$temp.Cat, M50CbGR$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modM50CbGR)

M50CcGR
start_vals <- get_start_vals(M50CcGR$temp.Cat, M50CcGR$log.rate, model_name = 'sharpeschoolhigh_1981')

modM50CcGR <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = M50CcGR,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(M50CcGR$temp.Cat, M50CcGR$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(M50CcGR$temp.Cat, M50CcGR$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modM50CcGR)


M60CaGR
start_vals <- get_start_vals(M60CaGR$temp.Cat, M60CaGR$log.rate, model_name = 'sharpeschoolhigh_1981')

modM60CaGR <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = M60CaGR,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(M60CaGR$temp.Cat, M60CaGR$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(M60CaGR$temp.Cat, M60CaGR$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modM60CaGR)

M60CbGR
start_vals <- get_start_vals(M60CbGR$temp.Cat, M60CbGR$log.rate, model_name = 'sharpeschoolhigh_1981')

modM60CbGR <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = M60CbGR,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(M60CbGR$temp.Cat, M60CbGR$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(M60CbGR$temp.Cat, M60CbGR$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modM60CbGR)

M60CcGR
start_vals <- get_start_vals(M60CcGR$temp.Cat, M60CcGR$log.rate, model_name = 'sharpeschoolhigh_1981')

modM60CcGR <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = M60CcGR,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(M60CcGR$temp.Cat, M60CcGR$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(M60CcGR$temp.Cat, M60CcGR$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modM60CcGR)

M60CdGR
  start_vals <- get_start_vals(M60CdGR$temp.Cat, M60CdGR$log.rate, model_name = 'sharpeschoolhigh_1981')

modM60CdGR <- suppressWarnings(nls.multstart::nls_multstart(log.rate~sharpeschoolhigh_1981(temp = temp.Cat, r_tref,e,eh,th, tref = 15),
                                                     data = M60CdGR,
                                                     iter = rep(3, times = length(start_vals)),
                                                     start_lower = start_vals - 10,
                                                     start_upper = start_vals + 10,
                                                     lower = get_lower_lims(M60CdGR$temp.Cat, M60CdGR$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     upper = get_upper_lims(M60CdGR$temp.Cat, M60CdGP$log.rate, model_name = 'sharpeschoolhigh_1981'),
                                                     supp_errors = 'Y',
                                                     convergence_count = FALSE))

calc_params(modM60CdGP)

```

Parameter estimates for fragment.ID combine into dataframe

```{r}
PK201aGP<-calc_params(modK201aGP)
PK201bGP<-calc_params(modK201bGP)
PK201cGP<-calc_params(modK201cGP)
PK201dGP<-calc_params(modK201dGP)
PM501aGP<-calc_params(modM501aGP)
PM501bGP<-calc_params(modM501bGP)
PM501cGP<-calc_params(modM501cGP)
PM501dGP<-calc_params(modM501dGP)
PM601aGP<-calc_params(modM601aGP)
PM601bGP<-calc_params(modM601bGP)
PM601cGP<-calc_params(modM601cGP)
PM601dGP<-calc_params(modM601dGP)
PK202aGP<-calc_params(modK202aGP)
PK202bGP<-calc_params(modK202bGP)
PK202cGP<-calc_params(modK202cGP)
PK202dGP<-calc_params(modK202dGP)
PM502aGP<-calc_params(modM502aGP)
PM502bGP<-calc_params(modM502bGP)
PM502cGP<-calc_params(modM502cGP)
PM502dGP<-calc_params(modM502dGP)
PM602aGP<-calc_params(modM602aGP)
PM602bGP<-calc_params(modM602bGP)
PM602cGP<-calc_params(modM602cGP)
PM602dGP<-calc_params(modM602dGP)
PK203aGP<-calc_params(modK203aGP)
PK203bGP<-calc_params(modK203bGP)
PK203cGP<-calc_params(modK203cGP)
PK203dGP<-calc_params(modK203dGP)
PM503aGP<-calc_params(modM503aGP)
PM503bGP<-calc_params(modM503bGP)
PM503cGP<-calc_params(modM503cGP)
PM503dGP<-calc_params(modM503dGP)
PM603aGP<-calc_params(modM603aGP)
PM603bGP<-calc_params(modM603bGP)
PM603cGP<-calc_params(modM603cGP)
PM603dGP<-calc_params(modM603dGP)
PK20CaGP<-calc_params(modK20CaGP)
PK20CbGP<-calc_params(modK20CbGP)
PK20CcGP<-calc_params(modK20CcGP)
PK20CdGP<-calc_params(modK20CdGP)
PM50CaGP<-calc_params(modM50CaGP)
PM50CbGP<-calc_params(modM50CbGP)
PM50CcGP<-calc_params(modM50CcGP)
PM60CaGP<-calc_params(modM60CaGP)
PM60CbGP<-calc_params(modM60CbGP)
PM60CcGP<-calc_params(modM60CcGP)
PM60CdGP<-calc_params(modM60CdGP)
PK201aGR<-calc_params(modK201aGR)
PK201bGR<-calc_params(modK201bGR)
PK201cGR<-calc_params(modK201cGR)
PK201dGR<-calc_params(modK201dGR)
PM501aGR<-calc_params(modM501aGR)
PM501bGR<-calc_params(modM501bGR)
PM501cGR<-calc_params(modM501cGR)
PM501dGR<-calc_params(modM501dGR)
PM601aGR<-calc_params(modM601aGR)
PM601bGR<-calc_params(modM601bGR)
PM601cGR<-calc_params(modM601cGR)
PM601dGR<-calc_params(modM601dGR)
PK202aGR<-calc_params(modK202aGR)
PK202bGR<-calc_params(modK202bGR)
PK202cGR<-calc_params(modK202cGR)
PK202dGR<-calc_params(modK202dGR)
PM502aGR<-calc_params(modM502aGR)
PM502bGR<-calc_params(modM502bGR)
PM502cGR<-calc_params(modM502cGR)
PM502dGR<-calc_params(modM502dGR)
#PM602aGR<-calc_params(modM602aGR)
PM602bGR<-calc_params(modM602bGR)
PM602cGR<-calc_params(modM602cGR)
PM602dGR<-calc_params(modM602dGR)
PK203aGR<-calc_params(modK203aGR)
PK203bGR<-calc_params(modK203bGR)
PK203cGR<-calc_params(modK203cGR)
PK203dGR<-calc_params(modK203dGR)
PM503aGR<-calc_params(modM503aGR)
PM503bGR<-calc_params(modM503bGR)
PM503cGR<-calc_params(modM503cGR)
PM503dGR<-calc_params(modM503dGR)
PM603aGR<-calc_params(modM603aGR)
PM603bGR<-calc_params(modM603bGR)
PM603cGR<-calc_params(modM603cGR)
PM603dGR<-calc_params(modM603dGR)
PK20CaGR<-calc_params(modK20CaGR)
PK20CbGR<-calc_params(modK20CbGR)
PK20CcGR<-calc_params(modK20CcGR)
PK20CdGR<-calc_params(modK20CdGR)
PM50CaGR<-calc_params(modM50CaGR)
PM50CbGR<-calc_params(modM50CbGR)
PM50CcGR<-calc_params(modM50CcGR)
#PM50CdGR<-calc_params(modM50CdGR)
PM60CaGR<-calc_params(modM60CaGR)
PM60CbGR<-calc_params(modM60CbGR)
PM60CcGR<-calc_params(modM60CcGR)
PM60CdGR<-calc_params(modM60CdGR)
```

Make columns

```{r}
PK201aGP
trea<-'T1'
rate<-'GP'
frag<-'K201a'
geno<-'K2'
PK201aGP$treatment<-trea
PK201aGP$rate.type<-rate
PK201aGP$fragmentI<-frag
PK201aGP$genotype<-geno


PK201bGP
trea<-'T1'
rate<-'GP'
frag<-'K201b'
geno<-'K2'
PK201bGP$treatment<-trea
PK201bGP$rate.type<-rate
PK201bGP$fragmentI<-frag
PK201bGP$genotype<-geno


PK201cGP
trea<-'T1'
rate<-'GP'
frag<-'K201c'
geno<-'K2'
PK201cGP$treatment<-trea
PK201cGP$rate.type<-rate
PK201cGP$fragmentI<-frag
PK201cGP$genotype<-geno

PK201dGP
trea<-'T1'
rate<-'GP'
frag<-'K201d'
geno<-'K2'
PK201dGP$treatment<-trea
PK201dGP$rate.type<-rate
PK201dGP$fragmentI<-frag
PK201dGP$genotype<-geno

PM501aGP
trea<-'T1'
rate<-'GP'
frag<-'M501a'
geno<-'M5'
PM501aGP$treatment<-trea
PM501aGP$rate.type<-rate
PM501aGP$fragmentI<-frag
PM501aGP$genotype<-geno

PM501bGP
trea<-'T1'
rate<-'GP'
frag<-'M501b'
geno<-'M5'
PM501bGP$treatment<-trea
PM501bGP$rate.type<-rate
PM501bGP$fragmentI<-frag
PM501bGP$genotype<-geno

PM501cGP
trea<-'T1'
rate<-'GP'
frag<-'M501c'
geno<-'M5'
PM501cGP$treatment<-trea
PM501cGP$rate.type<-rate
PM501cGP$fragmentI<-frag
PM501cGP$genotype<-geno

PM501dGP
trea<-'T1'
rate<-'GP'
frag<-'M501d'
geno<-'M5'
PM501dGP$treatment<-trea
PM501dGP$rate.type<-rate
PM501dGP$fragmentI<-frag
PM501dGP$genotype<-geno

PM601aGP
trea<-'T1'
rate<-'GP'
frag<-'M601a'
geno<-'M6'
PM601aGP$treatment<-trea
PM601aGP$rate.type<-rate
PM601aGP$fragmentI<-frag
PM601aGP$genotype<-geno

PM601bGP
trea<-'T1'
rate<-'GP'
frag<-'M601b'
geno<-'M6'
PM601bGP$treatment<-trea
PM601bGP$rate.type<-rate
PM601bGP$fragmentI<-frag
PM601bGP$genotype<-geno

PM601cGP
trea<-'T1'
rate<-'GP'
frag<-'M601c'
geno<-'M6'
PM601cGP$treatment<-trea
PM601cGP$rate.type<-rate
PM601cGP$fragmentI<-frag
PM601cGP$genotype<-geno

PM601dGP
trea<-'T1'
rate<-'GP'
frag<-'M601d'
geno<-'M6'
PM601dGP$treatment<-trea
PM601dGP$rate.type<-rate
PM601dGP$fragmentI<-frag
PM601dGP$genotype<-geno

PK202aGP
trea<-'T2'
rate<-'GP'
frag<-'K202a'
geno<-'K2'
PK202aGP$treatment<-trea
PK202aGP$rate.type<-rate
PK202aGP$fragmentI<-frag
PK202aGP$genotype<-geno

PK202bGP
trea<-'T2'
rate<-'GP'
frag<-'K202b'
geno<-'K2'
PK202bGP$treatment<-trea
PK202bGP$rate.type<-rate
PK202bGP$fragmentI<-frag
PK202bGP$genotype<-geno

PK202cGP
trea<-'T2'
rate<-'GP'
frag<-'K202c'
geno<-'K2'
PK202cGP$treatment<-trea
PK202cGP$rate.type<-rate
PK202cGP$fragmentI<-frag
PK202cGP$genotype<-geno

PK202dGP
trea<-'T2'
rate<-'GP'
frag<-'K202d'
geno<-'K2'
PK202dGP$treatment<-trea
PK202dGP$rate.type<-rate
PK202dGP$fragmentI<-frag
PK202dGP$genotype<-geno

PM502aGP
trea<-'T2'
rate<-'GP'
frag<-'M502a'
geno<-'M5'
PM502aGP$treatment<-trea
PM502aGP$rate.type<-rate
PM502aGP$fragmentI<-frag
PM502aGP$genotype<-geno

PM502bGP
trea<-'T2'
rate<-'GP'
frag<-'M502b'
geno<-'M5'
PM502bGP$treatment<-trea
PM502bGP$rate.type<-rate
PM502bGP$fragmentI<-frag
PM502bGP$genotype<-geno

PM502cGP
trea<-'T2'
rate<-'GP'
frag<-'M502c'
geno<-'M5'
PM502cGP$treatment<-trea
PM502cGP$rate.type<-rate
PM502cGP$fragmentI<-frag
PM502cGP$genotype<-geno

PM502dGP
trea<-'T2'
rate<-'GP'
frag<-'M502d'
geno<-'M5'
PM502dGP$treatment<-trea
PM502dGP$rate.type<-rate
PM502dGP$fragmentI<-frag
PM502dGP$genotype<-geno

PM602aGP
trea<-'T2'
rate<-'GP'
frag<-'M602a'
geno<-'M6'
PM602aGP$treatment<-trea
PM602aGP$rate.type<-rate
PM602aGP$fragmentI<-frag
PM602aGP$genotype<-geno

PM602bGP
trea<-'T2'
rate<-'GP'
frag<-'M602b'
geno<-'M6'
PM602bGP$treatment<-trea
PM602bGP$rate.type<-rate
PM602bGP$fragmentI<-frag
PM602bGP$genotype<-geno

PM602cGP
trea<-'T2'
rate<-'GP'
frag<-'M602c'
geno<-'M6'
PM602cGP$treatment<-trea
PM602cGP$rate.type<-rate
PM602cGP$fragmentI<-frag
PM602cGP$genotype<-geno

PM602dGP
trea<-'T2'
rate<-'GP'
frag<-'M602d'
geno<-'M6'
PM602dGP$treatment<-trea
PM602dGP$rate.type<-rate
PM602dGP$fragmentI<-frag
PM602dGP$genotype<-geno

PK203aGP
trea<-'T3'
rate<-'GP'
frag<-'K203a'
geno<-'K2'
PK203aGP$treatment<-trea
PK203aGP$rate.type<-rate
PK203aGP$fragmentI<-frag
PK203aGP$genotype<-geno

PK203bGP
trea<-'T3'
rate<-'GP'
frag<-'K203b'
geno<-'K2'
PK203bGP$treatment<-trea
PK203bGP$rate.type<-rate
PK203bGP$fragmentI<-frag
PK203bGP$genotype<-geno

PK203cGP
trea<-'T3'
rate<-'GP'
frag<-'K203c'
geno<-'K2'
PK203cGP$treatment<-trea
PK203cGP$rate.type<-rate
PK203cGP$fragmentI<-frag
PK203cGP$genotype<-geno

PK203dGP
trea<-'T3'
rate<-'GP'
frag<-'K203d'
geno<-'K2'
PK203dGP$treatment<-trea
PK203dGP$rate.type<-rate
PK203dGP$fragmentI<-frag
PK203dGP$genotype<-geno

PM503aGP
trea<-'T3'
rate<-'GP'
frag<-'M503a'
geno<-'M5'
PM503aGP$treatment<-trea
PM503aGP$rate.type<-rate
PM503aGP$fragmentI<-frag
PM503aGP$genotype<-geno

PM503bGP
trea<-'T3'
rate<-'GP'
frag<-'M503b'
geno<-'M5'
PM503bGP$treatment<-trea
PM503bGP$rate.type<-rate
PM503bGP$fragmentI<-frag
PM503bGP$genotype<-geno

PM503cGP
trea<-'T3'
rate<-'GP'
frag<-'M503c'
geno<-'M5'
PM503cGP$treatment<-trea
PM503cGP$rate.type<-rate
PM503cGP$fragmentI<-frag
PM503cGP$genotype<-geno

PM503dGP
trea<-'T3'
rate<-'GP'
frag<-'M503d'
geno<-'M5'
PM503dGP$treatment<-trea
PM503dGP$rate.type<-rate
PM503dGP$fragmentI<-frag
PM503dGP$genotype<-geno

PM603aGP
trea<-'T3'
rate<-'GP'
frag<-'M603a'
geno<-'M6'
PM603aGP$treatment<-trea
PM603aGP$rate.type<-rate
PM603aGP$fragmentI<-frag
PM603aGP$genotype<-geno

PM603bGP
trea<-'T3'
rate<-'GP'
frag<-'M603b'
geno<-'M6'
PM603bGP$treatment<-trea
PM603bGP$rate.type<-rate
PM603bGP$fragmentI<-frag
PM603bGP$genotype<-geno

PM603cGP
trea<-'T3'
rate<-'GP'
frag<-'M603c'
geno<-'M6'
PM603cGP$treatment<-trea
PM603cGP$rate.type<-rate
PM603cGP$fragmentI<-frag
PM603cGP$genotype<-geno

PM603dGP
trea<-'T3'
rate<-'GP'
frag<-'M603d'
geno<-'M6'
PM603dGP$treatment<-trea
PM603dGP$rate.type<-rate
PM603dGP$fragmentI<-frag
PM603dGP$genotype<-geno

PK20CaGP
trea<-'TC'
rate<-'GP'
frag<-'K20Ca'
geno<-'K2'
PK20CaGP$treatment<-trea
PK20CaGP$rate.type<-rate
PK20CaGP$fragmentI<-frag
PK20CaGP$genotype<-geno

PK20CbGP
trea<-'TC'
rate<-'GP'
frag<-'K20Cb'
geno<-'K2'
PK20CbGP$treatment<-trea
PK20CbGP$rate.type<-rate
PK20CbGP$fragmentI<-frag
PK20CbGP$genotype<-geno

PK20CcGP
trea<-'TC'
rate<-'GP'
frag<-'K20Cc'
geno<-'K2'
PK20CcGP$treatment<-trea
PK20CcGP$rate.type<-rate
PK20CcGP$fragmentI<-frag
PK20CcGP$genotype<-geno

PK20CdGP
trea<-'TC'
rate<-'GP'
frag<-'K20Cd'
geno<-'K2'
PK20CdGP$treatment<-trea
PK20CdGP$rate.type<-rate
PK20CdGP$fragmentI<-frag
PK20CdGP$genotype<-geno

PM50CaGP
trea<-'TC'
rate<-'GP'
frag<-'M50Ca'
geno<-'M5'
PM50CaGP$treatment<-trea
PM50CaGP$rate.type<-rate
PM50CaGP$fragmentI<-frag
PM50CaGP$genotype<-geno

PM50CbGP
trea<-'TC'
rate<-'GP'
frag<-'M50Cb'
geno<-'M5'
PM50CbGP$treatment<-trea
PM50CbGP$rate.type<-rate
PM50CbGP$fragmentI<-frag
PM50CbGP$genotype<-geno

PM50CcGP
trea<-'TC'
rate<-'GP'
frag<-'M50Cc'
geno<-'M5'
PM50CcGP$treatment<-trea
PM50CcGP$rate.type<-rate
PM50CcGP$fragmentI<-frag
PM50CcGP$genotype<-geno

PM60CaGP
trea<-'TC'
rate<-'GP'
frag<-'M60Ca'
geno<-'M6'
PM60CaGP$treatment<-trea
PM60CaGP$rate.type<-rate
PM60CaGP$fragmentI<-frag
PM60CaGP$genotype<-geno

PM60CbGP
trea<-'TC'
rate<-'GP'
frag<-'M60Cb'
geno<-'M6'
PM60CbGP$treatment<-trea
PM60CbGP$rate.type<-rate
PM60CbGP$fragmentI<-frag
PM60CbGP$genotype<-geno

PM60CcGP
trea<-'TC'
rate<-'GP'
frag<-'M60Cc'
geno<-'M6'
PM60CcGP$treatment<-trea
PM60CcGP$rate.type<-rate
PM60CcGP$fragmentI<-frag
PM60CcGP$genotype<-geno

PM60CdGP
trea<-'TC'
rate<-'GP'
frag<-'M60Cd'
geno<-'M6'
PM60CdGP$treatment<-trea
PM60CdGP$rate.type<-rate
PM60CdGP$fragmentI<-frag
PM60CdGP$genotype<-geno

PK201aGR
trea<-'T1'
rate<-'R'
frag<-'K201a'
geno<-'K2'
PK201aGR$treatment<-trea
PK201aGR$rate.type<-rate
PK201aGR$fragmentI<-frag
PK201aGR$genotype<-geno

PK201bGR
trea<-'T1'
rate<-'R'
frag<-'K201b'
geno<-'K2'
PK201bGR$treatment<-trea
PK201bGR$rate.type<-rate
PK201bGR$fragmentI<-frag
PK201bGR$genotype<-geno

PK201cGR
trea<-'T1'
rate<-'R'
frag<-'K201c'
geno<-'K2'
PK201cGR$treatment<-trea
PK201cGR$rate.type<-rate
PK201cGR$fragmentI<-frag
PK201cGR$genotype<-geno

PK201dGR
trea<-'T1'
rate<-'R'
frag<-'K201d'
geno<-'K2'
PK201dGR$treatment<-trea
PK201dGR$rate.type<-rate
PK201dGR$fragmentI<-frag
PK201dGR$genotype<-geno

PM501aGR
trea<-'T1'
rate<-'R'
frag<-'M501a'
geno<-'M5'
PM501aGR$treatment<-trea
PM501aGR$rate.type<-rate
PM501aGR$fragmentI<-frag
PM501aGR$genotype<-geno

PM501bGR
trea<-'T1'
rate<-'R'
frag<-'M501b'
geno<-'M5'
PM501bGR$treatment<-trea
PM501bGR$rate.type<-rate
PM501bGR$fragmentI<-frag
PM501bGR$genotype<-geno

PM501cGR
trea<-'T1'
rate<-'R'
frag<-'M501c'
geno<-'M5'
PM501cGR$treatment<-trea
PM501cGR$rate.type<-rate
PM501cGR$fragmentI<-frag
PM501cGR$genotype<-geno

PM501dGR
trea<-'T1'
rate<-'R'
frag<-'M501d'
geno<-'M5'
PM501dGR$treatment<-trea
PM501dGR$rate.type<-rate
PM501dGR$fragmentI<-frag
PM501dGR$genotype<-geno

PM601aGR
trea<-'T1'
rate<-'R'
frag<-'M601a'
geno<-'M6'
PM601aGR$treatment<-trea
PM601aGR$rate.type<-rate
PM601aGR$fragmentI<-frag
PM601aGR$genotype<-geno

PM601bGR
trea<-'T1'
rate<-'R'
frag<-'M601b'
geno<-'M6'
PM601bGR$treatment<-trea
PM601bGR$rate.type<-rate
PM601bGR$fragmentI<-frag
PM601bGR$genotype<-geno

PM601cGR
trea<-'T1'
rate<-'R'
frag<-'M601c'
geno<-'M6'
PM601cGR$treatment<-trea
PM601cGR$rate.type<-rate
PM601cGR$fragmentI<-frag
PM601cGR$genotype<-geno

PM601dGR
trea<-'T1'
rate<-'R'
frag<-'M601d'
geno<-'M6'
PM601dGR$treatment<-trea
PM601dGR$rate.type<-rate
PM601dGR$fragmentI<-frag
PM601dGR$genotype<-geno

PK202aGR
trea<-'T2'
rate<-'R'
frag<-'K202a'
geno<-'K2'
PK202aGR$treatment<-trea
PK202aGR$rate.type<-rate
PK202aGR$fragmentI<-frag
PK202aGR$genotype<-geno

PK202bGR
trea<-'T2'
rate<-'R'
frag<-'K202b'
geno<-'K2'
PK202bGR$treatment<-trea
PK202bGR$rate.type<-rate
PK202bGR$fragmentI<-frag
PK202bGR$genotype<-geno

PK202cGR
trea<-'T2'
rate<-'R'
frag<-'K202c'
geno<-'K2'
PK202cGR$treatment<-trea
PK202cGR$rate.type<-rate
PK202cGR$fragmentI<-frag
PK202cGR$genotype<-geno

PK202dGR
trea<-'T2'
rate<-'R'
frag<-'K202d'
geno<-'K2'
PK202dGR$treatment<-trea
PK202dGR$rate.type<-rate
PK202dGR$fragmentI<-frag
PK202dGR$genotype<-geno

PM502aGR
trea<-'T2'
rate<-'R'
frag<-'M502a'
geno<-'M5'
PM502aGR$treatment<-trea
PM502aGR$rate.type<-rate
PM502aGR$fragmentI<-frag
PM502aGR$genotype<-geno

PM502bGR
trea<-'T2'
rate<-'R'
frag<-'M502b'
geno<-'M5'
PM502bGR$treatment<-trea
PM502bGR$rate.type<-rate
PM502bGR$fragmentI<-frag
PM502bGR$genotype<-geno

PM502cGR
trea<-'T2'
rate<-'R'
frag<-'M502c'
geno<-'M5'
PM502cGR$treatment<-trea
PM502cGR$rate.type<-rate
PM502cGR$fragmentI<-frag
PM502cGR$genotype<-geno

PM502dGR
trea<-'T2'
rate<-'R'
frag<-'M502d'
geno<-'M5'
PM502dGR$treatment<-trea
PM502dGR$rate.type<-rate
PM502dGR$fragmentI<-frag
PM502dGR$genotype<-geno

#PM602aGR
#trea<-'T2'
#rate<-'R'
#frag<-'M602a'
#geno<='M6'
#PM602aGR$treatment<-trea
#PM602aGR$rate.type<-rate
#PM602aGR$fragmentI<-frag
#PM602aGR$genotype<-geno
# WEIRD ONE

PM602bGR
trea<-'T2'
rate<-'R'
frag<-'M602b'
geno<-'M6'
PM602bGR$treatment<-trea
PM602bGR$rate.type<-rate
PM602bGR$fragmentI<-frag
PM602bGR$genotype<-geno

PM602cGR
trea<-'T2'
rate<-'R'
frag<-'M602c'
geno<-'M6'
PM602cGR$treatment<-trea
PM602cGR$rate.type<-rate
PM602cGR$fragmentI<-frag
PM602cGR$genotype<-geno

PM602dGR
trea<-'T2'
rate<-'R'
frag<-'M602d'
geno<-'M6'
PM602dGR$treatment<-trea
PM602dGR$rate.type<-rate
PM602dGR$fragmentI<-frag
PM602dGR$genotype<-geno

PK203aGR
trea<-'T3'
rate<-'R'
frag<-'K203a'
geno<-'K2'
PK203aGR$treatment<-trea
PK203aGR$rate.type<-rate
PK203aGR$fragmentI<-frag
PK203aGR$genotype<-geno

PK203bGR
trea<-'T3'
rate<-'R'
frag<-'K203b'
geno<-'K2'
PK203bGR$treatment<-trea
PK203bGR$rate.type<-rate
PK203bGR$fragmentI<-frag
PK203bGR$genotype<-geno

PK203cGR
trea<-'T3'
rate<-'R'
frag<-'K203c'
geno<-'K2'
PK203cGR$treatment<-trea
PK203cGR$rate.type<-rate
PK203cGR$fragmentI<-frag
PK203cGR$genotype<-geno

PK203dGR
trea<-'T3'
rate<-'R'
frag<-'K203d'
geno<-"K2"
PK203dGR$treatment<-trea
PK203dGR$rate.type<-rate
PK203dGR$fragmentI<-frag
PK203dGR$genotype<-geno

PM503aGR
trea<-'T3'
rate<-'R'
frag<-'M503a'
geno<-'M5'
PM503aGR$treatment<-trea
PM503aGR$rate.type<-rate
PM503aGR$fragmentI<-frag
PM503aGR$genotype<-geno

PM503bGR
trea<-'T3'
rate<-'R'
frag<-'M503b'
geno<-'M5'
PM503bGR$treatment<-trea
PM503bGR$rate.type<-rate
PM503bGR$fragmentI<-frag
PM503bGR$genotype<-geno

PM503cGR
trea<-'T3'
rate<-'R'
frag<-'M503c'
geno<-"M5"
PM503cGR$treatment<-trea
PM503cGR$rate.type<-rate
PM503cGR$fragmentI<-frag
PM503cGR$genotype<-geno

PM503dGR
trea<-'T3'
rate<-'R'
frag<-'M503d'
geno<-"M5"
PM503dGR$treatment<-trea
PM503dGR$rate.type<-rate
PM503dGR$fragmentI<-frag
PM503dGR$genotype<-geno

PM603aGR
trea<-'T3'
rate<-'R'
frag<-'M603a'
geno<-"M6"
PM603aGR$treatment<-trea
PM603aGR$rate.type<-rate
PM603aGR$fragmentI<-frag
PM603aGR$genotype<-geno

PM603bGR
trea<-'T3'
rate<-'R'
frag<-'M603b'
geno<-"M6"
PM603bGR$treatment<-trea
PM603bGR$rate.type<-rate
PM603bGR$fragmentI<-frag
PM603bGR$genotype<-geno


PM603cGR
trea<-'T3'
rate<-'R'
frag<-'M603c'
geno<-"M6"
PM603cGR$treatment<-trea
PM603cGR$rate.type<-rate
PM603cGR$fragmentI<-frag
PM603cGR$genotype<-geno

PM603dGR
trea<-'T3'
rate<-'R'
frag<-'M603d'
geno<-"M6"
PM603dGR$treatment<-trea
PM603dGR$rate.type<-rate
PM603dGR$fragmentI<-frag
PM603dGR$genotype<-geno


PK20CaGR
trea<-'TC'
rate<-'R'
frag<-'K20Ca'
geno<-"K2"
PK20CaGR$treatment<-trea
PK20CaGR$rate.type<-rate
PK20CaGR$fragmentI<-frag
PK20CaGR$genotype<-geno

PK20CbGR
trea<-'TC'
rate<-'R'
frag<-'K20Cb'
geno<-"K2"
PK20CbGR$treatment<-trea
PK20CbGR$rate.type<-rate
PK20CbGR$fragmentI<-frag
PK20CbGR$genotype<-geno

PK20CcGR
trea<-'TC'
rate<-'R'
frag<-'K20Cc'
geno<-"K2"
PK20CcGR$treatment<-trea
PK20CcGR$rate.type<-rate
PK20CcGR$fragmentI<-frag
PK20CcGR$genotype<-geno

PK20CdGR
trea<-'TC'
rate<-'R'
frag<-'K20Cd'
geno<-'K2'
PK20CdGR$treatment<-trea
PK20CdGR$rate.type<-rate
PK20CdGR$fragmentI<-frag
PK20CdGR$genotype<-geno

PM50CaGR
trea<-'TC'
rate<-'R'
frag<-'M50Ca'
geno<-'M5'
PM50CaGR$treatment<-trea
PM50CaGR$rate.type<-rate
PM50CaGR$fragmentI<-frag
PM50CaGR$genotype<-geno

PM50CbGR
trea<-'TC'
rate<-'R'
frag<-'M50Cb'
geno<-"M5"
PM50CbGR$treatment<-trea
PM50CbGR$rate.type<-rate
PM50CbGR$fragmentI<-frag
PM50CbGR$genotype<-geno

PM50CcGR
trea<-'TC'
rate<-'R'
frag<-'M50Cc'
geno<-"M5"
PM50CcGR$treatment<-trea
PM50CcGR$rate.type<-rate
PM50CcGR$fragmentI<-frag
PM50CcGR$genotype<-geno

PM60CaGR
trea<-'TC'
rate<-'R'
frag<-'M60Ca'
geno<-"M6"
PM60CaGR$treatment<-trea
PM60CaGR$rate.type<-rate
PM60CaGR$fragmentI<-frag
PM60CaGR$genotype<-geno

PM60CbGR
trea<-'TC'
rate<-'R'
frag<-'M60Cb'
geno<-"M6"
PM60CbGR$treatment<-trea
PM60CbGR$rate.type<-rate
PM60CbGR$fragmentI<-frag
PM60CbGR$genotype<-geno

PM60CcGR
trea<-'TC'
rate<-'R'
frag<-'M60Cc'
geno<-"M6"
PM60CcGR$treatment<-trea
PM60CcGR$rate.type<-rate
PM60CcGR$fragmentI<-frag
PM60CcGR$genotype<-geno

PM60CdGR
trea<-'TC'
rate<-'R'
frag<-'M60Cd'
geno<-"M6"
PM60CdGR$treatment<-trea
PM60CdGR$rate.type<-rate
PM60CdGR$fragmentI<-frag
PM60CdGR$genotype<-geno

```

Bind into one dataframe fragment Parameters R and R
```{r}
parametersFrag<- rbind(
PK201aGP,
PK201bGP,
PK201cGP,
PK201dGP,
PM501aGP,
PM501bGP,
PM501cGP,
PM501dGP,
PM601aGP,
PM601bGP,
PM601cGP,
PM601dGP,
PK202aGP,
PK202bGP,
PK202cGP,
PK202dGP,
PM502aGP,
PM502bGP,
PM502cGP,
PM502dGP,
PM602aGP,
PM602bGP,
PM602cGP,
PM602dGP,
PK203aGP,
PK203bGP,
PK203cGP,
PK203dGP,
PM503aGP,
PM503bGP,
PM503cGP,
PM503dGP,
PM603aGP,
PM603bGP,
PM603cGP,
PM603dGP,
PK20CaGP,
PK20CbGP,
PK20CcGP,
PK20CdGP,
PM50CaGP,
PM50CbGP,
PM50CcGP,
PM60CaGP,
PM60CbGP,
PM60CcGP,
PM60CdGP,
PK201aGR,
PK201bGR,
PK201cGR,
PK201dGR,
PM501aGR,
PM501bGR,
PM501cGR,
PM501dGR,
PM601aGR,
PM601bGR,
PM601cGR,
PM601dGR,
PK202aGR,
PK202bGR,
PK202cGR,
PK202dGR,
PM502aGR,
PM502bGR,
PM502cGR,
PM502dGR,
#PM602aGR,
PM602bGR,
PM602cGR,
PM602dGR,
PK203aGR,
PK203bGR,
PK203cGR,
PK203dGR,
PM503aGR,
PM503bGR,
PM503cGR,
PM503dGR,
PM603aGR,
PM603bGR,
PM603cGR,
PM603dGR,
PK20CaGR,
PK20CbGR,
PK20CcGR,
PK20CdGR,
PM50CaGR,
PM50CbGR,
PM50CcGR,
PM60CaGR,
PM60CbGR,
PM60CcGR,
PM60CdGR)
```

rmax R

```{r}
head(parametersFrag)
View(parametersFrag)
#write.csv(parametersFrag, "C:/Github/TPC_Acropora/R_output_Data_Frames/TPCparametersFrag.csv")
#parametersFrag<-read.csv("C:/Github/TPC_Acropora/R_output_Data_Frames/TPCparametersFrag.csv")
parametersFragR<-parametersFrag%>%
  filter(rate.type=="R")
parametersFragGP<-parametersFrag%>%
  filter(rate.type=="GP")
```

Pmax GP

```{r}

#Pmax- GP
parametersFragGPPmax<-parametersFrag%>%
  filter(rate.type=="GP")

SSt = summarySE(parametersFragGPPmax, measurevar="rmax",
                     groupvars=c("genotype", "treatment", "rate.type"))

SSt
SSt = summarySE(parametersFragGPPmax, measurevar="rmax",
                     groupvars=c("genotype", "rate.type"))

SSt
SSt = summarySE(parametersFragGPPmax, measurevar="rmax",
                     groupvars=c("treatment", "rate.type"))

SSt
SSt = summarySE(parametersFragGPPmax, measurevar="rmax",
                     groupvars=c("rate.type"))

SSt

#Rmax R
parametersFragGRrmax<-parametersFrag%>%
  filter(rate.type=="R")

SSt = summarySE(parametersFragGRrmax, measurevar="rmax",
                     groupvars=c("genotype", "treatment", "rate.type"))

SSt
SSt = summarySE(parametersFragGRrmax, measurevar="rmax",
                     groupvars=c("genotype", "rate.type"))

SSt
SSt = summarySE(parametersFragGRrmax, measurevar="rmax",
                     groupvars=c("treatment", "rate.type"))

SSt
SSt = summarySE(parametersFragGRrmax, measurevar="rmax",
                     groupvars=c("rate.type"))

SSt
#M602aGR is not working for any parameter
#R N=46 GP n=47
#M5GP/R all treatments & M6R (T2)
SSt = summarySE(parametersFrag, measurevar="rmax",
                     groupvars=c("rate.type"))

SSt
```

Topt

```{r}
#Topt R
parametersFragGRTopt<-parametersFrag%>%
  filter(rate.type=="R")

SSt = summarySE(parametersFragGRTopt, measurevar="topt",
                     groupvars=c("genotype", "treatment", "rate.type"))

SSt
SSt = summarySE(parametersFragGRTopt, measurevar="topt",
                     groupvars=c("genotype", "rate.type"))

SSt
SSt = summarySE(parametersFragGRTopt, measurevar="topt",
                     groupvars=c("treatment", "rate.type"))

SSt
SSt = summarySE(parametersFragGRTopt, measurevar="topt",
                     groupvars=c("rate.type"))

SSt

#Topt GP
parametersFragGPTopt<-parametersFrag%>%
  filter(rate.type=="GP")

SSt = summarySE(parametersFragGPTopt, measurevar="topt",
                     groupvars=c("genotype", "treatment", "rate.type"))

SSt
SSt = summarySE(parametersFragGPTopt, measurevar="topt",
                     groupvars=c("genotype", "rate.type"))

SSt
SSt = summarySE(parametersFragGPTopt, measurevar="topt",
                     groupvars=c("treatment", "rate.type"))

SSt
SSt = summarySE(parametersFragGPTopt, measurevar="topt",
                     groupvars=c("rate.type"))

SSt

SSt = summarySE(parametersFrag, measurevar="topt",
                     groupvars=c("rate.type"))

SSt
```

ctmin 
R only

```{r}
parametersFragRFc<-parametersFragR%>%
  filter(rate.type=="R")
# Inf R M60Cb- remove
parametersFragRFc%<>%
  filter(fragmentI!="M60Cb")

SSt = summarySE(parametersFragRFc, measurevar="ctmin",
                     groupvars=c("genotype", "treatment", "rate.type"))

SSt

SSt = summarySE(parametersFragRFc, measurevar="ctmin",
                     groupvars=c("genotype", "rate.type"))

SSt
SSt = summarySE(parametersFragRFc, measurevar="ctmin",
                     groupvars=c("treatment", "rate.type"))

SSt
SSt = summarySE(parametersFragRFc, measurevar="ctmin",
                     groupvars=c("rate.type"))

SSt
```

ctmax

```{r}
# R CTmax
parametersFragR
#M6T1R M5T1R K2TCR::: check parametersFrag for INF and remove M501c M601b, K20Cb, K20Cc
# Inf  remove

parametersFragGRCTmax<-parametersFragR[-c(7, 10, 37, 38),]


SSt = summarySE(parametersFragGRCTmax, measurevar="ctmax",
                     groupvars=c("genotype", "treatment", "rate.type"))

SSt

SSt = summarySE(parametersFragGRCTmax, measurevar="ctmax",
                     groupvars=c("genotype", "rate.type"))

SSt
SSt = summarySE(parametersFragGRCTmax, measurevar="ctmax",
                     groupvars=c("treatment", "rate.type"))

SSt
SSt = summarySE(parametersFragGRCTmax, measurevar="ctmax",
                     groupvars=c("rate.type"))

SSt

# GP CTmax
parametersFragGPCTmax<-parametersFrag%>%
  filter(rate.type=="GP")

#M6T1R M5T1R K2TCR::: check parametersFrag for INF and remove M501c M601b, K20Cb, K20Cc
# Inf  remove

SSt = summarySE(parametersFragGPCTmax, measurevar="ctmax",
                     groupvars=c("genotype", "treatment", "rate.type"))

SSt

SSt = summarySE(parametersFragGPCTmax, measurevar="ctmax",
                     groupvars=c("genotype", "rate.type"))

SSt
SSt = summarySE(parametersFragGPCTmax, measurevar="ctmax",
                     groupvars=c("treatment", "rate.type"))

SSt
SSt = summarySE(parametersFragGPCTmax, measurevar="ctmax",
                     groupvars=c("rate.type"))

SSt
```

e

```{r}
#GP E
View(parametersFrag)
#	T2	GP  M502b	M5
#	T2	GP	M602c	M6
#	T3	GP	M503a	M5
#	TC	GP	M60Cb	M6
parametersFragGP<-parametersFrag%>%
  filter(rate.type=="GP")

parametersFragGPE<-parametersFragGP[-c(18,23,29,45),]


SSt = summarySE(parametersFragGPE, measurevar="e",
                     groupvars=c("genotype", "treatment", "rate.type"))

SSt

SSt = summarySE(parametersFragGPE, measurevar="e",
                     groupvars=c("genotype", "rate.type"))

SSt
SSt = summarySE(parametersFragGPE, measurevar="e",
                     groupvars=c("treatment", "rate.type"))

SSt
SSt = summarySE(parametersFragGPE, measurevar="e",
                     groupvars=c("rate.type"))

SSt


# R E
#	T1	R	  M501c	M5
#	T1	R  	M601b	M6
#	TC	R  	M60Ca
parametersFragGRE<-parametersFragR[-c(7,10,43),]

SSt = summarySE(parametersFragGRE, measurevar="e",
                     groupvars=c("genotype", "treatment", "rate.type"))

SSt

SSt = summarySE(parametersFragGRE, measurevar="e",
                     groupvars=c("genotype", "rate.type"))

SSt
SSt = summarySE(parametersFragGRE, measurevar="e",
                     groupvars=c("treatment", "rate.type"))

SSt
SSt = summarySE(parametersFragGRE, measurevar="e",
                     groupvars=c("rate.type"))

SSt
```

eh

```{r}
#GP Eh
View(parametersFragGP)
#T1	GP	K201a	K2
#T2	GP	K202a	K2
#T3	GP	K203c	K2

parametersFragGPEh<-parametersFragGP[-c(1,13,27),]


SSt = summarySE(parametersFragGPEh, measurevar="eh",
                     groupvars=c("genotype", "treatment", "rate.type"))

SSt

SSt = summarySE(parametersFragGPEh, measurevar="eh",
                     groupvars=c("genotype", "rate.type"))

SSt
SSt = summarySE(parametersFragGPEh, measurevar="eh",
                     groupvars=c("treatment", "rate.type"))

SSt
SSt = summarySE(parametersFragGPEh, measurevar="eh",
                     groupvars=c("rate.type"))

SSt

#R Eh
#T1	R	K201a	K2
#T1	R	K201b	K2
#TC	R	K20Cb	K2
#TC	R	M60Cb M6

parametersFragGREh<-parametersFragR[-c(1,2,44,37),]


SSt = summarySE(parametersFragGREh, measurevar="eh",
                     groupvars=c("genotype", "treatment", "rate.type"))

SSt

SSt = summarySE(parametersFragGREh, measurevar="eh",
                     groupvars=c("genotype", "rate.type"))

SSt
SSt = summarySE(parametersFragGREh, measurevar="eh",
                     groupvars=c("treatment", "rate.type"))

SSt
SSt = summarySE(parametersFragGREh, measurevar="eh",
                     groupvars=c("rate.type"))

SSt

```


q10

```{r}
#GP q10

#T2	GP	M502b	
#T2	GP	M602a	
#T2	GP	M602c	
#T3	GP	M503a	
#T3	GP	M503d	
#TC	GP	M60Cb	
#TC	GP	M60Cd	
parametersFragGPq10<-parametersFragGP[-c(18,21,23,29,32,45,47),]

SSt = summarySE(parametersFragGPq10, measurevar="q10",
                     groupvars=c("genotype", "treatment", "rate.type"))

SSt

SSt = summarySE(parametersFragGPq10, measurevar="q10",
                     groupvars=c("genotype", "rate.type"))

SSt
SSt = summarySE(parametersFragGPq10, measurevar="q10",
                     groupvars=c("treatment", "rate.type"))

SSt
SSt = summarySE(parametersFragGPq10, measurevar="q10",
                     groupvars=c("rate.type"))

SSt

#R q10
#T1	R	M501c	
#T1	R	M601b
	
parametersFragGRq10<-parametersFragR[-c(7,10),]

SSt = summarySE(parametersFragGRq10, measurevar="q10",
                     groupvars=c("genotype", "treatment", "rate.type"))

SSt

SSt = summarySE(parametersFragGRq10, measurevar="q10",
                     groupvars=c("genotype", "rate.type"))

SSt
SSt = summarySE(parametersFragGRq10, measurevar="q10",
                     groupvars=c("treatment", "rate.type"))

SSt
SSt = summarySE(parametersFragGRq10, measurevar="q10",
                     groupvars=c("rate.type"))

SSt
```

thermal_safety_margin

```{r}

#GP TSM
parametersFragGPTSM<-parametersFragGP

SSt = summarySE(parametersFragGPTSM, measurevar="thermal_safety_margin",
                     groupvars=c("genotype", "treatment", "rate.type"))

SSt

SSt = summarySE(parametersFragGPTSM, measurevar="thermal_safety_margin",
                     groupvars=c("genotype", "rate.type"))

SSt
SSt = summarySE(parametersFragGPTSM, measurevar="thermal_safety_margin",
                     groupvars=c("treatment", "rate.type"))

SSt
SSt = summarySE(parametersFragGPTSM, measurevar="thermal_safety_margin",
                     groupvars=c("rate.type"))

SSt
#R TSM
#TC	R	K20Cc	K2
#TC	R	K20Cb	K2
#T1	R	M501c	M5
#T1	R	M601b

parametersFragGRTSM<-parametersFragR[-c(7, 10, 37, 38),]

SSt = summarySE(parametersFragGRTSM, measurevar="thermal_safety_margin",
                     groupvars=c("genotype", "treatment", "rate.type"))

SSt

SSt = summarySE(parametersFragGRTSM, measurevar="thermal_safety_margin",
                     groupvars=c("genotype", "rate.type"))

SSt
SSt = summarySE(parametersFragGRTSM, measurevar="thermal_safety_margin",
                     groupvars=c("treatment", "rate.type"))

SSt
SSt = summarySE(parametersFragGRTSM, measurevar="thermal_safety_margin",
                     groupvars=c("rate.type"))

SSt
```

breadth

```{r}
#GP breadth
parametersFragGPbrea<-parametersFragGP

SSt = summarySE(parametersFragGPbrea, measurevar="breadth",
                     groupvars=c("genotype", "treatment", "rate.type"))

SSt

SSt = summarySE(parametersFragGPbrea, measurevar="breadth",
                     groupvars=c("genotype", "rate.type"))

SSt
SSt = summarySE(parametersFragGPbrea, measurevar="breadth",
                     groupvars=c("treatment", "rate.type"))

SSt
SSt = summarySE(parametersFragGPbrea, measurevar="breadth",
                     groupvars=c("rate.type"))

SSt
#R breadth

parametersFragGRbrea<-parametersFragR

SSt = summarySE(parametersFragGRbrea, measurevar="breadth",
                     groupvars=c("genotype", "treatment", "rate.type"))

SSt

SSt = summarySE(parametersFragGRbrea, measurevar="breadth",
                     groupvars=c("genotype", "rate.type"))

SSt
SSt = summarySE(parametersFragGRbrea, measurevar="breadth",
                     groupvars=c("treatment", "rate.type"))

SSt
SSt = summarySE(parametersFragGRbrea, measurevar="breadth",
                     groupvars=c("rate.type"))

SSt
```

Parameter comparisons-rmax- R

```{r}
##Checking non logged transformed portein data
ggdensity(parametersFragGRrmax$rmax, 
          main = "Density plot of Rmaxs",
          xlab = "Rmaxs")
#SKEWED
ggqqplot(parametersFragGRrmax$rmax)
shapiro.test(parametersFragGRrmax$rmax)
#0.883
## data exhibit homoscedasticity, or constant (conditional) variance
bartlett.test(rmax~interaction(treatment,genotype), data=parametersFragGRrmax)
#0.09079
bartlett.test(rmax~treatment, data=parametersFragGRrmax)
#0.0338
bartlett.test(rmax~genotype, data=parametersFragGRrmax)
leveneTest(rmax~treatment, data=parametersFragGRrmax)
#0.01846
leveneTest(rmax~genotype, data=parametersFragGRrmax)
leveneTest(rmax ~ treatment*genotype, data = parametersFragGRrmax)
fligner.test(rmax~treatment, data=parametersFragGRrmax)
#0.02056
fligner.test(rmax~genotype, data=parametersFragGRrmax)
#Normal data- Variance heterogenity 
#Log parameter
parametersFragGRrmax$logrmax<-log(parametersFragGRrmax$rmax+1)

##Checking non logged transformed portein data
ggdensity(parametersFragGRrmax$logrmax, 
          main = "Density plot of Rmaxs",
          xlab = "Rmaxs")
#SKEWED
ggqqplot(parametersFragGRrmax$logrmax)
shapiro.test(parametersFragGRrmax$logrmax)
#0.8319
bartlett.test(logrmax~interaction(treatment,genotype), data=parametersFragGRrmax)
bartlett.test(logrmax~treatment, data=parametersFragGRrmax)
#0.03021
bartlett.test(logrmax~genotype, data=parametersFragGRrmax)
leveneTest(logrmax~treatment, data=parametersFragGRrmax)
#0.01749
leveneTest(logrmax~genotype, data=parametersFragGRrmax)
leveneTest(logrmax ~ treatment*genotype, data = parametersFragGRrmax)
fligner.test(logrmax~treatment, data=parametersFragGRrmax)
#0.01772
fligner.test(logrmax~genotype, data=parametersFragGRrmax)
#logit
parametersFragGRrmax$logitrmax<-car::logit(parametersFragGRrmax$rmax)

###Checking non logged transformed portein data
ggdensity(parametersFragGRrmax$logitrmax,na.rm = TRUE, 
          main = "Density plot of Rmaxs",
          xlab = "Rmaxs")
#SKEWED
ggqqplot(parametersFragGRrmax$logitrmax,na.rm = TRUE)
shapiro.test(parametersFragGRrmax$logitrmax)
bartlett.test(logitrmax~interaction(treatment,genotype), data=parametersFragGRrmax)
bartlett.test(logitrmax~treatment,data=parametersFragGRrmax)
#0.02836
bartlett.test(logitrmax~genotype,data=parametersFragGRrmax)
leveneTest(logitrmax~treatment, data=parametersFragGRrmax)
#0.01771
leveneTest(logitrmax~genotype, data=parametersFragGRrmax)
leveneTest(logitrmax ~ treatment*genotype, data = parametersFragGRrmax)
fligner.test(logitrmax~treatment, data=parametersFragGRrmax)
fligner.test(logitrmax~genotype, data=parametersFragGRrmax)
# While the data has equal variance, the distribution is not normal (failed Shapiro test)
#Kruskal Wallis kruskal.test: Nonparametric test of medians
```

Nonparametric test rmax R
SD in genotype m5 m6 and interaction TC M5	TC M6

```{r}
parametersFragGRrmax %>% 
  group_by(genotype,treatment) %>%
  get_summary_stats(rmax, type = "common")


res.kruskal <- parametersFragGRrmax %>% kruskal_test(rmax ~ treatment)
res.kruskal
#stat 2.97 df 3 pvalue= 0.396
res.kruskal2 <- parametersFragGRrmax %>% kruskal_test(rmax ~ genotype)
res.kruskal2
# stat 9.63  df 2 p-value 0.00812**
#EFFECT SIZE
parametersFragGRrmax %>% kruskal_effsize(rmax ~ treatment)
# -0.000700-- small
parametersFragGRrmax %>% kruskal_effsize(rmax ~ genotype)
# 0.173 -- LARGE
# Pairwise comparisons
pwcCP <- parametersFragGRrmax %>% 
  dunn_test(rmax ~ treatment, p.adjust.method = "bonferroni") 
pwcCP
#NA no differences between treatments
pwcCPg <- parametersFragGRrmax %>% 
  dunn_test(rmax ~ genotype, p.adjust.method = "bonferroni") 
pwcCPg
#M5-M6:stat -3.097465 p-value= 0.005855498**
dunn.test(parametersFragGRrmax$rmax, parametersFragGRrmax$genotype, method="bh")
#chi-squared = 9.6267, df = 2, p-value = 0.01
pwcCP <- pwcCP %>% add_xy_position(x = "treatment")
pwcCPg <- pwcCPg %>% add_xy_position(x = "genotype")

mod<-lm(rmax~treatment*genotype,parametersFragGRrmax)

effects::allEffects(mod)
summary(mod)
#F 2.314 df 34 p-value- 0.03011
parametersFragGRrmax$cat <- paste(parametersFragGRrmax$treatment,parametersFragGRrmax$genotype)

res.kruskalD <- parametersFragGRrmax %>% kruskal_test(rmax ~ cat)
res.kruskalD
# stat 20.1 df 11 p-value 0.0442*
#EFFECT SIZE
parametersFragGRrmax %>% kruskal_effsize(rmax ~ cat)
#0.260 -LARGE
dunn.test(parametersFragGRrmax$rmax, parametersFragGRrmax$cat, method="bh")
#chi-squared = 20.0863, df = 11, p-value = 0.04
pwcD <- parametersFragGRrmax %>% 
  dunn_test(rmax ~ cat, p.adjust.method = "bonferroni") 
pwcD
#	TC M5	TC M6	-3.649803440 p-value	0.01732111
pwcD <- pwcD %>% add_xy_position(x = "cat")

treaRmaxRP<-ggboxplot(parametersFragGRrmax, x = "treatment", y = "rmax", color= "black", fill="treatment", outlier.shape = 1) +
  stat_boxplot(geom='errorbar', linetype=1, width=0.5)+  #whiskers
  ylab(expression(paste(O[2], mu,"mol cm"^{-2}, "hr"^{-1})))+
  xlab('Treatment')+
  ggtitle('Rmax')+
  scale_fill_manual(values = c('#66CCFF','#FFFF00', '#FF00CC', '#66FF33'))+
  stat_summary(fun.y=mean, geom="point", size=2)+ #line is median, and closed circle is mean
  scale_x_discrete(breaks=c("T1", "T2", "T3", "TC"),
        labels=c("Sprinkler", "Feeding", "Interactive","Control"))+
   stat_pvalue_manual(pwcCP, hide.ns = TRUE) +
  labs(
    subtitle = get_test_label(res.kruskal, detailed = TRUE),
    caption = get_pwc_label(pwcCP)
    )
treaRmaxRP
ggexport(treaRmaxRP, filename = "RmaxKWplottrea.pdf")

genRmaxRP<-ggboxplot(parametersFragGRrmax, x = "genotype", y = "rmax", color= "black", fill="genotype", outlier.shape = 1) +
  stat_boxplot(geom='errorbar', linetype=1, width=0.5)+  #whiskers
  ylab(expression(paste(O[2], mu,"mol cm"^{-2}, "hr"^{-1})))+
  xlab('Genotype')+
  ggtitle('Rmax')+
  scale_fill_manual(values = c('red','green4', 'blue'))+
  stat_summary(fun.y=mean, geom="point", size=2)+ #line is median, and closed circle is mean
   stat_pvalue_manual(pwcCPg, hide.ns = TRUE) +
  labs(
    subtitle = get_test_label(res.kruskal2, detailed = TRUE),
    caption = get_pwc_label(pwcCPg)
    )
genRmaxRP
ggexport(genRmaxRP, filename = "RmaxKWplotgeno.pdf")

genRmaxI<-ggboxplot(parametersFragGRrmax, x = "cat", y = "rmax", color= "black", fill="genotype", outlier.shape = 1) +
  stat_boxplot(geom='errorbar', linetype=1, width=0.5)+  #whiskers
  ylab(expression(paste(O[2], mu,"mol cm"^{-2}, "hr"^{-1})))+
  xlab('')+
  ggtitle('Rmax')+
  scale_fill_manual(values = c('red','green4', 'blue'))+
  stat_summary(fun.y=mean, geom="point", size=2)+ #line is median, and closed circle is mean
   stat_pvalue_manual(pwcD, hide.ns = TRUE, y.position = 0.55) +
  labs(
    subtitle = get_test_label(res.kruskalD, detailed = TRUE),
    caption = get_pwc_label(pwcD)
    )+
  ylim(0.3,0.55)
genRmaxI
ggexport(genRmaxI, filename = "RmaxKWplotinter.pdf")

ggboxplot(parametersFragGRrmax, x = "treatment", y = "rmax", color= "black", fill="genotype", outlier.shape = 1) +
  ylab('Rmax')+
  xlab('Treatment')+
  scale_fill_manual(values = c('red','green4', 'blue'))+
  stat_summary(fun.y=mean, geom="point", size=2)+
  scale_x_discrete(breaks=c("T1", "T2", "T3", "TC"),
        labels=c("Sprinkler", "Feeding", "Interactive","Control"))

ggboxplot(parametersFragGRrmax, x = "genotype", y = "rmax", color= "black", fill="treatment", outlier.shape = 1) +
  ylab('Rmax')+
  xlab('Genotype')+
  scale_fill_manual(values = c('#66CCFF','#FFFF00', '#FF00CC', '#66FF33'))

```

Parameter comparisons-Pmax GP

```{r}
##Checking non logged transformed portein data
ggdensity(parametersFragGPPmax$rmax, 
          main = "Density plot of Pmaxs",
          xlab = "Pmaxs")
#SKEWED
ggqqplot(parametersFragGPPmax$rmax)
shapiro.test(parametersFragGPPmax$rmax)
#0.07743
bartlett.test(rmax~interaction(treatment,genotype), data=parametersFragGPPmax)
bartlett.test(rmax~treatment, data=parametersFragGPPmax)
bartlett.test(rmax~genotype, data=parametersFragGPPmax)
leveneTest(rmax~treatment, data=parametersFragGPPmax)
leveneTest(rmax~genotype, data=parametersFragGPPmax)
leveneTest(rmax ~ treatment*genotype, data = parametersFragGPPmax)
fligner.test(rmax~treatment, data=parametersFragGPPmax)
fligner.test(rmax~genotype, data=parametersFragGPPmax)
#Normal data- Variance homogenous 
# DATA IS NORMAL- anova- tukeys etc 
```

Parametric test Pmax GP- passed shapiro/Bartlett/Levene/Flinger
SD treat 1&3
interaction

```{r}

parametersFragGPPmax %>% 
  group_by(genotype,treatment) %>%
  get_summary_stats(rmax, type = "common")

# Proceed with ANOVA/lm post hoc Tukeys HSD
Pmaxmod<-aov(rmax~genotype*treatment,parametersFragGPPmax)
summary(Pmaxmod)
#treatment diff F 1.699 df 3 p= 0.0151*
#treat*geno diff  F 2.694 df 6 p=0.0295*
#Post hoc Pairwise
pairwise.t.test(parametersFragGPPmax$rmax, parametersFragGPPmax$treatment,
                p.adjust.method = "BH")
#1 & 3 0.048*
#1 & 2 0.048*
pairwise.t.test(parametersFragGPPmax$rmax, parametersFragGPPmax$genotype,
                p.adjust.method = "BH")
#NS
parametersFragGPPmax$cat <- paste(parametersFragGPPmax$treatment,parametersFragGPPmax$genotype)

pairwise.t.test(parametersFragGPPmax$rmax, parametersFragGPPmax$cat,
                p.adjust.method = "BH")
#NS
TukeyHSD(Pmaxmod)
#NS

PmaxtSSt = summarySE(parametersFragGPPmax, measurevar="rmax",
                     groupvars=c("treatment"))

PmaxtSSt
PmaxgSSt = summarySE(parametersFragGPPmax, measurevar="rmax",
                     groupvars=c("genotype"))

PmaxgSSt
PmaxiSSt = summarySE(parametersFragGPPmax, measurevar="rmax",
                     groupvars=c("cat"))

PmaxiSSt
 
Pmaxtbar<-ggplot(PmaxtSSt, aes(x=factor(treatment), y=rmax, fill=treatment)) + 
    geom_bar(stat="identity", width=0.8) +
    geom_errorbar(aes(ymin=rmax-se, ymax=rmax+se),
                  width=.2) +
    xlab("Treatment") +
  ylab(expression(paste("log", O[2], mu,"mol cm"^{-2}, "hr"^{-1})))+
  ggtitle('Pmax GP')+
   theme_classic()+
    scale_x_discrete(breaks=c("T1", "T2", "T3", "TC"),
        labels=c("Sprinkler", "Feeding", "Interactive","Control"))+
  scale_fill_manual(values = c('#66CCFF','#FFFF00', '#FF00CC', '#66FF33'))
 Pmaxtbar
  
PmaxImod<-lm(rmax~genotype*treatment,parametersFragGPPmax)
summary(PmaxImod)
#treat2 F- 2.87, DF- 35 p-value 0.008684**
Pmaxtmod<-aov(rmax~treatment,parametersFragGPPmax)
summary(Pmaxtmod)
# treat df 3 F 3.146 P= 0.0347**
TukeyHSD(Pmaxtmod)
#T3-T1 diff  -0.071990473  p=0.0387581*
Pmaxgmod<-aov(rmax~genotype,parametersFragGPPmax)
summary(Pmaxgmod)
TukeyHSD(Pmaxgmod)
# NSD

PmaxImodP<-ggplot(PmaxImod, aes(x=treatment, rmax, fill= genotype))+
  stat_boxplot(geom= "errorbar", width= 0.5, position = position_dodge(1))+
  geom_boxplot(position = position_dodge(1),outlier.shape=1)+
  theme_classic()+
  xlab('Treatment')+
  ylab(expression(paste(O[2], mu,"mol cm"^{-2}, "hr"^{-1})))+
  ggtitle("Pmax GP")+
  stat_compare_means(label.y=.9, method = "anova")+
  scale_fill_manual(values = c('red','green4', 'blue'))+
  scale_x_discrete(breaks=c("T1", "T2", "T3", "TC"),
        labels=c("Sprinkler", "Feeding", "Interactive","Control"))
PmaxImodP

ggexport(PmaxImodP, filename = "PmaxANOplotinter.pdf")


PmaxgmodP<-ggplot(Pmaxgmod, aes(x=genotype, rmax, fill= genotype))+
  stat_boxplot(geom= "errorbar", width= 0.5, position = position_dodge(1))+
  geom_boxplot(position = position_dodge(1),outlier.shape=1)+
  theme_classic()+
  xlab('Genotype')+
  ylab(expression(paste(O[2], mu,"mol cm"^{-2}, "hr"^{-1})))+
  ggtitle("Pmax GP")+
    stat_summary(fun.y=mean, geom="point", size=2)+ #line is median, and closed circle is mean
  stat_compare_means(label.y=.9, method = "anova")+
  scale_fill_manual(values = c('red','green4', 'blue'))
PmaxgmodP
ggexport(PmaxgmodP, filename = "PmaxANOplotgeno.pdf")

PmaxtmodP<-ggplot(Pmaxtmod, aes(x=treatment, rmax, fill= treatment))+
  stat_boxplot(geom= "errorbar", width= 0.5, position = position_dodge(1))+
  geom_boxplot(position = position_dodge(1),outlier.shape=1)+
  theme_classic()+
  xlab('Treatment')+
  ylab(expression(paste(O[2], mu,"mol cm"^{-2}, "hr"^{-1})))+
  ggtitle("Pmax GP")+
      stat_summary(fun.y=mean, geom="point", size=2)+ #line is median, and closed circle is mean
  stat_compare_means(label.y=.9, method = "anova")+
  scale_fill_manual(values = c('#66CCFF','#FFFF00', '#FF00CC', '#66FF33'))+
  scale_x_discrete(breaks=c("T1", "T2", "T3", "TC"),
        labels=c("Sprinkler", "Feeding", "Interactive","Control"))

PmaxtmodP
ggexport(PmaxtmodP, filename = "PmaxANOplottrea.pdf")

stat.testi<-aov(rmax~treatment,parametersFragGPPmax)%>%
  tukey_hsd()

PmaxgmodPTu<-ggboxplot(parametersFragGPPmax, x = "treatment", y = "rmax")+
  stat_pvalue_manual(
    stat.testi, label = "p.adj", 
    y.position = c(.9,1,1.1)
      )
PmaxgmodPTu
ggexport(PmaxgmodPTu, filename = "PmaxANOplottreaTUK.pdf")
```

Parameter comparisons-Topt- GP

```{r}
##Checking non logged transformed portein data
ggdensity(parametersFragGPTopt$topt, 
          main = "Density plot of Topts",
          xlab = "Topts")
#SKEWED
ggqqplot(parametersFragGPTopt$topt)
shapiro.test(parametersFragGPTopt$topt)
#2.699e-7
bartlett.test(topt~interaction(treatment,genotype), data=parametersFragGPTopt)
bartlett.test(topt~treatment, data=parametersFragGPTopt)
bartlett.test(topt~genotype, data=parametersFragGPTopt)
#0.01121
leveneTest(topt~treatment, data=parametersFragGPTopt)
leveneTest(topt~genotype, data=parametersFragGPTopt)
leveneTest(topt ~ treatment*genotype, data = parametersFragGPTopt)
fligner.test(topt~treatment, data=parametersFragGPTopt)
fligner.test(topt~genotype, data=parametersFragGPTopt)

#Log parameter
parametersFragGPTopt$logtopt<-log(parametersFragGPTopt$topt+1)

##Checking non logged transformed portein data
ggdensity(parametersFragGPTopt$logtopt, 
          main = "Density plot of Topts",
          xlab = "Topts")
#SKEWED
ggqqplot(parametersFragGPTopt$logtopt)
shapiro.test(parametersFragGPTopt$logtopt)
#1.195e-7
bartlett.test(logtopt~interaction(treatment,genotype), data=parametersFragGPTopt)
bartlett.test(logtopt~treatment, data=parametersFragGPTopt)
bartlett.test(logtopt~genotype, data=parametersFragGPTopt)
#0.006611
leveneTest(logtopt~treatment, data=parametersFragGPTopt)
leveneTest(logtopt~genotype, data=parametersFragGPTopt)
leveneTest(logtopt ~ treatment*genotype, data = parametersFragGPTopt)
fligner.test(logtopt~treatment, data=parametersFragGPTopt)
fligner.test(logtopt~genotype, data=parametersFragGPTopt)
#logit
parametersFragGPTopt$logittopt<-car::logit(parametersFragGPTopt$topt)

###Checking non logged transformed portein data
ggdensity(parametersFragGPTopt$logittopt,na.rm = TRUE, 
          main = "Density plot of Topts",
          xlab = "Topts")
#SKEWED
ggqqplot(parametersFragGPTopt$logittopt,na.rm = TRUE)
shapiro.test(parametersFragGPTopt$logittopt)
#1.661e-7
bartlett.test(logittopt~interaction(treatment,genotype), data=parametersFragGPTopt)
bartlett.test(logittopt~treatment,data=parametersFragGPTopt)
bartlett.test(logittopt~genotype,data=parametersFragGPTopt)
#0.008222
leveneTest(logittopt~treatment, data=parametersFragGPTopt)
leveneTest(logittopt~genotype, data=parametersFragGPTopt)
leveneTest(logittopt ~ treatment*genotype, data = parametersFragGPTopt)
fligner.test(logittopt~treatment, data=parametersFragGPTopt)
fligner.test(logittopt~genotype, data=parametersFragGPTopt)
# While the data has equal variance, the distribution is not normal (failed Shapiro test)

#Kruskal Wallis kruskal.test: Nonparametric test of medians

```

Nonparametric test Topt GP
No diff in Topt GP

```{r}
library(rstatix)
parametersFragGPTopt %>% 
  group_by(genotype,treatment) %>%
  get_summary_stats(topt, type = "common")

#Question: We want to know if there is any significant difference between the average Topts in GP of corals in the 4 experimental conditions.

res.kruskal <- parametersFragGPTopt %>% kruskal_test(topt ~ treatment)
res.kruskal
# pvalue= 0.681
res.kruskal2 <- parametersFragGPTopt %>% kruskal_test(topt ~ genotype)
res.kruskal2
#0.656
#EFFECT SIZE
#The eta squared, based on the H-statistic, can be used as the measure of the Kruskal-Wallis test effect size. It is calculated as follow : eta2[H] = (H - k + 1)/(n - k); where H is the value obtained in the Kruskal-Wallis test; k is the number of groups; n is the total number of observations (M. T. Tomczak and Tomczak 2014).

#The eta-squared estimate assumes values from 0 to 1 #and multiplied by 100 indicates the percentage of #variance in the dependent variable explained by the #independent variable.
#
#The interpretation values commonly in published #literature are: 0.01- < 0.06 (small effect), 0.06 - #0.14 (moderate effect) and >= 0.14 (large effect).
parametersFragGPTopt %>% kruskal_effsize(topt ~ treatment)
# -0.0347-- small
parametersFragGPTopt %>% kruskal_effsize(topt ~ genotype)
# -0.0263 -- small
# Pairwise comparisons
pwcCP <- parametersFragGPTopt %>% 
  dunn_test(topt ~ treatment, p.adjust.method = "bonferroni") 
pwcCP
#NA no differences between treatments
pwcCPg <- parametersFragGPTopt %>% 
  dunn_test(topt ~ genotype, p.adjust.method = "bonferroni") 
pwcCPg
#NA no differences between treatmentspwcCP <- pwcCP %>% add_xy_position(x = "treatment")
pwcCP <- pwcCP %>% add_xy_position(x = "treatment")
pwcCPg <- pwcCPg %>% add_xy_position(x = "genotype")

mod<-lm(topt~treatment*genotype,parametersFragGPTopt)

effects::allEffects(mod)
summary(mod)
# F 0.5657 DF 35 P-value 0.843
parametersFragGPTopt$cat <- paste(parametersFragGPTopt$treatment,parametersFragGPTopt$genotype)

res.kruskalD <- parametersFragGPTopt %>% kruskal_test(topt ~ cat)
res.kruskalD
#n=47 df 11 p-value KW 0.9966
#EFFECT SIZE
parametersFragGPTopt %>% kruskal_effsize(topt ~ cat)
# -0.197 -LARGE
dunn.test(parametersFragGPTopt$topt, parametersFragGPTopt$cat, method="bh")
#Chi^2= 4.121 df= 11 p-value= 0.97
pwcD <- parametersFragGPTopt %>% 
  dunn_test(topt ~ cat, p.adjust.method = "bonferroni") 
pwcD
pwcD <- pwcD %>% add_xy_position(x = "cat")

treaToptGP<-ggboxplot(parametersFragGPTopt, x = "treatment", y = "topt", color= "black", fill="treatment", outlier.shape = 1) +
  stat_boxplot(geom='errorbar', linetype=1, width=0.5)+  #whiskers
  ylab('Temperature (ºC)')+
  xlab('Treatments')+
  ggtitle('Topt GP')+
  scale_fill_manual(values = c('#66CCFF','#FFFF00', '#FF00CC', '#66FF33'))+
  stat_summary(fun.y=mean, geom="point", size=2)+ #line is median, and closed circle is mean
  scale_x_discrete(breaks=c("T1", "T2", "T3", "TC"),
        labels=c("Sprinkler", "Feeding", "Interactive","Control"))+
   stat_pvalue_manual(pwcCP, hide.ns = TRUE)+
  labs(
    subtitle = get_test_label(res.kruskal, detailed = TRUE),
    caption = get_pwc_label(pwcCP)
    )
treaToptGP
ggexport(treaToptGP, filename = "ToptGPKWplottreat.pdf")

genToptGP<-ggboxplot(parametersFragGPTopt, x = "genotype", y = "topt", color= "black", fill="genotype", outlier.shape = 1) +
  stat_boxplot(geom='errorbar', linetype=1, width=0.5)+  #whiskers
  ylab('Temperature (ºC)')+
  xlab('Genotypes')+
  ggtitle('Topt GP')+
  scale_fill_manual(values = c('red','green4', 'blue'))+
  stat_summary(fun.y=mean, geom="point", size=2)+ #line is median, and closed circle is mean
   stat_pvalue_manual(pwcCPg, hide.ns = TRUE) +
  labs(
    subtitle = get_test_label(res.kruskal2, detailed = TRUE),
    caption = get_pwc_label(pwcCPg)
    )
genToptGP
ggexport(genToptGP, filename = "ToptGPKWplotgeno.pdf")

genToptGPI<-ggboxplot(parametersFragGPTopt, x = "cat", y = "topt", color= "black", fill="genotype", outlier.shape = 1) +
  stat_boxplot(geom='errorbar', linetype=1, width=0.5)+  #whiskers
  ylab('Temperature (ºC)')+
  xlab('')+
  ggtitle('Topt GP')+
  scale_fill_manual(values = c('red','green4', 'blue'))+
  stat_summary(fun.y=mean, geom="point", size=2)+ #line is median, and closed circle is mean
   stat_pvalue_manual(pwcD, hide.ns = TRUE) +
  labs(
    subtitle = get_test_label(res.kruskalD, detailed = TRUE),
    caption = get_pwc_label(pwcD)
    )
genToptGPI
ggexport(genToptGPI, filename = "ToptGPKWplotinter.pdf")

ggboxplot(parametersFragGPTopt, x = "treatment", y = "topt", color= "black", fill="genotype", outlier.shape = 1) +
  ylab('Topt GP')+
  xlab('Treatments')+
  scale_fill_manual(values = c('red','green4', 'blue'))+
  stat_summary(fun.y=mean, geom="point", size=2)+
  scale_x_discrete(breaks=c("T1", "T2", "T3", "TC"),
        labels=c("Sprinkler", "Feeding", "Interactive","Control"))

ggboxplot(parametersFragGPTopt, x = "genotype", y = "topt", color= "black", fill="treatment", outlier.shape = 1) +
  ylab('Topt GP')+
  xlab('Genotypes')+
  scale_fill_manual(values = c('#66CCFF','#FFFF00', '#FF00CC', '#66FF33'))
```

Parameter comparisons-Topt- R

```{r}
##Checking non logged transformed portein data
ggdensity(parametersFragGRTopt$topt, 
          main = "Density plot of Topts",
          xlab = "Topts")
#SKEWED
ggqqplot(parametersFragGRTopt$topt)
shapiro.test(parametersFragGRTopt$topt)
#0.01425
bartlett.test(topt~interaction(treatment,genotype), data=parametersFragGRTopt)
#0.0365
bartlett.test(topt~treatment,data=parametersFragGRTopt)
bartlett.test(topt~genotype, data=parametersFragGRTopt)
leveneTest(topt~treatment, data=parametersFragGRTopt)
leveneTest(topt~genotype, data=parametersFragGRTopt)
leveneTest(topt ~ treatment*genotype, data = parametersFragGRTopt)
fligner.test(topt~treatment, data=parametersFragGRTopt)
fligner.test(topt~genotype, data=parametersFragGRTopt)

#Log parameter
parametersFragGRTopt$logtopt<-log(parametersFragGRTopt$topt+1)

##Checking non logged transformed portein data
ggdensity(parametersFragGRTopt$logtopt, 
          main = "Density plot of Topts",
          xlab = "Topts")
#SKEWED
ggqqplot(parametersFragGRTopt$logtopt)
shapiro.test(parametersFragGRTopt$logtopt)
#0.01923
bartlett.test(logtopt~interaction(treatment,genotype), data=parametersFragGRTopt)
# 0.03874
bartlett.test(logtopt~treatment, data=parametersFragGRTopt)
bartlett.test(logtopt~genotype, data=parametersFragGRTopt)
leveneTest(logtopt~treatment, data=parametersFragGRTopt)
leveneTest(logtopt~genotype, data=parametersFragGRTopt)
leveneTest(logtopt ~ treatment*genotype, data = parametersFragGRTopt)
fligner.test(logtopt~treatment, data=parametersFragGRTopt)
fligner.test(logtopt~genotype, data=parametersFragGRTopt)
#logit
parametersFragGRTopt$logittopt<-car::logit(parametersFragGRTopt$topt)

###Checking non logged transformed portein data
ggdensity(parametersFragGRTopt$logittopt,na.rm = TRUE, 
          main = "Density plot of Topts",
          xlab = "Topts")
#SKEWED
ggqqplot(parametersFragGRTopt$logittopt,na.rm = TRUE)
shapiro.test(parametersFragGRTopt$logittopt)
#0.01703
bartlett.test(logittopt~interaction(treatment,genotype), data=parametersFragGRTopt)
#0.0378
bartlett.test(logittopt~treatment,data=parametersFragGRTopt)
bartlett.test(logittopt~genotype,data=parametersFragGRTopt)
leveneTest(logittopt~treatment, data=parametersFragGRTopt)
leveneTest(logittopt~genotype, data=parametersFragGRTopt)
leveneTest(logittopt ~ treatment*genotype, data = parametersFragGRTopt)
fligner.test(logittopt~treatment, data=parametersFragGRTopt)
fligner.test(logittopt~genotype, data=parametersFragGRTopt)
# While the data has equal variance, the distribution is not normal (failed Shapiro test)
#Kruskal Wallis kruskal.test: Nonparametric test of medians
```

Nonparametric test Topt R
SD in genotype and interaction

```{r}
parametersFragGRTopt %>% 
  group_by(genotype,treatment) %>%
  get_summary_stats(topt, type = "common")

#box plot
ggboxplot(parametersFragGRTopt, x = "treatment", y = "topt")
ggboxplot(parametersFragGRTopt, x = "genotype", y = "topt")

res.kruskal <- parametersFragGRTopt %>% kruskal_test(topt ~ treatment)
res.kruskal
# 2.35 df 3 pvalue= 0.503
res.kruskal2 <- parametersFragGRTopt %>% kruskal_test(topt ~ genotype)
res.kruskal2
# 17.5 df 2 p-value 0.000156**
#EFFECT SIZE
parametersFragGRTopt %>% kruskal_effsize(topt ~ treatment)
# -0.0151-- small
parametersFragGRTopt %>% kruskal_effsize(topt ~ genotype)
# 0.353 -- LARGE
# Pairwise comparisons
pwcCP <- parametersFragGRTopt %>% 
  dunn_test(topt ~ treatment, p.adjust.method = "bonferroni") 
pwcCP
#NA no differences between treatments
pwcCPg <- parametersFragGRTopt %>% 
  dunn_test(topt ~ genotype, p.adjust.method = "bonferroni") 
pwcCPg
#K2-M5 0.001095255*
#K2	M6 0.001226808*
dunn.test(parametersFragGRTopt$topt, parametersFragGRTopt$genotype, method="bh")
#chi-squared = 17.5266, df = 2, p-value = 0
pwcCP <- pwcCP %>% add_xy_position(x = "treatment")
pwcCPg <- pwcCPg %>% add_xy_position(x = "genotype")


mod<-lm(topt~treatment*genotype,parametersFragGRTopt)

effects::allEffects(mod)
summary(mod)
#F 2.163 DF 34,  p-value: 0.04204
parametersFragGRTopt$cat <- paste(parametersFragGRTopt$treatment,parametersFragGRTopt$genotype)

res.kruskalD <- parametersFragGRTopt %>% kruskal_test(topt ~ cat)
res.kruskalD
#stat 24.3 df 11 p-value 0.0116*
#EFFECT SIZE
parametersFragGRTopt %>% kruskal_effsize(topt ~ cat)
#0.380 -LARGE
dunn.test(parametersFragGRTopt$topt, parametersFragGRTopt$cat, method="bh")
#chi-squared = 24.2826, df = 11, p-value = 0.01
pwcD <- parametersFragGRTopt %>% 
  dunn_test(topt ~ cat, p.adjust.method = "bonferroni") 
pwcD
#T1K2-T3M6 stat -3.37153564 p-value  0.0493 Dunn
pwcD <- pwcD %>% add_xy_position(x = "cat")
#
#

treaToptRP<-ggboxplot(parametersFragGRTopt, x = "treatment", y = "topt", color= "black", fill="treatment", outlier.shape = 1) +
  stat_boxplot(geom='errorbar', linetype=1, width=0.5)+  #whiskers
  ylab('Temperature (ºC)')+
  xlab('Treatment')+
  ggtitle('Topt R')+
  scale_fill_manual(values = c('#66CCFF','#FFFF00', '#FF00CC', '#66FF33'))+
  stat_summary(fun.y=mean, geom="point", size=2)+ #line is median, and closed circle is mean
  scale_x_discrete(breaks=c("T1", "T2", "T3", "TC"),
        labels=c("Sprinkler", "Feeding", "Interactive","Control"))+
   stat_pvalue_manual(pwcCP, hide.ns = TRUE) +
  labs(
    subtitle = get_test_label(res.kruskal, detailed = TRUE),
    caption = get_pwc_label(pwcCP)
    )
treaToptRP 
ggexport(treaToptRP, filename = "ToptRKWplottreat.pdf")

genToptRP<-ggboxplot(parametersFragGRTopt, x = "genotype", y = "topt", color= "black", fill="genotype", outlier.shape = 1) +
  stat_boxplot(geom='errorbar', linetype=1, width=0.5)+  #whiskers
  ylab('Temperature (ºC)')+
  xlab('Genotype')+
  ggtitle('Topt R')+
  scale_fill_manual(values = c('red','green4', 'blue'))+
  stat_summary(fun.y=mean, geom="point", size=2)+ #line is median, and closed circle is mean
   stat_pvalue_manual(pwcCPg, hide.ns = TRUE) +
  labs(
    subtitle = get_test_label(res.kruskal2, detailed = TRUE),
    caption = get_pwc_label(pwcCPg)
    )
genToptRP
ggexport(genToptRP, filename = "ToptRKWplotgeno.pdf")

genToptI<-ggboxplot(parametersFragGRTopt, x = "cat", y = "topt", color= "black", fill="genotype", outlier.shape = 1) +
  stat_boxplot(geom='errorbar', linetype=1, width=0.5)+  #whiskers
  ylab('Temperature (ºC)')+
  xlab('Genotype')+
  ggtitle('Topt R')+
  scale_fill_manual(values = c('red','green4', 'blue'))+
  stat_summary(fun.y=mean, geom="point", size=2)+ #line is median, and closed circle is mean
   stat_pvalue_manual(pwcD, hide.ns = TRUE, y.position = 34) +
  labs(
    subtitle = get_test_label(res.kruskalD, detailed = TRUE),
    caption = get_pwc_label(pwcD)
    )
genToptI
ggexport(genToptI, filename = "ToptRKWplotinter.pdf")

ggboxplot(parametersFragGRTopt, x = "treatment", y = "topt", color= "black", fill="genotype", outlier.shape = 1) +
  ylab('Topt')+
  xlab('Treatment')+
  scale_fill_manual(values = c('red','green4', 'blue'))+
  stat_summary(fun.y=mean, geom="point", size=2)+
  scale_x_discrete(breaks=c("T1", "T2", "T3", "TC"),
        labels=c("Sprinkler", "Feeding", "Interactive","Control"))

ggboxplot(parametersFragGRTopt, x = "genotype", y = "topt", color= "black", fill="treatment", outlier.shape = 1) +
  ylab('Topt')+
  xlab('Genotype')+
  scale_fill_manual(values = c('#66CCFF','#FFFF00', '#FF00CC', '#66FF33'))

```

Parameter comparisons-breadth GP

```{r}
##Checking non logged transformed portein data
ggdensity(parametersFragGPbrea$breadth, 
          main = "Density plot of Thermal Breadth",
          xlab = "Breadth")
#SKEWED
ggqqplot(parametersFragGPbrea$breadth)
shapiro.test(parametersFragGPbrea$breadth)
#0.0003744
#Non-normal data-  
#Log parameter
parametersFragGPbrea$logbreadth<-log(parametersFragGPbrea$breadth+1)

##Checking non logged transformed portein data
ggdensity(parametersFragGPbrea$logbreadth, 
          main = "Density plot of Thermal Breadth",
          xlab = "Thermal Breadth")
#SKEWED
ggqqplot(parametersFragGPbrea$logbreadth)
shapiro.test(parametersFragGPbrea$logbreadth)
#0001338
bartlett.test(logbreadth~treatment,data=parametersFragGPbrea)
bartlett.test(logbreadth~interaction(treatment,genotype), data=parametersFragGPbrea)
bartlett.test(logbreadth~genotype,data=parametersFragGPbrea)
leveneTest(logbreadth~treatment, data=parametersFragGPbrea)
leveneTest(logbreadth~genotype, data=parametersFragGPbrea)
leveneTest(logbreadth ~ treatment*genotype, data = parametersFragGPbrea)
fligner.test(logbreadth~treatment, data=parametersFragGPbrea)
fligner.test(logbreadth~genotype, data=parametersFragGPbrea)
#not normal variance homogeneous
#logit
parametersFragGPbrea$logitbreadth<-car::logit(parametersFragGPbrea$breadth)

###Checking non logged transformed portein data
ggdensity(parametersFragGPbrea$logitbreadth,na.rm = TRUE, 
          main = "Density plot of Thermal Breadth",
          xlab = "Thermal Breadth")
#SKEWED
ggqqplot(parametersFragGPbrea$logitbreadth,na.rm = TRUE)
shapiro.test(parametersFragGPbrea$logitbreadth)
#0.0001202
bartlett.test(logitbreadth~interaction(treatment,genotype), data=parametersFragGPbrea)
bartlett.test(logitbreadth~treatment,data=parametersFragGPbrea)
bartlett.test(logitbreadth~genotype,data=parametersFragGPbrea)
leveneTest(logitbreadth~treatment, data=parametersFragGPbrea)
leveneTest(logitbreadth~genotype, data=parametersFragGPbrea)
leveneTest(logitbreadth ~ treatment*genotype, data = parametersFragGPbrea)
fligner.test(logitbreadth~treatment, data=parametersFragGPbrea)
fligner.test(logitbreadth~genotype, data=parametersFragGPbrea)
# While the data has equal variance, the distribution is not normal (failed Shapiro test)
#Kruskal Wallis kruskal.test: Nonparametric test of medians
```

Nonparametric test breadth GP
NSD

```{r}
parametersFragGPbrea %>% 
  group_by(genotype,treatment) %>%
  get_summary_stats(breadth, type = "common")

res.kruskal <- parametersFragGPbrea %>% kruskal_test(breadth ~ treatment)
res.kruskal
#stat 1.19 df 3 pvalue= 0.775
res.kruskal2 <- parametersFragGPbrea %>% kruskal_test(breadth ~ genotype)
res.kruskal2
# stat 5.38  df 2 p-value 0.068
#EFFECT SIZE
parametersFragGPbrea %>% kruskal_effsize(breadth ~ treatment)
# -0.0420-- small
parametersFragGPbrea %>% kruskal_effsize(breadth ~ genotype)
# 0.0767 -- moderate
# Pairwise comparisons
pwcCP <- parametersFragGPbrea %>% 
  dunn_test(breadth ~ treatment, p.adjust.method = "bonferroni") 
pwcCP
#NA no differences between treatments
pwcCPg <- parametersFragGPbrea %>% 
  dunn_test(breadth ~ genotype, p.adjust.method = "bonferroni") 
pwcCPg
#stat -3.074048 M5-M6- p-value 0.00634**
pwcCP <- pwcCP %>% add_xy_position(x = "treatment")
pwcCPg <- pwcCPg %>% add_xy_position(x = "genotype")

mod<-lm(breadth~treatment*genotype,parametersFragGPbrea)

effects::allEffects(mod)
summary(mod)
#F 1.026 df 35 p-value- 0.4456
parametersFragGPbrea$cat <- paste(parametersFragGPbrea$treatment,parametersFragGPbrea$genotype)

res.kruskalD <- parametersFragGPbrea %>% kruskal_test(breadth ~ cat)
res.kruskalD
# stat 8.94 df 11 p-value 0.628
#EFFECT SIZE
parametersFragGPbrea %>% kruskal_effsize(breadth ~ cat)
# -0.0590 -small
dunn.test(parametersFragGPbrea$breadth, parametersFragGPbrea$cat, method="bh")
#Chi^2= 8.9361 df= 11 p-value= 0.63
pwcD <- parametersFragGPbrea %>% 
  dunn_test(breadth ~ cat, p.adjust.method = "bonferroni") 
pwcD
pwcD <- pwcD %>% add_xy_position(x = "cat")

treabreGPP<-ggboxplot(parametersFragGPbrea, x = "treatment", y = "breadth", color= "black", fill="treatment", outlier.shape = 1) +
  stat_boxplot(geom='errorbar', linetype=1, width=0.5)+  #whiskers
  ylab('Temperature (ºC)')+
  xlab('Treatment')+
  ggtitle('Breadth GP')+
  scale_fill_manual(values = c('#66CCFF','#FFFF00', '#FF00CC', '#66FF33'))+
  stat_summary(fun.y=mean, geom="point", size=2)+ #line is median, and closed circle is mean
  scale_x_discrete(breaks=c("T1", "T2", "T3", "TC"),
        labels=c("Sprinkler", "Feeding", "Interactive","Control"))+
   stat_pvalue_manual(pwcCP, hide.ns = TRUE) +
  labs(
    subtitle = get_test_label(res.kruskal, detailed = TRUE),
    caption = get_pwc_label(pwcCP)
    )
treabreGPP
ggexport(treabreGPP, filename = "BreaKWplottrea.pdf")

genobreGPP<-ggboxplot(parametersFragGPbrea, x = "genotype", y = "breadth", color= "black", fill="genotype", outlier.shape = 1) +
  stat_boxplot(geom='errorbar', linetype=1, width=0.5)+  #whiskers
  ylab('Temperature (ºC)')+
  xlab('Genotype')+
  ggtitle('Breadth GP')+
  scale_fill_manual(values = c('red','green4', 'blue'))+
  stat_summary(fun.y=mean, geom="point", size=2)+ #line is median, and closed circle is mean
   stat_pvalue_manual(pwcCPg, hide.ns = TRUE) +
  labs(
    subtitle = get_test_label(res.kruskal2, detailed = TRUE),
    caption = get_pwc_label(pwcCPg)
    )
genobreGPP
ggexport(genobreGPP, filename = "BreaKWplotgeno.pdf")


BreiGPPP<-ggboxplot(parametersFragGPbrea, x = "cat", y = "breadth", color= "black", fill="genotype", outlier.shape = 1) +
  stat_boxplot(geom='errorbar', linetype=1, width=0.5)+  #whiskers
  ylab('Temperature (ºC)')+
  xlab('')+
  ggtitle('Breadth GP')+
  scale_fill_manual(values = c('red','green4', 'blue'))+
  stat_summary(fun.y=mean, geom="point", size=2)+ #line is median, and closed circle is mean
   stat_pvalue_manual(pwcD, hide.ns = TRUE)+
  labs(
    subtitle = get_test_label(res.kruskalD, detailed = TRUE),
    caption = get_pwc_label(pwcD)
    )
BreiGPPP
ggexport(BreiGPPP, filename = "BreaKWplot.interer.pdf")

ggboxplot(parametersFragGPbrea, x = "treatment", y = "breadth", color= "black", fill="genotype", outlier.shape = 1) +
  ylab('Breadth')+
  xlab('Treatment')+
  scale_fill_manual(values = c('red','green4', 'blue'))+
  stat_summary(fun.y=mean, geom="point", size=2)+
  scale_x_discrete(breaks=c("T1", "T2", "T3", "TC"),
        labels=c("Sprinkler", "Feeding", "Interactive","Control"))

ggboxplot(parametersFragGPbrea, x = "genotype", y = "breadth", color= "black", fill="treatment", outlier.shape = 1) +
  ylab('Breadth')+
  xlab('Genotype')+
  scale_fill_manual(values = c('#66CCFF','#FFFF00', '#FF00CC', '#66FF33'))
```

Parameter comparisons-breadth R

```{r}
##Checking non logged transformed portein data
ggdensity(parametersFragGRbrea$breadth, 
          main = "Density plot of Thermal Breadth",
          xlab = "Breadth")
#SKEWED
ggqqplot(parametersFragGRbrea$breadth)
shapiro.test(parametersFragGRbrea$breadth)
#0.00657**
#Non-normal data-  
#Log parameter
parametersFragGRbrea$logbreadth<-log(parametersFragGRbrea$breadth+1)

##Checking non logged transformed portein data
ggdensity(parametersFragGRbrea$logbreadth, 
          main = "Density plot of Thermal Breadth",
          xlab = "Thermal Breadth")
#SKEWED
ggqqplot(parametersFragGRbrea$logbreadth)
shapiro.test(parametersFragGRbrea$logbreadth)
#0.00236**
bartlett.test(logbreadth~interaction(treatment,genotype), data=parametersFragGRbrea)
#0.02396
bartlett.test(logbreadth~treatment,data=parametersFragGRbrea)
bartlett.test(logbreadth~genotype,data=parametersFragGRbrea)
leveneTest(logbreadth~treatment, data=parametersFragGRbrea)
leveneTest(logbreadth~genotype, data=parametersFragGRbrea)
leveneTest(logbreadth ~ treatment*genotype, data = parametersFragGRbrea)
fligner.test(logbreadth~treatment, data=parametersFragGRbrea)
fligner.test(logbreadth~genotype, data=parametersFragGRbrea)
#not normal variance homogeneous
#logit
parametersFragGRbrea$logitbreadth<-car::logit(parametersFragGRbrea$breadth)

###Checking non logged transformed portein data
ggdensity(parametersFragGRbrea$logitbreadth,na.rm = TRUE, 
          main = "Density plot of Thermal Breadth",
          xlab = "Thermal Breadth")
#SKEWED
ggqqplot(parametersFragGRbrea$logitbreadth,na.rm = TRUE)
shapiro.test(parametersFragGRbrea$logitbreadth)
#0.002113*
bartlett.test(logitbreadth~interaction(treatment,genotype), data=parametersFragGRbrea)
#0.0221*
bartlett.test(logitbreadth~treatment,data=parametersFragGRbrea)
bartlett.test(logitbreadth~genotype,data=parametersFragGRbrea)
leveneTest(logitbreadth~treatment, data=parametersFragGRbrea)
leveneTest(logitbreadth~genotype, data=parametersFragGRbrea)
leveneTest(logitbreadth ~ treatment*genotype, data = parametersFragGRbrea)
fligner.test(logitbreadth~treatment, data=parametersFragGRbrea)
fligner.test(logitbreadth~genotype, data=parametersFragGRbrea)
# Distribution is not normal (failed Shapiro test) variance heterogenous (failed Bartlett)
#Kruskal Wallis kruskal.test: Nonparametric test of medians
```

Nonparametric test breadth R
SD genotype K2	M5
SD interaction global - NSD Dunn

```{r}
parametersFragGRbrea %>% 
  group_by(genotype,treatment) %>%
  get_summary_stats(breadth, type = "common")

res.kruskal <- parametersFragGRbrea %>% kruskal_test(breadth ~ treatment)
res.kruskal
#stat 5.08 df 3 pvalue= 0.166
res.kruskal2 <- parametersFragGRbrea %>% kruskal_test(breadth ~ genotype)
res.kruskal2
# stat 7.79  df 2 p-value 0.0204*
#EFFECT SIZE
parametersFragGRbrea %>% kruskal_effsize(breadth ~ treatment)
# 0.0495-- small
parametersFragGRbrea %>% kruskal_effsize(breadth ~ genotype)
# 0.135 -- moderate
# Pairwise comparisons
pwcCP <- parametersFragGRbrea %>% 
  dunn_test(breadth ~ treatment, p.adjust.method = "bonferroni") 
pwcCP
#NA no differences between treatments
pwcCPg <- parametersFragGRbrea %>% 
  dunn_test(breadth ~ genotype, p.adjust.method = "bonferroni") 
pwcCPg
#K2	M5 stat --2.779411   p-value 0.01633726*
pwcCP <- pwcCP %>% add_xy_position(x = "treatment")
pwcCPg <- pwcCPg %>% add_xy_position(x = "genotype")

dunn.test(parametersFragGRbrea$breadth, parametersFragGRrmax$genotype, method="bh")
#chi-squared = 8.0306, df = 2, p-value = 0.02
mod<-lm(breadth~treatment*genotype,parametersFragGRbrea)

effects::allEffects(mod)
summary(mod)
#F 3.507 df 34 p-value- 0.002368
parametersFragGRbrea$cat <- paste(parametersFragGRbrea$treatment,parametersFragGRbrea$genotype)

res.kruskalD <- parametersFragGRbrea %>% kruskal_test(breadth ~ cat)
res.kruskalD
# stat 26 df 11 p-value 0.0064*
#EFFECT SIZE
parametersFragGRbrea %>% kruskal_effsize(breadth ~ cat)
# 0.442 -large
dunn.test(parametersFragGRbrea$breadth, parametersFragGRbrea$cat, method="bh")
#Chi^2= 26.0401 df= 11 p-value= 0.01*
pwcD <- parametersFragGRbrea %>% 
  dunn_test(breadth ~ cat, p.adjust.method = "bonferroni") 
pwcD
pwcD <- pwcD %>% add_xy_position(x = "cat")

treabreGRP<-ggboxplot(parametersFragGRbrea, x = "treatment", y = "breadth", color= "black", fill="treatment", outlier.shape = 1) +
  stat_boxplot(geom='errorbar', linetype=1, width=0.5)+  #whiskers
  ylab('Temperature (ºC)')+
  xlab('Treatment')+
  ggtitle('Breadth R')+
  scale_fill_manual(values = c('#66CCFF','#FFFF00', '#FF00CC', '#66FF33'))+
  stat_summary(fun.y=mean, geom="point", size=2)+ #line is median, and closed circle is mean
  scale_x_discrete(breaks=c("T1", "T2", "T3", "TC"),
        labels=c("Sprinkler", "Feeding", "Interactive","Control"))+
   stat_pvalue_manual(pwcCP, hide.ns = TRUE) +
  labs(
    subtitle = get_test_label(res.kruskal, detailed = TRUE),
    caption = get_pwc_label(pwcCP)
    )
treabreGRP
ggexport(treabreGRP, filename = "BreaRKWplottrea.pdf")

genobreGRP<-ggboxplot(parametersFragGRbrea, x = "genotype", y = "breadth", color= "black", fill="genotype", outlier.shape = 1) +
  stat_boxplot(geom='errorbar', linetype=1, width=0.5)+  #whiskers
  ylab('Temperature (ºC)')+
  xlab('Genotype')+
  ggtitle('Breadth R')+
  scale_fill_manual(values = c('red','green4', 'blue'))+
  stat_summary(fun.y=mean, geom="point", size=2)+ #line is median, and closed circle is mean
   stat_pvalue_manual(pwcCPg, hide.ns = TRUE, y.position = 7.5) +
  labs(
    subtitle = get_test_label(res.kruskal2, detailed = TRUE),
    caption = get_pwc_label(pwcCPg)
    )
genobreGRP
ggexport(genobreGRP, filename = "BreaRKWplotgeno.pdf")


BreiGRPP<-ggboxplot(parametersFragGRbrea, x = "cat", y = "breadth", color= "black", fill="genotype", outlier.shape = 1) +
  stat_boxplot(geom='errorbar', linetype=1, width=0.5)+  #whiskers
  ylab('Temperature (ºC)')+
  xlab('')+
  ggtitle('Breadth R')+
  scale_fill_manual(values = c('red','green4', 'blue'))+
  stat_summary(fun.y=mean, geom="point", size=2)+ #line is median, and closed circle is mean
   stat_pvalue_manual(pwcD, hide.ns = TRUE)+
  labs(
    subtitle = get_test_label(res.kruskalD, detailed = TRUE),
    caption = get_pwc_label(pwcD)
    )
BreiGRPP
ggexport(BreiGRPP, filename = "BreaRKWplot.interer.pdf")

ggboxplot(parametersFragGRbrea, x = "treatment", y = "breadth", color= "black", fill="genotype", outlier.shape = 1) +
  ylab('Breadth')+
  xlab('Treatment')+
  scale_fill_manual(values = c('red','green4', 'blue'))+
  stat_summary(fun.y=mean, geom="point", size=2)+
  scale_x_discrete(breaks=c("T1", "T2", "T3", "TC"),
        labels=c("Sprinkler", "Feeding", "Interactive","Control"))

ggboxplot(parametersFragGRbrea, x = "genotype", y = "breadth", color= "black", fill="treatment", outlier.shape = 1) +
  ylab('Breadth')+
  xlab('Genotype')+
  scale_fill_manual(values = c('#66CCFF','#FFFF00', '#FF00CC', '#66FF33'))
```

parametersFragRFc (ctmin)
Parameter comparisons-ctmin R

```{r}
parametersFragRFc

##Checking non logged transformed portein data
ggdensity(parametersFragRFc$ctmin, 
          main = "Density plot of CTmin",
          xlab = "CTmin")
#SKEWED
ggqqplot(parametersFragRFc$ctmin)
shapiro.test(parametersFragRFc$ctmin)
#0.3373
#normal data
bartlett.test(ctmin~interaction(treatment,genotype), data=parametersFragRFc)
bartlett.test(ctmin~treatment,data=parametersFragRFc)
bartlett.test(ctmin~genotype, data=parametersFragRFc)
leveneTest(ctmin~treatment, data=parametersFragRFc)
leveneTest(ctmin~genotype, data=parametersFragRFc)
leveneTest(ctmin ~ treatment*genotype, data = parametersFragRFc)
fligner.test(ctmin~treatment, data=parametersFragRFc)
fligner.test(ctmin~genotype, data=parametersFragRFc)
#Normal data and equal vvariance 
```

Parametric test ctmin R- passed shapiro/Bartlett/Levene/Flinger
NSD

```{r}
parametersFragRFc %>% 
  group_by(genotype,treatment) %>%
  get_summary_stats(ctmin, type = "common")

# Proceed with ANOVA/lm post hoc Tukeys HSD
ctminmod<-aov(ctmin~genotype*treatment,parametersFragRFc)
summary(ctminmod)
#NSD

#Post hoc Pairwise
pairwise.t.test(parametersFragRFc$ctmin, parametersFragRFc$treatment,
                p.adjust.method = "BH")
#NS
pairwise.t.test(parametersFragRFc$ctmin, parametersFragRFc$genotype,
                p.adjust.method = "BH")
#NS
parametersFragRFc$cat <- paste(parametersFragRFc$treatment,parametersFragRFc$genotype)

pairwise.t.test(parametersFragRFc$ctmin, parametersFragRFc$cat,
                p.adjust.method = "BH")
#NS
TukeyHSD(ctminmod)
#NS

ctmintSSt = summarySE(parametersFragRFc, measurevar="ctmin",
                     groupvars=c("treatment"))

ctmintSSt
ctmingSSt = summarySE(parametersFragRFc, measurevar="ctmin",
                     groupvars=c("genotype"))

ctmingSSt
ctminiSSt = summarySE(parametersFragRFc, measurevar="ctmin",
                     groupvars=c("cat"))

ctminiSSt
 
ctmintbar<-ggplot(ctmintSSt, aes(x=factor(treatment), y=ctmin, fill=treatment)) + 
    geom_bar(stat="identity", width=0.8) +
    geom_errorbar(aes(ymin=ctmin-se, ymax=ctmin+se),
                  width=.2) +
    xlab("Treatment") +
  ylab('Temperature (ºC)') +
  ggtitle('CTmin R')+
   theme_classic()+
    scale_x_discrete(breaks=c("T1", "T2", "T3", "TC"),
        labels=c("Sprinkler", "Feeding", "Interactive","Control"))+
  scale_fill_manual(values = c('#66CCFF','#FFFF00', '#FF00CC', '#66FF33'))
 ctmintbar
  
ctminImod<-lm(ctmin~genotype*treatment,parametersFragRFc)
summary(ctminImod)
#treat2 F- 1.035, DF- 33 p-value 0.4393
ctmintmod<-aov(ctmin~treatment,parametersFragRFc)
summary(ctmintmod)
# treat df 3 F 0.339 P= 0.797
TukeyHSD(ctmintmod)

ctmingmod<-aov(ctmin~genotype,parametersFragRFc)
summary(ctmingmod)
TukeyHSD(ctmingmod)
# NSD

ctminImodP<-ggplot(ctminImod, aes(x=treatment, ctmin, fill= genotype))+
  stat_boxplot(geom= "errorbar", width= 0.5, position = position_dodge(1))+
  geom_boxplot(position = position_dodge(1),outlier.shape=1)+
  theme_classic()+
  xlab('Treatment')+
  ylab('Temperature (ºC)') +
  ggtitle("CTmin R")+
  stat_compare_means(label.y=30, method = "anova")+
  scale_fill_manual(values = c('red','green4', 'blue'))+
  scale_x_discrete(breaks=c("T1", "T2", "T3", "TC"),
        labels=c("Sprinkler", "Feeding", "Interactive","Control"))
ctminImodP

ggexport(ctminImodP, filename = "ctminANOplotinter.pdf")


ctmingmodP<-ggplot(ctmingmod, aes(x=genotype, ctmin, fill= genotype))+
  stat_boxplot(geom= "errorbar", width= 0.5, position = position_dodge(1))+
  geom_boxplot(position = position_dodge(1),outlier.shape=1)+
  theme_classic()+
  xlab('Genotype')+
  ylab('Temperature (ºC)') +
  ggtitle("CTmin R")+
    stat_summary(fun.y=mean, geom="point", size=2)+ #line is median, and closed circle is mean
  stat_compare_means(label.y=30, method = "anova")+
  scale_fill_manual(values = c('red','green4', 'blue'))
ctmingmodP
ggexport(ctmingmodP, filename = "ctminANOplotgeno.pdf")

ctmintmodP<-ggplot(ctmintmod, aes(x=treatment, ctmin, fill= treatment))+
  stat_boxplot(geom= "errorbar", width= 0.5, position = position_dodge(1))+
  geom_boxplot(position = position_dodge(1),outlier.shape=1)+
  theme_classic()+
  xlab('Treatment')+
  ylab('Temperature (ºC)') +
  ggtitle("CTmin R")+
      stat_summary(fun.y=mean, geom="point", size=2)+ #line is median, and closed circle is mean
  stat_compare_means(label.y=30, method = "anova")+
  scale_fill_manual(values = c('#66CCFF','#FFFF00', '#FF00CC', '#66FF33'))+
  scale_x_discrete(breaks=c("T1", "T2", "T3", "TC"),
        labels=c("Sprinkler", "Feeding", "Interactive","Control"))

ctmintmodP
ggexport(ctmintmodP, filename = "ctminANOplottrea.pdf")

```

parametersFragGRCTmax (ctmax)
Parameter comparisons-CTmax R

```{r}
parametersFragGRCTmax

##Checking non logged transformed 
ggdensity(parametersFragGRCTmax$ctmax, 
          main = "Density plot of CTmax",
          xlab = "CTmax")
#SKEWED
ggqqplot(parametersFragGRCTmax$ctmax)
shapiro.test(parametersFragGRCTmax$ctmax)
#5.632e-8***
#not normal data
bartlett.test(ctmax~interaction(treatment,genotype), data=parametersFragGRCTmax)
# 0.0001111*
bartlett.test(ctmax~treatment, data=parametersFragGRCTmax)
#0.001057
bartlett.test(ctmax~genotype, data=parametersFragGRCTmax)
#0.02596
leveneTest(ctmax~treatment, data=parametersFragGRCTmax)
leveneTest(ctmax~genotype, data=parametersFragGRCTmax)
leveneTest(ctmax ~ treatment*genotype, data = parametersFragGRCTmax)
fligner.test(ctmax~treatment, data=parametersFragGRCTmax)
fligner.test(ctmax~genotype, data=parametersFragGRCTmax)
# Non Normal data and failed bartlett
#Log parameter
parametersFragGRCTmax$logctmax<-log(parametersFragGRCTmax$ctmax+1)

##Checking non logged transformed portein data
ggdensity(parametersFragGRCTmax$logctmax, 
          main = "Density plot of CTmax",
          xlab = " CTmax")
#SKEWED
ggqqplot(parametersFragGRCTmax$logctmax)
shapiro.test(parametersFragGRCTmax$logctmax)
#1.77e-6*
bartlett.test(logctmax~interaction(treatment,genotype), data=parametersFragGRCTmax)
#0.00234*
bartlett.test(logctmax~treatment,data=parametersFragGRCTmax)
#0.0114*
bartlett.test(logctmax~genotype,data=parametersFragGRCTmax)
leveneTest(logctmax~treatment, data=parametersFragGRCTmax)
leveneTest(logctmax~genotype, data=parametersFragGRCTmax)
leveneTest(logctmax ~ treatment*genotype, data = parametersFragGRCTmax)
fligner.test(logctmax~treatment, data=parametersFragGRCTmax)
fligner.test(logctmax~genotype, data=parametersFragGRCTmax)
#not normal variance homogeneous
#logit
parametersFragGRCTmax$logitctmax<-car::logit(parametersFragGRCTmax$ctmax)

###Checking non logged transformed portein data
ggdensity(parametersFragGRCTmax$logitctmax,na.rm = TRUE, 
          main = "Density plot of CTmax",
          xlab = "CTmax")
#SKEWED
ggqqplot(parametersFragGRCTmax$logitctmax,na.rm = TRUE)
shapiro.test(parametersFragGRCTmax$logitctmax)
#4.058e-8*
bartlett.test(logitctmax~interaction(treatment,genotype), data=parametersFragGRCTmax)
#7.84e-5*
bartlett.test(logitctmax~treatment,data=parametersFragGRCTmax)
#0.000763*
bartlett.test(logitctmax~genotype,data=parametersFragGRCTmax)
#0.01757*
leveneTest(logitctmax~treatment, data=parametersFragGRCTmax)
leveneTest(logitctmax~genotype, data=parametersFragGRCTmax)
leveneTest(logitctmax ~ treatment*genotype, data = parametersFragGRCTmax)
fligner.test(logitctmax~treatment, data=parametersFragGRCTmax)
fligner.test(logitctmax~genotype, data=parametersFragGRCTmax)
# Non normal data (shaprio) vairance not equal (failed BArtlett )
# Nonparameteric test
```

Nonparametric test CTmax R
NSD

```{r}
parametersFragGRCTmax %>% 
  group_by(genotype,treatment) %>%
  get_summary_stats(ctmax, type = "common")

res.kruskal <- parametersFragGRCTmax %>% kruskal_test(ctmax ~ treatment)
res.kruskal
#stat 0.429 df 3 pvalue= 0.934
res.kruskal2 <- parametersFragGRCTmax %>% kruskal_test(ctmax ~ genotype)
res.kruskal2
# stat 3.11  df 2 p-value 0.211
#EFFECT SIZE
parametersFragGRCTmax %>% kruskal_effsize(ctmax ~ treatment)
# -0.0677-- moderate
parametersFragGRCTmax %>% kruskal_effsize(ctmax ~ genotype)
# 0.0285 -- small
# Pairwise comparisons
pwcCP <- parametersFragGRCTmax %>% 
  dunn_test(ctmax ~ treatment, p.adjust.method = "bonferroni") 
pwcCP
#NA no differences between treatments
pwcCPg <- parametersFragGRCTmax %>% 
  dunn_test(ctmax ~ genotype, p.adjust.method = "bonferroni") 
pwcCPg
#NA no differences between genotypes
pwcCP <- pwcCP %>% add_xy_position(x = "treatment")
pwcCPg <- pwcCPg %>% add_xy_position(x = "genotype")

mod<-lm(ctmax~treatment*genotype,parametersFragGRCTmax)

effects::allEffects(mod)
summary(mod)
#F 1.59 df 30 p-value- 0.1526
parametersFragGRCTmax$cat <- paste(parametersFragGRCTmax$treatment,parametersFragGRCTmax$genotype)

res.kruskalD <- parametersFragGRCTmax %>% kruskal_test(ctmax ~ cat)
res.kruskalD
# stat 16.9 df 11 p-value 0.112
#EFFECT SIZE
parametersFragGRCTmax %>% kruskal_effsize(ctmax ~ cat)
# 0.195 -large
dunn.test(parametersFragGRCTmax$ctmax, parametersFragGRCTmax$cat, method="bh")
#Chi^2= 16.8533 df= 11 p-value= 0.11
pwcD <- parametersFragGRCTmax %>% 
  dunn_test(ctmax ~ cat, p.adjust.method = "bonferroni") 
pwcD
pwcD <- pwcD %>% add_xy_position(x = "cat")
#NA no difference
treactmaxGRP<-ggboxplot(parametersFragGRCTmax, x = "treatment", y = "ctmax", color= "black", fill="treatment", outlier.shape = 1) +
  stat_boxplot(geom='errorbar', linetype=1, width=0.5)+  #whiskers
  ylab('Temperature (ºC)')+
  xlab('Treatment')+
  ggtitle('CTmax R')+
  scale_fill_manual(values = c('#66CCFF','#FFFF00', '#FF00CC', '#66FF33'))+
  stat_summary(fun.y=mean, geom="point", size=2)+ #line is median, and closed circle is mean
  scale_x_discrete(breaks=c("T1", "T2", "T3", "TC"),
        labels=c("Sprinkler", "Feeding", "Interactive","Control"))+
   stat_pvalue_manual(pwcCP, hide.ns = TRUE) +
  labs(
    subtitle = get_test_label(res.kruskal, detailed = TRUE),
    caption = get_pwc_label(pwcCP)
    )
treactmaxGRP
ggexport(treactmaxGRP, filename = "CtmaxRKWplottrea.pdf")

genoCTmaxGRP<-ggboxplot(parametersFragGRCTmax, x = "genotype", y = "ctmax", color= "black", fill="genotype", outlier.shape = 1) +
  stat_boxplot(geom='errorbar', linetype=1, width=0.5)+  #whiskers
  ylab('Temperature (ºC)')+
  xlab('Genotype')+
  ggtitle('CTmax R')+
  scale_fill_manual(values = c('red','green4', 'blue'))+
  stat_summary(fun.y=mean, geom="point", size=2)+ #line is median, and closed circle is mean
   stat_pvalue_manual(pwcCPg, hide.ns = TRUE)+
  labs(
    subtitle = get_test_label(res.kruskal2, detailed = TRUE),
    caption = get_pwc_label(pwcCPg)
    )
genoCTmaxGRP
ggexport(genoCTmaxGRP, filename = "CtmaxRKWplotgeno.pdf")


CTmaxGRP<-ggboxplot(parametersFragGRCTmax, x = "cat", y = "ctmax", color= "black", fill="genotype", outlier.shape = 1) +
  stat_boxplot(geom='errorbar', linetype=1, width=0.5)+  #whiskers
  ylab('Temperature (ºC)')+
  xlab('')+
  ggtitle('CTmax R')+
  scale_fill_manual(values = c('red','green4', 'blue'))+
  stat_summary(fun.y=mean, geom="point", size=2)+ #line is median, and closed circle is mean
   stat_pvalue_manual(pwcD, hide.ns = TRUE)+
  labs(
    subtitle = get_test_label(res.kruskalD, detailed = TRUE),
    caption = get_pwc_label(pwcD)
    )
CTmaxGRP
ggexport(CTmaxGRP, filename = "CTmaxRKWplot.interer.pdf")

ggboxplot(parametersFragGRCTmax, x = "treatment", y = "ctmax", color= "black", fill="genotype", outlier.shape = 1) +
  ylab('CTmax')+
  xlab('Treatment')+
  scale_fill_manual(values = c('red','green4', 'blue'))+
  stat_summary(fun.y=mean, geom="point", size=2)+
  scale_x_discrete(breaks=c("T1", "T2", "T3", "TC"),
        labels=c("Sprinkler", "Feeding", "Interactive","Control"))

ggboxplot(parametersFragGRCTmax, x = "genotype", y = "ctmax", color= "black", fill="treatment", outlier.shape = 1) +
  ylab('CTmax')+
  xlab('Genotype')+
  scale_fill_manual(values = c('#66CCFF','#FFFF00', '#FF00CC', '#66FF33'))
```

parametersFragGPCTmax
Parameter comparisons-CTmax GP

```{r}
parametersFragGPCTmax
##Checking non logged transformed portein data
ggdensity(parametersFragGPCTmax$ctmax, 
          main = "Density plot of CTmax",
          xlab = "CTmax")
#SKEWED
ggqqplot(parametersFragGPCTmax$ctmax)
# large outlier
mPGPsp<-lm(ctmax~genotype*treatment,parametersFragGPCTmax)
summary(mPGPsp)
mPGPsp2<-aov(ctmax~genotype*treatment,parametersFragGPCTmax)
summary(mPGPsp2)
anova(mPGPsp)
## check for outliers
cooksd <- cooks.distance(mPGPsp)
plot(cooksd, pch=".", cex=2, main="Influential Obs by Cooks distance")  # plot cook's distance
abline(h = 4*mean(cooksd, na.rm=TRUE), col="red")  # add cutoff line--In general use, those observations that have a cook’s distance greater than 4 times the mean may be classified as influential. This is not a hard boundary.
text(x=1:length(cooksd)+1, y=cooksd, labels=ifelse(cooksd>4*mean(cooksd, na.rm=TRUE),names(cooksd),""), cex=0.6, pos=2, col="red")
#Remove GP	K201d- 50.313 [4]
parametersFragGPCTmax<-parametersFragGPCTmax[-(4),]

shapiro.test(parametersFragGPCTmax$ctmax)
#4.167e-7**
#Non-normal data-  
#Log parameter
parametersFragGPCTmax$logctmax<-log(parametersFragGPCTmax$ctmax+1)

##Checking non logged transformed portein data
ggdensity(parametersFragGPCTmax$logctmax, 
          main = "Density plot of CTmax",
          xlab = " CTmax")
#SKEWED
ggqqplot(parametersFragGPCTmax$logctmax)
shapiro.test(parametersFragGPCTmax$logctmax)
#5.913e-7*
bartlett.test(logctmax~interaction(treatment,genotype), data=parametersFragGPCTmax)
#0.00981*
bartlett.test(logctmax~treatment,data=parametersFragGPCTmax)
#0.04678*
bartlett.test(logctmax~genotype,data=parametersFragGPCTmax)
leveneTest(logctmax~treatment, data=parametersFragGPCTmax)
leveneTest(logctmax~genotype, data=parametersFragGPCTmax)
leveneTest(logctmax ~ treatment*genotype, data = parametersFragGPCTmax)
fligner.test(logctmax~treatment, data=parametersFragGPCTmax)
fligner.test(logctmax~genotype, data=parametersFragGPCTmax)
#not normal variance homogeneous
#logit
parametersFragGPCTmax$logitctmax<-car::logit(parametersFragGPCTmax$ctmax)

###Checking non logged transformed portein data
ggdensity(parametersFragGPCTmax$logitctmax,na.rm = TRUE, 
          main = "Density plot of CTmax",
          xlab = "CTmax")
#SKEWED
ggqqplot(parametersFragGPCTmax$logitctmax,na.rm = TRUE)
shapiro.test(parametersFragGPCTmax$logitctmax)
#4.861e-7*
bartlett.test(logitctmax~interaction(treatment,genotype), data=parametersFragGPCTmax)
#0.008064*
bartlett.test(logitctmax~treatment,data=parametersFragGPCTmax)
#0.04028*
bartlett.test(logitctmax~genotype,data=parametersFragGPCTmax)
leveneTest(logitctmax~treatment, data=parametersFragGPCTmax)
leveneTest(logitctmax~genotype, data=parametersFragGPCTmax)
leveneTest(logitctmax ~ treatment*genotype, data = parametersFragGPCTmax)
fligner.test(logitctmax~treatment, data=parametersFragGPCTmax)
fligner.test(logitctmax~genotype, data=parametersFragGPCTmax)
# Not normal (failed Shapiro test) None equal variance (failed Bartlett)
#Kruskal Wallis kruskal.test: Nonparametric test of medians
```

Nonparametric test CTmax GP
SD genotype K2-M6

```{r}
parametersFragGPCTmax %>% 
  group_by(genotype,treatment) %>%
  get_summary_stats(ctmax, type = "common")

res.kruskal <- parametersFragGPCTmax %>% kruskal_test(ctmax ~ treatment)
res.kruskal
#stat 4.24 df 3 pvalue= 0.236
res.kruskal2 <- parametersFragGPCTmax %>% kruskal_test(ctmax ~ genotype)
res.kruskal2
# stat 7.73  df 2 p-value 0.021*
#EFFECT SIZE
parametersFragGPCTmax %>% kruskal_effsize(ctmax ~ treatment)
# 0.0296-- small
parametersFragGPCTmax %>% kruskal_effsize(ctmax ~ genotype)
# 0.133 -- moderate
# Pairwise comparisons
pwcCP <- parametersFragGPCTmax %>% 
  dunn_test(ctmax ~ treatment, p.adjust.method = "bonferroni") 
pwcCP
#NA no differences between treatments
pwcCPg <- parametersFragGPCTmax %>% 
  dunn_test(ctmax ~ genotype, p.adjust.method = "bonferroni") 
pwcCPg
#K2-M6 0.04770466
#stat -3.074048 M5-M6- p-value 0.00634**
pwcCP <- pwcCP %>% add_xy_position(x = "treatment")
pwcCPg <- pwcCPg %>% add_xy_position(x = "genotype")

mod<-lm(ctmax~treatment*genotype,parametersFragGPCTmax)

effects::allEffects(mod)
summary(mod)
#F 1.168 df 34 p-value- 0.344
parametersFragGPCTmax$cat <- paste(parametersFragGPCTmax$treatment,parametersFragGPCTmax$genotype)

res.kruskalD <- parametersFragGPCTmax %>% kruskal_test(ctmax ~ cat)
res.kruskalD
# stat 18.7 df 11 p-value 0.0659
#EFFECT SIZE
parametersFragGPCTmax %>% kruskal_effsize(ctmax ~ cat)
# 0.228 - large
dunn.test(parametersFragGPCTmax$ctmax, parametersFragGPCTmax$cat, method="bh")
#Chi^2= 18.7391 df= 11 p-value= 0.07
pwcD <- parametersFragGPCTmax %>% 
  dunn_test(ctmax ~ cat, p.adjust.method = "bonferroni") 
pwcD
pwcD <- pwcD %>% add_xy_position(x = "cat")
#NS
treaCTmaxGPP<-ggboxplot(parametersFragGPCTmax, x = "treatment", y = "ctmax", color= "black", fill="treatment", outlier.shape = 1) +
  stat_boxplot(geom='errorbar', linetype=1, width=0.5)+  #whiskers
  ylab('Temperature (ºC)')+
  xlab('Treatment')+
  ggtitle('CTmax GP')+
  scale_fill_manual(values = c('#66CCFF','#FFFF00', '#FF00CC', '#66FF33'))+
  stat_summary(fun.y=mean, geom="point", size=2)+ #line is median, and closed circle is mean
  scale_x_discrete(breaks=c("T1", "T2", "T3", "TC"),
        labels=c("Sprinkler", "Feeding", "Interactive","Control"))+
   stat_pvalue_manual(pwcCP, hide.ns = TRUE) +
  labs(
    subtitle = get_test_label(res.kruskal, detailed = TRUE),
    caption = get_pwc_label(pwcCP)
    )
treaCTmaxGPP
ggexport(treaCTmaxGPP, filename = "CTmaxKWplottrea.pdf")

genoCTmaxGPP<-ggboxplot(parametersFragGPCTmax, x = "genotype", y = "ctmax", color= "black", fill="genotype", outlier.shape = 1) +
  stat_boxplot(geom='errorbar', linetype=1, width=0.5)+  #whiskers
  ylab('Temperature (ºC)')+
  xlab('Genotype')+
  ggtitle('CTmax GP')+
  scale_fill_manual(values = c('red','green4', 'blue'))+
  stat_summary(fun.y=mean, geom="point", size=2)+ #line is median, and closed circle is mean
   stat_pvalue_manual(pwcCPg, hide.ns = TRUE) +
  labs(
    subtitle = get_test_label(res.kruskal2, detailed = TRUE),
    caption = get_pwc_label(pwcCPg)
    )
genoCTmaxGPP
ggexport(genoCTmaxGPP, filename = "CTmaxKWplotgeno.pdf")


inteCTmaxGPPP<-ggboxplot(parametersFragGPCTmax, x = "cat", y = "ctmax", color= "black", fill="genotype", outlier.shape = 1) +
  stat_boxplot(geom='errorbar', linetype=1, width=0.5)+  #whiskers
  ylab('Temperature (ºC)')+
  xlab('')+
  ggtitle('CTmax GP')+
  scale_fill_manual(values = c('red','green4', 'blue'))+
  stat_summary(fun.y=mean, geom="point", size=2)+ #line is median, and closed circle is mean
   stat_pvalue_manual(pwcD, hide.ns = TRUE)+
  labs(
    subtitle = get_test_label(res.kruskalD, detailed = TRUE),
    caption = get_pwc_label(pwcD)
    )
inteCTmaxGPPP
ggexport(inteCTmaxGPPP, filename = "CTmaxKWplot.interer.pdf")

ggboxplot(parametersFragGPCTmax, x = "treatment", y = "ctmax", color= "black", fill="genotype", outlier.shape = 1) +
  ylab('CTmax')+
  xlab('Treatment')+
  scale_fill_manual(values = c('red','green4', 'blue'))+
  stat_summary(fun.y=mean, geom="point", size=2)+
  scale_x_discrete(breaks=c("T1", "T2", "T3", "TC"),
        labels=c("Sprinkler", "Feeding", "Interactive","Control"))

ggboxplot(parametersFragGPCTmax, x = "genotype", y = "ctmax", color= "black", fill="treatment", outlier.shape = 1) +
  ylab('CTmax')+
  xlab('Genotype')+
  scale_fill_manual(values = c('#66CCFF','#FFFF00', '#FF00CC', '#66FF33'))
```

parametersFragGRE
Parameter Comparisons- E R

```{r}
parametersFragGRE

##Checking non logged transformed portein data
ggdensity(parametersFragGRE$e, 
          main = "Density plot of E",
          xlab = "E")
#SKEWED
ggqqplot(parametersFragGRE$e)
shapiro.test(parametersFragGRE$e)
#0.6301
#normal data
bartlett.test(e~interaction(treatment,genotype), data=parametersFragGRE)
bartlett.test(e~treatment, data=parametersFragGRE)
bartlett.test(e~genotype, data=parametersFragGRE)
leveneTest(e~treatment, data=parametersFragGRE)
leveneTest(e~genotype, data=parametersFragGRE)
leveneTest(e ~ treatment*genotype, data = parametersFragGRE)
fligner.test(e~treatment, data=parametersFragGRE)
fligner.test(e~genotype, data=parametersFragGRE)
# Normal data and Homogenous variance
#Non-normal data-  
#Log parameter
parametersFragGRE$loge<-log(parametersFragGRE$e+1)

##Checking non logged transformed portein data
ggdensity(parametersFragGRE$loge, 
          main = "Density plot of E",
          xlab = " E")
#SKEWED
ggqqplot(parametersFragGRE$loge)
shapiro.test(parametersFragGRE$loge)
# 0.06767
bartlett.test(loge~interaction(treatment,genotype), data=parametersFragGRE)
#0.02683*
bartlett.test(loge~treatment, data=parametersFragGRE)
bartlett.test(loge~genotype, data=parametersFragGRE)
#0.02237
leveneTest(loge~treatment, data=parametersFragGRE)
leveneTest(loge~genotype, data=parametersFragGRE)
#0.04515*
leveneTest(loge ~ treatment*genotype, data = parametersFragGRE)
fligner.test(loge~treatment, data=parametersFragGRE)
fligner.test(loge~genotype, data=parametersFragGRE)
# Not normal (failed Shapiro test) None equal variance (failed Bartlett/Levenes)
#Kruskal Wallis kruskal.test: Nonparametric test of medians
```

Parametric test E R
passed shapiro/Bartlett/Levene/Flinger
NSD

```{r}
parametersFragGRE %>% 
  group_by(genotype,treatment) %>%
  get_summary_stats(e, type = "common")

# Proceed with ANOVA/lm post hoc Tukeys HSD
emod<-aov(e~genotype*treatment,parametersFragGRE)
summary(emod)
#SD geno 0.0365

#Post hoc Pairwise
pairwise.t.test(parametersFragGRE$e, parametersFragGRE$treatment,
                p.adjust.method = "BH")
#NS
pairwise.t.test(parametersFragGRE$e, parametersFragGRE$genotype,
                p.adjust.method = "BH")
#NS
parametersFragGRE$cat <- paste(parametersFragGRE$treatment,parametersFragGRE$genotype)

pairwise.t.test(parametersFragGRE$e, parametersFragGRE$cat,
                p.adjust.method = "BH")
#NS
TukeyHSD(emod)
#NS

etSSt = summarySE(parametersFragGRE, measurevar="e",
                     groupvars=c("treatment"))

etSSt
egSSt = summarySE(parametersFragGRE, measurevar="e",
                     groupvars=c("genotype"))

egSSt
eiSSt = summarySE(parametersFragGRE, measurevar="e",
                     groupvars=c("cat"))

eiSSt
 
etbar<-ggplot(etSSt, aes(x=factor(treatment), y=e, fill=treatment)) + 
    geom_bar(stat="identity", width=0.8) +
    geom_errorbar(aes(ymin=e-se, ymax=e+se),
                  width=.2) +
    xlab("Treatment") +
  ylab('Energy (eV)') +
  ggtitle('E R')+
   theme_classic()+
    scale_x_discrete(breaks=c("T1", "T2", "T3", "TC"),
        labels=c("Sprinkler", "Feeding", "Interactive","Control"))+
  scale_fill_manual(values = c('#66CCFF','#FFFF00', '#FF00CC', '#66FF33'))
 etbar
  
eImod<-lm(e~genotype*treatment,parametersFragGRE)
summary(eImod)
# M6- T3 0.01994 & M6 TC 0.04444 F- 2.091, DF- 31 p-value 0.05253
etmod<-aov(e~treatment,parametersFragGRE)
summary(etmod)
TukeyHSD(etmod)
egmod<-aov(e~genotype,parametersFragGRE)
summary(egmod)
TukeyHSD(egmod)
# NSD
etmodl<-lm(e~treatment,parametersFragGRE)
summary(etmodl)
#F- 0.7482, DF- 39 p-value 0.53
egmodl<-lm(e~genotype,parametersFragGRE)
summary(egmodl)
#F- 3.166, DF- 40 p-value 0.05291

eImodP<-ggplot(eImod, aes(x=treatment, e, fill= genotype))+
  stat_boxplot(geom= "errorbar", width= 0.5, position = position_dodge(1))+
  geom_boxplot(position = position_dodge(1),outlier.shape=1)+
  theme_classic()+
  xlab('Treatment')+
  ylab('Energy (eV)') +
  ggtitle("E R")+
  stat_compare_means(label.y=1,method = "anova")+
  scale_fill_manual(values = c('red','green4', 'blue'))+
  scale_x_discrete(breaks=c("T1", "T2", "T3", "TC"),
        labels=c("Sprinkler", "Feeding", "Interactive","Control"))
eImodP

ggexport(eImodP, filename = "eANOplotinter.pdf")


egmodP<-ggplot(egmod, aes(x=genotype, e, fill= genotype))+
  stat_boxplot(geom= "errorbar", width= 0.5, position = position_dodge(1))+
  geom_boxplot(position = position_dodge(1),outlier.shape=1)+
  theme_classic()+
  xlab('Genotype')+
  ylab('Energy (eV)') +
  ggtitle("E R")+
    stat_summary(fun.y=mean, geom="point", size=2)+ #line is median, and closed circle is mean
  stat_compare_means(label.y=1, method = "anova")+
  scale_fill_manual(values = c('red','green4', 'blue'))
egmodP
ggexport(egmodP, filename = "eANOplotgeno.pdf")

etmodP<-ggplot(etmod, aes(x=treatment, e, fill= treatment))+
  stat_boxplot(geom= "errorbar", width= 0.5, position = position_dodge(1))+
  geom_boxplot(position = position_dodge(1),outlier.shape=1)+
  theme_classic()+
  xlab('Treatment')+
  ylab('Energy (eV)') +
  ggtitle("E R")+
      stat_summary(fun.y=mean, geom="point", size=2)+ #line is median, and closed circle is mean
  stat_compare_means(label.y=1, method = "anova")+
  scale_fill_manual(values = c('#66CCFF','#FFFF00', '#FF00CC', '#66FF33'))+
  scale_x_discrete(breaks=c("T1", "T2", "T3", "TC"),
        labels=c("Sprinkler", "Feeding", "Interactive","Control"))

etmodP
ggexport(etmodP, filename = "eANOplottrea.pdf")

```

parametersFragGPE
Parameter Comparisons- E GP

```{r}
parametersFragGPE

##Checking non logged transformed portein data
ggdensity(parametersFragGPE$e, 
          main = "Density plot of E",
          xlab = "E")
#SKEWED
ggqqplot(parametersFragGPE$e)
shapiro.test(parametersFragGPE$e)
#0.008942**
#Not normal data
bartlett.test(e~interaction(treatment,genotype), data=parametersFragGPE)
bartlett.test(e~treatment, data=parametersFragGPE)
bartlett.test(e~genotype, data=parametersFragGPE)
#0.003689*
leveneTest(e~treatment, data=parametersFragGPE)
leveneTest(e~genotype, data=parametersFragGPE)
leveneTest(e ~ treatment*genotype, data = parametersFragGPE)
fligner.test(e~treatment, data=parametersFragGPE)
fligner.test(e~genotype, data=parametersFragGPE)
#0.02462*
#Logged data
parametersFragGPE$loge<-log(parametersFragGPE$e+1)

##Checking logged transformed portein data
ggdensity(parametersFragGPE$loge, 
          main = "Density plot of E",
          xlab = "E")
#SKEWED
ggqqplot(parametersFragGPE$loge)
shapiro.test(parametersFragGPE$loge)
#2.028e-9**
bartlett.test(loge~interaction(treatment,genotype), data=parametersFragGPE)
#7.002e-5*
bartlett.test(loge~treatment, data=parametersFragGPE)
#7.849e-6*
bartlett.test(loge~genotype, data=parametersFragGPE)
#6.939e-8*
leveneTest(loge~treatment, data=parametersFragGPE)
leveneTest(loge~genotype, data=parametersFragGPE)
leveneTest(loge ~ treatment*genotype, data = parametersFragGPE)
fligner.test(loge~treatment, data=parametersFragGPE)
fligner.test(loge~genotype, data=parametersFragGPE)
#0.01496*
# Not normal (failed Shapiro test) Variance not homogenous (Bartlett/Fligner)
#Kruskal Wallis kruskal.test: Nonparametric test of medians
# Non-parameteric testing
```


Nonparametric test E GP
NSD

```{r}
parametersFragGPE %>% 
  group_by(genotype,treatment) %>%
  get_summary_stats(e, type = "common")

res.kruskal <- parametersFragGPE %>% kruskal_test(e ~ treatment)
res.kruskal
#stat 2.03 df 3 pvalue= 0.566
res.kruskal2 <- parametersFragGPE %>% kruskal_test(e ~ genotype)
res.kruskal2
# stat 1.26  df 2 p-value 0.532
#EFFECT SIZE
parametersFragGPE %>% kruskal_effsize(e ~ treatment)
# -0.0248-- small
parametersFragGPE %>% kruskal_effsize(e ~ genotype)
# -0.0184 -- small
# Pairwise comparisons
pwcCP <- parametersFragGPE %>% 
  dunn_test(e ~ treatment, p.adjust.method = "bonferroni") 
pwcCP
#NA no differences between treatments
pwcCPg <- parametersFragGPE %>% 
  dunn_test(e ~ genotype, p.adjust.method = "bonferroni") 
pwcCPg
#NA no differences between genotypes
pwcCP <- pwcCP %>% add_xy_position(x = "treatment")
pwcCPg <- pwcCPg %>% add_xy_position(x = "genotype")

mod<-lm(e~treatment*genotype,parametersFragGPE)

effects::allEffects(mod)
summary(mod)
#F 0.8406 df 31 p-value- 0.603
parametersFragGPE$cat <- paste(parametersFragGPE$treatment,parametersFragGPE$genotype)

res.kruskalD <- parametersFragGPE %>% kruskal_test(e ~ cat)
res.kruskalD
# stat 6.87 df 11 p-value 0.809
#EFFECT SIZE
parametersFragGPE %>% kruskal_effsize(e ~ cat)
# -0.133 - moderate
dunn.test(parametersFragGPE$e, parametersFragGPE$cat, method="bh")
#Chi^2= 6.8716 df= 11 p-value= 0.81
pwcD <- parametersFragGPE %>% 
  dunn_test(e ~ cat, p.adjust.method = "bonferroni") 
pwcD
pwcD <- pwcD %>% add_xy_position(x = "cat")
#NS
treaEGPP<-ggboxplot(parametersFragGPE, x = "treatment", y = "e", color= "black", fill="treatment", outlier.shape = 1) +
  stat_boxplot(geom='errorbar', linetype=1, width=0.5)+  #whiskers
  ylab('Energy (eV)')+
  xlab('Treatment')+
  ggtitle('E GP')+
  scale_fill_manual(values = c('#66CCFF','#FFFF00', '#FF00CC', '#66FF33'))+
  stat_summary(fun.y=mean, geom="point", size=2)+ #line is median, and closed circle is mean
  scale_x_discrete(breaks=c("T1", "T2", "T3", "TC"),
        labels=c("Sprinkler", "Feeding", "Interactive","Control"))+
   stat_pvalue_manual(pwcCP, hide.ns = TRUE) +
  labs(
    subtitle = get_test_label(res.kruskal, detailed = TRUE),
    caption = get_pwc_label(pwcCP)
    )
treaEGPP
ggexport(treaEGPP, filename = "EKWplottrea.pdf")

genoEGPP<-ggboxplot(parametersFragGPE, x = "genotype", y = "e", color= "black", fill="genotype", outlier.shape = 1) +
  stat_boxplot(geom='errorbar', linetype=1, width=0.5)+  #whiskers
  ylab('Energy (eV)')+
  xlab('Genotype')+
  ggtitle('E GP')+
  scale_fill_manual(values = c('red','green4', 'blue'))+
  stat_summary(fun.y=mean, geom="point", size=2)+ #line is median, and closed circle is mean
   stat_pvalue_manual(pwcCPg, hide.ns = TRUE) +
  labs(
    subtitle = get_test_label(res.kruskal2, detailed = TRUE),
    caption = get_pwc_label(pwcCPg)
    )
genoEGPP
ggexport(genoEGPP, filename = "EKWplotgeno.pdf")


inteEGPPP<-ggboxplot(parametersFragGPE, x = "cat", y = "e", color= "black", fill="genotype", outlier.shape = 1) +
  stat_boxplot(geom='errorbar', linetype=1, width=0.5)+  #whiskers
  ylab('Energy (eV)')+
  xlab('')+
  ggtitle('E GP')+
  scale_fill_manual(values = c('red','green4', 'blue'))+
  stat_summary(fun.y=mean, geom="point", size=2)+ #line is median, and closed circle is mean
   stat_pvalue_manual(pwcD, hide.ns = TRUE)+
  labs(
    subtitle = get_test_label(res.kruskalD, detailed = TRUE),
    caption = get_pwc_label(pwcD)
    )
inteEGPPP
ggexport(inteEGPPP, filename = "EKWplot.interer.pdf")

ggboxplot(parametersFragGPE, x = "treatment", y = "e", color= "black", fill="genotype", outlier.shape = 1) +
  ylab('Energy (eV)')+
  xlab('Treatment')+
  scale_fill_manual(values = c('red','green4', 'blue'))+
  stat_summary(fun.y=mean, geom="point", size=2)+
  scale_x_discrete(breaks=c("T1", "T2", "T3", "TC"),
        labels=c("Sprinkler", "Feeding", "Interactive","Control"))

ggboxplot(parametersFragGPE, x = "genotype", y = "e", color= "black", fill="treatment", outlier.shape = 1) +
  ylab('Energy (eV)')+
  xlab('Genotype')+
  scale_fill_manual(values = c('#66CCFF','#FFFF00', '#FF00CC', '#66FF33'))
```

parametersFragGREh 
Parameter Comparisons- Eh R
parametersFragGREho

```{r}
parametersFragGREh

##Checking non logged transformed portein data
ggdensity(parametersFragGREh$eh, 
          main = "Density plot of Eh",
          xlab = "Eh")
#SKEWED
ggqqplot(parametersFragGREh$eh)
#outlier? R	M601c [11]
mPGPsp<-lm(eh~genotype*treatment,parametersFragGREh)
summary(mPGPsp)
mPGPsp2<-aov(eh~genotype*treatment,parametersFragGREh)
summary(mPGPsp2)
anova(mPGPsp)
## check for outliers
cooksd <- cooks.distance(mPGPsp)
plot(cooksd, pch=".", cex=2, main="Influential Obs by Cooks distance")  # plot cook's distance
abline(h = 4*mean(cooksd, na.rm=TRUE), col="red")  # add cutoff line--In general use, those observations that have a cook’s distance greater than 4 times the mean may be classified as influential. This is not a hard boundary.
text(x=1:length(cooksd)+1, y=cooksd, labels=ifelse(cooksd>4*mean(cooksd, na.rm=TRUE),names(cooksd),""), cex=0.6, pos=2, col="red")
#Remove R	M601c 3.00 [11]
parametersFragGREho<-parametersFragGREh%>%
  filter(fragmentI!="M601c")

ggqqplot(parametersFragGREho$eh)
shapiro.test(parametersFragGREho$eh)
#0.6252
#Normal data
bartlett.test(eh~interaction(treatment,genotype), data=parametersFragGREho)
bartlett.test(eh~treatment, data=parametersFragGREho)
bartlett.test(eh~genotype, data=parametersFragGREho)
leveneTest(eh~treatment, data=parametersFragGREho)
leveneTest(eh~genotype, data=parametersFragGREho)
leveneTest(eh ~ treatment*genotype, data = parametersFragGREho)
fligner.test(eh~treatment, data=parametersFragGREho)
fligner.test(eh~genotype, data=parametersFragGREho)
# Normal data and Homogenous variance 
```

Parametric test Eh R
passed shapiro/Bartlett/Levene/Flinger
SD genotype M5-K2 

```{r}
parametersFragGREho %>% 
  group_by(genotype,treatment) %>%
  get_summary_stats(eh, type = "common")

# Proceed with ANOVA/lm post hoc Tukeys HSD
ehrmod<-aov(eh~genotype*treatment,parametersFragGREho)
summary(ehrmod)
#NSD

#Post hoc Pairwise
pairwise.t.test(parametersFragGREho$eh, parametersFragGREho$treatment,
                p.adjust.method = "BH")
#NS
pairwise.t.test(parametersFragGREho$eh, parametersFragGREho$genotype,
                p.adjust.method = "BH")
#M5-K2 0.043
parametersFragGREho$cat <- paste(parametersFragGREho$treatment,parametersFragGREho$genotype)

pairwise.t.test(parametersFragGREho$eh, parametersFragGREho$cat,
                p.adjust.method = "BH")
#NS
TukeyHSD(ehrmod)
#NS

ehrtrSSt = summarySE(parametersFragGREho, measurevar="eh",
                     groupvars=c("treatment"))

ehrtrSSt
ehrgrSSt = summarySE(parametersFragGREho, measurevar="eh",
                     groupvars=c("genotype"))

ehrgrSSt
ehrirSSt = summarySE(parametersFragGREho, measurevar="eh",
                     groupvars=c("cat"))

ehrirSSt
 
ehrtbar<-ggplot(ehrtrSSt, aes(x=factor(treatment), y=eh, fill=treatment)) + 
    geom_bar(stat="identity", width=0.8) +
    geom_errorbar(aes(ymin=eh-se, ymax=eh+se),
                  width=.2) +
    xlab("Treatment") +
  ylab('Energy (eV)') +
  ggtitle('Eh R')+
   theme_classic()+
    scale_x_discrete(breaks=c("T1", "T2", "T3", "TC"),
        labels=c("Sprinkler", "Feeding", "Interactive","Control"))+
  scale_fill_manual(values = c('#66CCFF','#FFFF00', '#FF00CC', '#66FF33'))
 ehrtbar
  
ehrImod<-lm(eh~genotype*treatment,parametersFragGREho)
summary(ehrImod)
#F- 1.386, DF- 29 p-value 0.2315
ehrtmod<-aov(eh~treatment,parametersFragGREho)
summary(ehrtmod)
TukeyHSD(ehrtmod)
ehrgmod<-aov(eh~genotype,parametersFragGREho)
summary(ehrgmod)
#genotype 0.0477*
TukeyHSD(ehrgmod)
#M5-K2 0.0371
ehrtmodl<-lm(eh~treatment,parametersFragGREho)
summary(ehrtmodl)
#F- 0.3451, DF- 37 p-value 0.7929
ehrgmodl<-lm(eh~genotype,parametersFragGREho)
summary(ehrgmodl)
#F- 3.301, DF- 38 p-value 0.04765

ehrImodP<-ggplot(ehrImod, aes(x=treatment, eh, fill= genotype))+
  stat_boxplot(geom= "errorbar", width= 0.5, position = position_dodge(1))+
  geom_boxplot(position = position_dodge(1),outlier.shape=1)+
  theme_classic()+
  xlab('Treatment')+
  ylab('Energy (eV)') +
  ggtitle("Eh R")+
  stat_compare_means(label.y=2,method = "anova")+
  scale_fill_manual(values = c('red','green4', 'blue'))+
  scale_x_discrete(breaks=c("T1", "T2", "T3", "TC"),
        labels=c("Sprinkler", "Feeding", "Interactive","Control"))
ehrImodP

ggexport(ehrImodP, filename = "ehrANOplotinter.pdf")


ehrgmodP<-ggplot(ehrmod, aes(x=genotype, eh, fill= genotype))+
  stat_boxplot(geom= "errorbar", width= 0.5, position = position_dodge(1))+
  geom_boxplot(position = position_dodge(1),outlier.shape=1)+
  theme_classic()+
  xlab('Genotype')+
  ylab('Energy (eV)') +
  ggtitle("Eh R")+
    stat_summary(fun.y=mean, geom="point", size=2)+ #line is median, and closed circle is mean
  stat_compare_means(label.y=3, method = "anova")+
  scale_fill_manual(values = c('red','green4', 'blue'))

ehrgmodP
ggexport(ehrgmodP, filename = "ehrANOplotgeno.pdf")

ehrtmodP<-ggplot(ehrtmod, aes(x=treatment, eh, fill= treatment))+
  stat_boxplot(geom= "errorbar", width= 0.5, position = position_dodge(1))+
  geom_boxplot(position = position_dodge(1),outlier.shape=1)+
  theme_classic()+
  xlab('Treatment')+
  ylab('Energy (eV)') +
  ggtitle("Eh R")+
      stat_summary(fun.y=mean, geom="point", size=2)+ #line is median, and closed circle is mean
  stat_compare_means(label.y=3, method = "anova")+
  scale_fill_manual(values = c('#66CCFF','#FFFF00', '#FF00CC', '#66FF33'))+
  scale_x_discrete(breaks=c("T1", "T2", "T3", "TC"),
        labels=c("Sprinkler", "Feeding", "Interactive","Control"))

ehrtmodP
ggexport(ehrtmodP, filename = "ehrANOplottrea.pdf")
```

parametersFragGPEh 
Parameter Comparisons- Eh GP

```{r}
parametersFragGPEh

##Checking non logged transformed portein data
ggdensity(parametersFragGPEh$eh, 
          main = "Density plot of Eh",
          xlab = "Eh")
#SKEWED
ggqqplot(parametersFragGPEh$eh)
shapiro.test(parametersFragGPEh$eh)
#0.1221
#Normal data
bartlett.test(eh~interaction(treatment,genotype), data=parametersFragGPEh)
bartlett.test(eh~treatment, data=parametersFragGPEh)
bartlett.test(eh~genotype, data=parametersFragGPEh)
leveneTest(eh~treatment, data=parametersFragGPEh)
leveneTest(eh~genotype, data=parametersFragGPEh)
leveneTest(eh ~ treatment*genotype, data = parametersFragGPEh)
fligner.test(eh~treatment, data=parametersFragGPEh)
fligner.test(eh~genotype, data=parametersFragGPEh)
# Normal data and Homogenous variance 
```

Parametric test Eh GP
passed shapiro/Bartlett/Levene/Flinger
NSD

```{r}
parametersFragGPEh %>% 
  group_by(genotype,treatment) %>%
  get_summary_stats(eh, type = "common")

# Proceed with ANOVA/lm post hoc Tukeys HSD
ehpmod<-aov(eh~genotype*treatment,parametersFragGPEh)
summary(ehpmod)
#NSD

#Post hoc Pairwise
pairwise.t.test(parametersFragGPEh$eh, parametersFragGPEh$treatment,
                p.adjust.method = "BH")
#NSD
pairwise.t.test(parametersFragGPEh$eh, parametersFragGPEh$genotype,
                p.adjust.method = "BH")
#NSD
parametersFragGPEh$cat <- paste(parametersFragGPEh$treatment,parametersFragGPEh$genotype)

pairwise.t.test(parametersFragGPEh$eh, parametersFragGPEh$cat,
                p.adjust.method = "BH")
#NS
TukeyHSD(ehpmod)
#NS

ehptrSSt = summarySE(parametersFragGPEh, measurevar="eh",
                     groupvars=c("treatment"))

ehptrSSt
ehpgrSSt = summarySE(parametersFragGPEh, measurevar="eh",
                     groupvars=c("genotype"))

ehpgrSSt
ehpirSSt = summarySE(parametersFragGPEh, measurevar="eh",
                     groupvars=c("cat"))

ehpirSSt
 
ehptbar<-ggplot(ehptrSSt, aes(x=factor(treatment), y=eh, fill=treatment)) + 
    geom_bar(stat="identity", width=0.8) +
    geom_errorbar(aes(ymin=eh-se, ymax=eh+se),
                  width=.2) +
    xlab("Treatment") +
  ylab('Energy (eV)') +
  ggtitle('Eh GP')+
   theme_classic()+
    scale_x_discrete(breaks=c("T1", "T2", "T3", "TC"),
        labels=c("Sprinkler", "Feeding", "Interactive","Control"))+
  scale_fill_manual(values = c('#66CCFF','#FFFF00', '#FF00CC', '#66FF33'))
 ehptbar

 ehpImod<-lm(eh~genotype*treatment,parametersFragGPEh)
summary(ehpImod)
#F- 0.6684, DF- 32 p-value 0.7658
ehptmod<-aov(eh~treatment,parametersFragGPEh)
summary(ehptmod)
TukeyHSD(ehptmod)
ehpgmod<-aov(eh~genotype,parametersFragGPEh)
summary(ehpgmod)
TukeyHSD(ehpgmod)
ehptmodl<-lm(eh~treatment,parametersFragGPEh)
summary(ehptmodl)
#F- 0.7478, DF- 40 p-value 0.53
ehpgmodl<-lm(eh~genotype,parametersFragGPEh)
summary(ehpgmodl)
#F- 1.767, DF- 41 p-value 0.1853

ehpImodP<-ggplot(ehpImod, aes(x=treatment, eh, fill= genotype))+
  stat_boxplot(geom= "errorbar", width= 0.5, position = position_dodge(1))+
  geom_boxplot(position = position_dodge(1),outlier.shape=1)+
  theme_classic()+
  xlab('Treatment')+
  ylab('Energy (eV)') +
  ggtitle("Eh GP")+
  stat_compare_means(label.y=6,method = "anova")+
  scale_fill_manual(values = c('red','green4', 'blue'))+
  scale_x_discrete(breaks=c("T1", "T2", "T3", "TC"),
        labels=c("Sprinkler", "Feeding", "Interactive","Control"))
ehpImodP

ggexport(ehpImodP, filename = "ehpANOplotinter.pdf")


ehpgmodP<-ggplot(ehpmod, aes(x=genotype, eh, fill= genotype))+
  stat_boxplot(geom= "errorbar", width= 0.5, position = position_dodge(1))+
  geom_boxplot(position = position_dodge(1),outlier.shape=1)+
  theme_classic()+
  xlab('Genotype')+
  ylab('Energy (eV)') +
  ggtitle("Eh GP")+
    stat_summary(fun.y=mean, geom="point", size=2)+ #line is median, and closed circle is mean
  stat_compare_means(label.y=6, method = "anova")+
  scale_fill_manual(values = c('red','green4', 'blue'))

ehpgmodP
ggexport(ehpgmodP, filename = "ehpANOplotgeno.pdf")

ehptmodP<-ggplot(ehptmod, aes(x=treatment, eh, fill= treatment))+
  stat_boxplot(geom= "errorbar", width= 0.5, position = position_dodge(1))+
  geom_boxplot(position = position_dodge(1),outlier.shape=1)+
  theme_classic()+
  xlab('Treatment')+
  ylab('Energy (eV)') +
  ggtitle("Eh GP")+
      stat_summary(fun.y=mean, geom="point", size=2)+ #line is median, and closed circle is mean
  stat_compare_means(label.y=6, method = "anova")+
  scale_fill_manual(values = c('#66CCFF','#FFFF00', '#FF00CC', '#66FF33'))+
  scale_x_discrete(breaks=c("T1", "T2", "T3", "TC"),
        labels=c("Sprinkler", "Feeding", "Interactive","Control"))

ehptmodP
ggexport(ehptmodP, filename = "ehpANOplottrea.pdf")
```

parametersFragGRq10 
Parameter comparisons- q10 R

```{r}
parametersFragGRq10

##Checking non logged transformed portein data
ggdensity(parametersFragGRq10$q10, 
          main = "Density plot of Q10",
          xlab = "Q10")
#SKEWED
ggqqplot(parametersFragGRq10$q10)
shapiro.test(parametersFragGRq10$q10)
#0.3995
#normal data
bartlett.test(q10~interaction(treatment,genotype), data=parametersFragGRq10)
# 0.02535*
bartlett.test(q10~treatment, data=parametersFragGRq10)
bartlett.test(q10~genotype, data=parametersFragGRq10)
leveneTest(q10~treatment, data=parametersFragGRq10)
leveneTest(q10~genotype, data=parametersFragGRq10)
leveneTest(q10 ~ treatment*genotype, data = parametersFragGRq10)
fligner.test(q10~treatment, data=parametersFragGRq10)
fligner.test(q10~genotype, data=parametersFragGRq10)
# Non Normal data and failed bartlett
#Log parameter
parametersFragGRq10$logq10<-log(parametersFragGRq10$q10+1)

##Checking non logged transformed portein data
ggdensity(parametersFragGRq10$logq10, 
          main = "Density plot of Q10",
          xlab = " Q10")
#SKEWED
ggqqplot(parametersFragGRq10$logq10)
shapiro.test(parametersFragGRq10$logq10)
#0.8126
bartlett.test(logq10~interaction(treatment,genotype), data=parametersFragGRq10)
#0.04487*
bartlett.test(logq10~treatment, data=parametersFragGRq10)
bartlett.test(logq10~genotype, data=parametersFragGRq10)
leveneTest(logq10~treatment, data=parametersFragGRq10)
leveneTest(logq10~genotype, data=parametersFragGRq10)
leveneTest(logq10 ~ treatment*genotype, data = parametersFragGRq10)
fligner.test(logq10~treatment, data=parametersFragGRq10)
fligner.test(logq10~genotype, data=parametersFragGRq10)
#normal distribution not equal variance (Bartlett )
##logit
parametersFragGRq10$logitq10<-car::logit(parametersFragGRq10$q10)

###Checking non logged transformed portein data
ggdensity(parametersFragGRq10$logitq10,na.rm = TRUE, 
          main = "Density plot of Q10",
          xlab = "Q10")
#SKEWED
ggqqplot(parametersFragGRq10$logitq10,na.rm = TRUE)
shapiro.test(parametersFragGRq10$logitq10)
# 0.7025
bartlett.test(logitq10~interaction(treatment,genotype), data=parametersFragGRq10)
#0.04493*
bartlett.test(logitq10~treatment, data=parametersFragGRq10)
bartlett.test(logitq10~genotype, data=parametersFragGRq10)
leveneTest(logitq10~treatment, data=parametersFragGRq10)
leveneTest(logitq10~genotype, data=parametersFragGRq10)
leveneTest(logitq10 ~ treatment*genotype, data = parametersFragGRq10)
fligner.test(logitq10~treatment, data=parametersFragGRq10)
fligner.test(logitq10~genotype, data=parametersFragGRq10)
#normally distributed data- Variance didn't pass bartlett test
```

Nonparametric test q10 R
SD genotype M5	M6 0.02427617

```{r}
parametersFragGRq10 %>% 
  group_by(genotype,treatment) %>%
  get_summary_stats(q10, type = "common")

res.kruskal <- parametersFragGRq10 %>% kruskal_test(q10 ~ treatment)
res.kruskal
#stat 2.20 df 3 pvalue= 0.531
res.kruskal2 <- parametersFragGRq10 %>% kruskal_test(q10 ~ genotype)
res.kruskal2
# stat 7,17  df 2 p-value 0.0278*
#EFFECT SIZE
parametersFragGRq10 %>% kruskal_effsize(q10 ~ treatment)
# -0.0199-- small
parametersFragGRq10 %>% kruskal_effsize(q10 ~ genotype)
# 0.126 -- moderate
# Pairwise comparisons
pwcCP <- parametersFragGRq10 %>% 
  dunn_test(q10 ~ treatment, p.adjust.method = "bonferroni") 
pwcCP
#NA no differences between treatments
pwcCPg <- parametersFragGRq10 %>% 
  dunn_test(q10 ~ genotype, p.adjust.method = "bonferroni") 
pwcCPg
#M5	M6 0.02427617
pwcCP <- pwcCP %>% add_xy_position(x = "treatment")
pwcCPg <- pwcCPg %>% add_xy_position(x = "genotype")

mod<-lm(q10~treatment*genotype,parametersFragGRq10)

effects::allEffects(mod)
summary(mod)
#F 2.068 df 32 p-value- 0.0539
parametersFragGRq10$cat <- paste(parametersFragGRq10$treatment,parametersFragGRq10$genotype)

res.kruskalD <- parametersFragGRq10 %>% kruskal_test(q10 ~ cat)
res.kruskalD
# stat 20.6 df 11 p-value 0.0381*
#EFFECT SIZE
parametersFragGRq10 %>% kruskal_effsize(q10 ~ cat)
# 0.299 -large
dunn.test(parametersFragGRq10$q10, parametersFragGRq10$cat, method="bh")
#Chi^2= 20.5702 df= 11 p-value= 0.04*
pwcD <- parametersFragGRq10 %>% 
  dunn_test(q10 ~ cat, p.adjust.method = "bonferroni") 
pwcD
pwcD <- pwcD %>% add_xy_position(x = "cat")
#NA no difference
treaq10GRP<-ggboxplot(parametersFragGRq10, x = "treatment", y = "q10", color= "black", fill="treatment", outlier.shape = 1) +
  stat_boxplot(geom='errorbar', linetype=1, width=0.5)+  #whiskers
  ylab('Q10')+
  xlab('Treatment')+
  ggtitle('Q10 R')+
  scale_fill_manual(values = c('#66CCFF','#FFFF00', '#FF00CC', '#66FF33'))+
  stat_summary(fun.y=mean, geom="point", size=2)+ #line is median, and closed circle is mean
  scale_x_discrete(breaks=c("T1", "T2", "T3", "TC"),
        labels=c("Sprinkler", "Feeding", "Interactive","Control"))+
   stat_pvalue_manual(pwcCP, hide.ns = TRUE) +
  labs(
    subtitle = get_test_label(res.kruskal, detailed = TRUE),
    caption = get_pwc_label(pwcCP)
    )
treaq10GRP
ggexport(treaq10GRP, filename = "Q10RKWplottrea.pdf")

genoQ10GRP<-ggboxplot(parametersFragGRq10, x = "genotype", y = "q10", color= "black", fill="genotype", outlier.shape = 1) +
  stat_boxplot(geom='errorbar', linetype=1, width=0.5)+  #whiskers
  ylab('Q10')+
  xlab('Genotype')+
  ggtitle('Q10 R')+
  scale_fill_manual(values = c('red','green4', 'blue'))+
  stat_summary(fun.y=mean, geom="point", size=2)+ #line is median, and closed circle is mean
   stat_pvalue_manual(pwcCPg, hide.ns = TRUE)+
  labs(
    subtitle = get_test_label(res.kruskal2, detailed = TRUE),
    caption = get_pwc_label(pwcCPg)
    )
genoQ10GRP
ggexport(genoQ10GRP, filename = "Q10RKWplotgeno.pdf")


Q10GRP<-ggboxplot(parametersFragGRq10, x = "cat", y = "q10", color= "black", fill="genotype", outlier.shape = 1) +
  stat_boxplot(geom='errorbar', linetype=1, width=0.5)+  #whiskers
  ylab('Q10')+
  xlab('')+
  ggtitle('Q10 R')+
  scale_fill_manual(values = c('red','green4', 'blue'))+
  stat_summary(fun.y=mean, geom="point", size=2)+ #line is median, and closed circle is mean
   stat_pvalue_manual(pwcD, hide.ns = TRUE)+
  labs(
    subtitle = get_test_label(res.kruskalD, detailed = TRUE),
    caption = get_pwc_label(pwcD)
    )
Q10GRP
ggexport(Q10GRP, filename = "Q10RKWplot.interer.pdf")

ggboxplot(parametersFragGRq10, x = "treatment", y = "q10", color= "black", fill="genotype", outlier.shape = 1) +
  ylab('Q10')+
  xlab('Treatment')+
  scale_fill_manual(values = c('red','green4', 'blue'))+
  stat_summary(fun.y=mean, geom="point", size=2)+
  scale_x_discrete(breaks=c("T1", "T2", "T3", "TC"),
        labels=c("Sprinkler", "Feeding", "Interactive","Control"))

ggboxplot(parametersFragGRq10, x = "genotype", y = "q10", color= "black", fill="treatment", outlier.shape = 1) +
  ylab('Q10')+
  xlab('Genotype')+
  scale_fill_manual(values = c('#66CCFF','#FFFF00', '#FF00CC', '#66FF33'))
```

parametersFragGPq10 
Parameter Comparisons- Q10 GP

```{r}
  parametersFragGPq10

##Checking non logged transformed portein data
ggdensity(parametersFragGPq10$eh, 
          main = "Density plot of Eh",
          xlab = "Eh")
#SKEWED
ggqqplot(parametersFragGPq10$eh)
shapiro.test(parametersFragGPq10$eh)
#0.251
#Normal data
bartlett.test(eh~interaction(treatment,genotype), data=parametersFragGPq10)
bartlett.test(eh~treatment, data=parametersFragGPq10)
bartlett.test(eh~genotype, data=parametersFragGPq10)
leveneTest(eh~treatment, data=parametersFragGPq10)
leveneTest(eh~genotype, data=parametersFragGPq10)
leveneTest(eh ~ treatment*genotype, data = parametersFragGPq10)
fligner.test(eh~treatment, data=parametersFragGPq10)
fligner.test(eh~genotype, data=parametersFragGPq10)
# Normal data and equal variance 
```

Parametric test Q10 GP
passed shapiro/Bartlett/Levene/Flinger
NSD

```{r}
parametersFragGPq10 %>% 
  group_by(genotype,treatment) %>%
  get_summary_stats(q10, type = "common")

# Proceed with ANOVA/lm post hoc Tukeys HSD
q10pmod<-aov(q10~genotype*treatment,parametersFragGPq10)
summary(q10pmod)
#NSD

#Post hoc Pairwise
pairwise.t.test(parametersFragGPq10$q10, parametersFragGPq10$treatment,
                p.adjust.method = "BH")
#NSD
pairwise.t.test(parametersFragGPq10$q10, parametersFragGPq10$genotype,
                p.adjust.method = "BH")
#NSD
parametersFragGPq10$cat <- paste(parametersFragGPq10$treatment,parametersFragGPq10$genotype)

pairwise.t.test(parametersFragGPq10$q10, parametersFragGPq10$cat,
                p.adjust.method = "BH")
#NS
TukeyHSD(q10pmod)
#NS

q10ptrSSt = summarySE(parametersFragGPq10, measurevar="q10",
                     groupvars=c("treatment"))

q10ptrSSt
q10pgrSSt = summarySE(parametersFragGPq10, measurevar="q10",
                     groupvars=c("genotype"))

q10pgrSSt
q10pirSSt = summarySE(parametersFragGPq10, measurevar="q10",
                     groupvars=c("cat"))

q10pirSSt
 
q10ptbar<-ggplot(q10ptrSSt, aes(x=factor(treatment), y=q10, fill=treatment)) + 
    geom_bar(stat="identity", width=0.8) +
    geom_errorbar(aes(ymin=q10-se, ymax=q10+se),
                  width=.2) +
    xlab("Treatment") +
  ylab('Q10') +
  ggtitle('Q10 GP')+
   theme_classic()+
    scale_x_discrete(breaks=c("T1", "T2", "T3", "TC"),
        labels=c("Sprinkler", "Feeding", "Interactive","Control"))+
  scale_fill_manual(values = c('#66CCFF','#FFFF00', '#FF00CC', '#66FF33'))
 q10ptbar

 q10pImod<-lm(q10~genotype*treatment,parametersFragGPq10)
summary(q10pImod)
#F- 0.5264, DF- 28 p-value 0.8688
q10ptmod<-aov(q10~treatment,parametersFragGPq10)
summary(q10ptmod)
TukeyHSD(q10ptmod)
q10pgmod<-aov(q10~genotype,parametersFragGPq10)
summary(q10pgmod)
TukeyHSD(q10pgmod)
q10ptmodl<-lm(q10~treatment,parametersFragGPq10)
summary(q10ptmodl)
#F- 0.8837, DF- 36 p-value 0.4587
q10pgmodl<-lm(q10~genotype,parametersFragGPq10)
summary(q10pgmodl)
#F- 0.5474, DF- 37 p-value 0.5831

q10pImodP<-ggplot(q10pImod, aes(x=treatment, q10, fill= genotype))+
  stat_boxplot(geom= "errorbar", width= 0.5, position = position_dodge(1))+
  geom_boxplot(position = position_dodge(1),outlier.shape=1)+
  theme_classic()+
  xlab('Treatment')+
  ylab('Q10') +
  ggtitle("Q10 GP")+
  stat_compare_means(label.y=6,method = "anova")+
  scale_fill_manual(values = c('red','green4', 'blue'))+
  scale_x_discrete(breaks=c("T1", "T2", "T3", "TC"),
        labels=c("Sprinkler", "Feeding", "Interactive","Control"))
q10pImodP

ggexport(q10pImodP, filename = "q10pANOplotinter.pdf")


q10pgmodP<-ggplot(q10pmod, aes(x=genotype, q10, fill= genotype))+
  stat_boxplot(geom= "errorbar", width= 0.5, position = position_dodge(1))+
  geom_boxplot(position = position_dodge(1),outlier.shape=1)+
  theme_classic()+
  xlab('Genotype')+
  ylab('Q10') +
  ggtitle("Q10 GP")+
    stat_summary(fun.y=mean, geom="point", size=2)+ #line is median, and closed circle is mean
  stat_compare_means(label.y=6, method = "anova")+
  scale_fill_manual(values = c('red','green4', 'blue'))

q10pgmodP
ggexport(q10pgmodP, filename = "q10pANOplotgeno.pdf")

q10ptmodP<-ggplot(q10ptmod, aes(x=treatment, q10, fill= treatment))+
  stat_boxplot(geom= "errorbar", width= 0.5, position = position_dodge(1))+
  geom_boxplot(position = position_dodge(1),outlier.shape=1)+
  theme_classic()+
  xlab('Treatment')+
  ylab('Q10') +
  ggtitle("Q10 GP")+
      stat_summary(fun.y=mean, geom="point", size=2)+ #line is median, and closed circle is mean
  stat_compare_means(label.y=6, method = "anova")+
  scale_fill_manual(values = c('#66CCFF','#FFFF00', '#FF00CC', '#66FF33'))+
  scale_x_discrete(breaks=c("T1", "T2", "T3", "TC"),
        labels=c("Sprinkler", "Feeding", "Interactive","Control"))

q10ptmodP
ggexport(q10ptmodP, filename = "q10pANOplottrea.pdf")
```

parametersFragGRTSM R
Parameter comparisons- TSM R

```{r}
parametersFragGRTSM

##Checking non logged transformed portein data
ggdensity(parametersFragGRTSM$thermal_safety_margin, 
          main = "Density plot of Thermal Safety Margin",
          xlab = "Thermal Safety Margin")
#SKEWED
ggqqplot(parametersFragGRTSM$thermal_safety_margin)
shapiro.test(parametersFragGRTSM$thermal_safety_margin)
#1.406e-7*
#not normal data
bartlett.test(thermal_safety_margin~interaction(treatment,genotype), data=parametersFragGRTSM)
# 0.0003848*
bartlett.test(thermal_safety_margin~treatment, data=parametersFragGRTSM)
#0.004475*
bartlett.test(thermal_safety_margin~genotype, data=parametersFragGRTSM)
#0.0308*
leveneTest(thermal_safety_margin~treatment, data=parametersFragGRTSM)
leveneTest(thermal_safety_margin~genotype, data=parametersFragGRTSM)
leveneTest(thermal_safety_margin ~ treatment*genotype, data = parametersFragGRTSM)
fligner.test(thermal_safety_margin~treatment, data=parametersFragGRTSM)
fligner.test(thermal_safety_margin~genotype, data=parametersFragGRTSM)
# Non Normal data and failed bartlett
#Log parameter
parametersFragGRTSM$logthermal_safety_margin<-log(parametersFragGRTSM$thermal_safety_margin+1)

##Checking non logged transformed portein data
ggdensity(parametersFragGRTSM$logthermal_safety_margin, 
          main = "Density plot of Thermal Safety Margin",
          xlab = " Thermal Safety Margin")
#SKEWED
ggqqplot(parametersFragGRTSM$logthermal_safety_margin)
shapiro.test(parametersFragGRTSM$logthermal_safety_margin)
#0.01265*
bartlett.test(logthermal_safety_margin~interaction(treatment,genotype), data=parametersFragGRTSM)
bartlett.test(logthermal_safety_margin~treatment, data=parametersFragGRTSM)
bartlett.test(logthermal_safety_margin~genotype, data=parametersFragGRTSM)
leveneTest(logthermal_safety_margin~treatment, data=parametersFragGRTSM)
leveneTest(logthermal_safety_margin~genotype, data=parametersFragGRTSM)
leveneTest(logthermal_safety_margin ~ treatment*genotype, data = parametersFragGRTSM)
fligner.test(logthermal_safety_margin~treatment, data=parametersFragGRTSM)
fligner.test(logthermal_safety_margin~genotype, data=parametersFragGRTSM)
#Non- normal distribution with homogeneity of variance 
##logit
parametersFragGRTSM$logitthermal_safety_margin<-car::logit(parametersFragGRTSM$thermal_safety_margin)

###Checking non logged transformed portein data
ggdensity(parametersFragGRTSM$logitthermal_safety_margin,na.rm = TRUE, 
          main = "Density plot of Thermal Safety Margin",
          xlab = "Thermal Safety Margin")
#SKEWED
ggqqplot(parametersFragGRTSM$logitthermal_safety_margin,na.rm = TRUE)
shapiro.test(parametersFragGRTSM$logitthermal_safety_margin)
# 0.002991*
bartlett.test(logitthermal_safety_margin~interaction(treatment,genotype), data=parametersFragGRTSM)
bartlett.test(logitthermal_safety_margin~treatment, data=parametersFragGRTSM)
bartlett.test(logitthermal_safety_margin~genotype, data=parametersFragGRTSM)
leveneTest(logitthermal_safety_margin~treatment, data=parametersFragGRTSM)
leveneTest(logitthermal_safety_margin~genotype, data=parametersFragGRTSM)
leveneTest(logitthermal_safety_margin ~ treatment*genotype, data = parametersFragGRTSM)
fligner.test(logitthermal_safety_margin~treatment, data=parametersFragGRTSM)
fligner.test(logitthermal_safety_margin~genotype, data=parametersFragGRTSM)
#Nonnormally distributed data- Variance equal test Non-parametric test 
```

Nonparametric test TSM R
NSD

```{r}
parametersFragGRTSM %>% 
  group_by(genotype,treatment) %>%
  get_summary_stats(thermal_safety_margin, type = "common")

res.kruskal <- parametersFragGRTSM %>% kruskal_test(thermal_safety_margin ~ treatment)
res.kruskal
#stat 0.228 df 3 pvalue= 0.9373
res.kruskal2 <- parametersFragGRTSM %>% kruskal_test(thermal_safety_margin ~ genotype)
res.kruskal2
# stat 2.24  df 2 p-value 0.326
#EFFECT SIZE
parametersFragGRTSM %>% kruskal_effsize(thermal_safety_margin ~ treatment)
# -0.0729-- moderate
parametersFragGRTSM %>% kruskal_effsize(thermal_safety_margin ~ genotype)
# 0.00618 -- small
# Pairwise comparisons
pwcCP <- parametersFragGRTSM %>% 
  dunn_test(thermal_safety_margin ~ treatment, p.adjust.method = "bonferroni") 
pwcCP
#NA no differences between treatments
pwcCPg <- parametersFragGRTSM %>% 
  dunn_test(thermal_safety_margin ~ genotype, p.adjust.method = "bonferroni") 
pwcCPg
#NA no differences between genotypes
pwcCP <- pwcCP %>% add_xy_position(x = "treatment")
pwcCPg <- pwcCPg %>% add_xy_position(x = "genotype")

mod<-lm(thermal_safety_margin~treatment*genotype,parametersFragGRTSM)

effects::allEffects(mod)
summary(mod)
#F 1.433 df 30 p-value- 0.2093
parametersFragGRTSM$cat <- paste(parametersFragGRTSM$treatment,parametersFragGRTSM$genotype)

res.kruskalD <- parametersFragGRTSM %>% kruskal_test(thermal_safety_margin ~ cat)
res.kruskalD
# stat 15.8 df 11 p-value 0.149
#EFFECT SIZE
parametersFragGRTSM %>% kruskal_effsize(thermal_safety_margin ~ cat)
# 0.160 -large
dunn.test(parametersFragGRTSM$thermal_safety_margin, parametersFragGRTSM$cat, method="bh")
#Chi^2= 15.804 df= 11 p-value= 0.15
pwcD <- parametersFragGRTSM %>% 
  dunn_test(thermal_safety_margin ~ cat, p.adjust.method = "bonferroni") 
pwcD
pwcD <- pwcD %>% add_xy_position(x = "cat")
#NA no difference
treathermal_safety_marginGRP<-ggboxplot(parametersFragGRTSM, x = "treatment", y = "thermal_safety_margin", color= "black", fill="treatment", outlier.shape = 1) +
  stat_boxplot(geom='errorbar', linetype=1, width=0.5)+  #whiskers
  ylab('TSM')+
  xlab('Treatment')+
  ggtitle('TSM R')+
  scale_fill_manual(values = c('#66CCFF','#FFFF00', '#FF00CC', '#66FF33'))+
  stat_summary(fun.y=mean, geom="point", size=2)+ #line is median, and closed circle is mean
  scale_x_discrete(breaks=c("T1", "T2", "T3", "TC"),
        labels=c("Sprinkler", "Feeding", "Interactive","Control"))+
   stat_pvalue_manual(pwcCP, hide.ns = TRUE) +
  labs(
    subtitle = get_test_label(res.kruskal, detailed = TRUE),
    caption = get_pwc_label(pwcCP)
    )
treathermal_safety_marginGRP
ggexport(treathermal_safety_marginGRP, filename = "TSMRKWplottrea.pdf")

genoTSMGRP<-ggboxplot(parametersFragGRTSM, x = "genotype", y = "thermal_safety_margin", color= "black", fill="genotype", outlier.shape = 1) +
  stat_boxplot(geom='errorbar', linetype=1, width=0.5)+  #whiskers
  ylab('TSM')+
  xlab('Genotype')+
  ggtitle('TSM R')+
  scale_fill_manual(values = c('red','green4', 'blue'))+
  stat_summary(fun.y=mean, geom="point", size=2)+ #line is median, and closed circle is mean
   stat_pvalue_manual(pwcCPg, hide.ns = TRUE)+
  labs(
    subtitle = get_test_label(res.kruskal2, detailed = TRUE),
    caption = get_pwc_label(pwcCPg)
    )
genoTSMGRP
ggexport(genoTSMGRP, filename = "TSMRKWplotgeno.pdf")


TSMGRP<-ggboxplot(parametersFragGRTSM, x = "cat", y = "thermal_safety_margin", color= "black", fill="genotype", outlier.shape = 1) +
  stat_boxplot(geom='errorbar', linetype=1, width=0.5)+  #whiskers
  ylab('TSM')+
  xlab('')+
  ggtitle('TSM R')+
  scale_fill_manual(values = c('red','green4', 'blue'))+
  stat_summary(fun.y=mean, geom="point", size=2)+ #line is median, and closed circle is mean
   stat_pvalue_manual(pwcD, hide.ns = TRUE)+
  labs(
    subtitle = get_test_label(res.kruskalD, detailed = TRUE),
    caption = get_pwc_label(pwcD)
    )
TSMGRP
ggexport(TSMGRP, filename = "TSMRKWplot.interer.pdf")

ggboxplot(parametersFragGRTSM, x = "treatment", y = "thermal_safety_margin", color= "black", fill="genotype", outlier.shape = 1) +
  ylab('TSM')+
  xlab('Treatment')+
  scale_fill_manual(values = c('red','green4', 'blue'))+
  stat_summary(fun.y=mean, geom="point", size=2)+
  scale_x_discrete(breaks=c("T1", "T2", "T3", "TC"),
        labels=c("Sprinkler", "Feeding", "Interactive","Control"))

ggboxplot(parametersFragGRTSM, x = "genotype", y = "thermal_safety_margin", color= "black", fill="treatment", outlier.shape = 1) +
  ylab('TSM')+
  xlab('Genotype')+
  scale_fill_manual(values = c('#66CCFF','#FFFF00', '#FF00CC', '#66FF33'))
```

parametersFragGPTSM 
Parameter Comparisons- TSM GP

```{r}
  parametersFragGPTSM

##Checking non logged transformed portein data
ggdensity(parametersFragGPTSM$thermal_safety_margin, 
          main = "Density plot of Thermal Safety Margin",
          xlab = "Thermal Safety Margin")
#SKEWED
ggqqplot(parametersFragGPTSM$thermal_safety_margin)
# large outlier
mPGPsp<-lm(thermal_safety_margin~genotype*treatment,parametersFragGPTSM)
summary(mPGPsp)
mPGPsp2<-aov(thermal_safety_margin~genotype*treatment,parametersFragGPTSM)
summary(mPGPsp2)
anova(mPGPsp)
## check for outliers
cooksd <- cooks.distance(mPGPsp)
plot(cooksd, pch=".", cex=2, main="Influential Obs by Cooks distance")  # plot cook's distance
abline(h = 4*mean(cooksd, na.rm=TRUE), col="red")  # add cutoff line--In general use, those observations that have a cook’s distance greater than 4 times the mean may be classified as influential. This is not a hard boundary.
text(x=1:length(cooksd)+1, y=cooksd, labels=ifelse(cooksd>4*mean(cooksd, na.rm=TRUE),names(cooksd),""), cex=0.6, pos=2, col="red")
#Remove GP		K201d- 20.153 [4]
parametersFragGPTSMo<-parametersFragGPTSM%>%
  filter(fragmentI!="K201d")

shapiro.test(parametersFragGPTSMo$thermal_safety_margin)
#7.319e-6*
##Non-normal data
bartlett.test(thermal_safety_margin~interaction(treatment,genotype), data=parametersFragGPTSMo)
bartlett.test(thermal_safety_margin~treatment, data=parametersFragGPTSMo)
bartlett.test(thermal_safety_margin~genotype, data=parametersFragGPTSMo)
leveneTest(thermal_safety_margin~treatment, data=parametersFragGPTSMo)
leveneTest(thermal_safety_margin~genotype, data=parametersFragGPTSMo)
leveneTest(thermal_safety_margin ~ treatment*genotype, data = parametersFragGPTSMo)
fligner.test(thermal_safety_margin~treatment, data=parametersFragGPTSMo)
fligner.test(thermal_safety_margin~genotype, data=parametersFragGPTSMo)
# Normal data and equal variance 
#Log parameter
parametersFragGPTSMo$logthermal_safety_margin<-log(parametersFragGPTSMo$thermal_safety_margin+1)

##Checking non logged transformed portein data
ggdensity(parametersFragGPTSMo$logthermal_safety_margin, 
          main = "Density plot of Thermal Safety Margins",
          xlab = "Thermal Safety Margins")
#SKEWED
ggqqplot(parametersFragGPTSMo$logthermal_safety_margin)
shapiro.test(parametersFragGPTSMo$logthermal_safety_margin)
#3.965e-5*
bartlett.test(logthermal_safety_margin~interaction(treatment,genotype), data=parametersFragGPTSMo)
bartlett.test(logthermal_safety_margin~treatment, data=parametersFragGPTSMo)
bartlett.test(logthermal_safety_margin~genotype, data=parametersFragGPTSMo)
leveneTest(logthermal_safety_margin~treatment, data=parametersFragGPTSMo)
leveneTest(logthermal_safety_margin~genotype, data=parametersFragGPTSMo)
leveneTest(logthermal_safety_margin ~ treatment*genotype, data = parametersFragGPTSMo)
fligner.test(logthermal_safety_margin~treatment, data=parametersFragGPTSMo)
fligner.test(logthermal_safety_margin~genotype, data=parametersFragGPTSMo)
#logit
parametersFragGPTSMo$logitthermal_safety_margin<-car::logit(parametersFragGPTSMo$thermal_safety_margin)

###Checking non logged transformed portein data
ggdensity(parametersFragGPTSMo$logitthermal_safety_margin,na.rm = TRUE, 
          main = "Density plot of Thermal Safety Margins",
          xlab = "Thermal Safety Margins")
#SKEWED
ggqqplot(parametersFragGPTSMo$logitthermal_safety_margin,na.rm = TRUE)
shapiro.test(parametersFragGPTSMo$logitthermal_safety_margin)
#5.322e-5*
bartlett.test(logitthermal_safety_margin~interaction(treatment,genotype), data=parametersFragGPTSMo)
bartlett.test(logitthermal_safety_margin~treatment,data=parametersFragGPTSMo)
bartlett.test(logitthermal_safety_margin~genotype,data=parametersFragGPTSMo)
leveneTest(logitthermal_safety_margin~treatment, data=parametersFragGPTSMo)
leveneTest(logitthermal_safety_margin~genotype, data=parametersFragGPTSMo)
leveneTest(logitthermal_safety_margin ~ treatment*genotype, data = parametersFragGPTSMo)
fligner.test(logitthermal_safety_margin~treatment, data=parametersFragGPTSMo)
fligner.test(logitthermal_safety_margin~genotype, data=parametersFragGPTSMo)
#Data not normal with equal variance- Nonparametric tests
```

Nonparametric test TSM GP
NSD

```{r}

parametersFragGPTSMo %>% 
  group_by(genotype,treatment) %>%
  rstatix::get_summary_stats(thermal_safety_margin, type = "common")

res.kruskal <- parametersFragGPTSMo %>% kruskal_test(thermal_safety_margin ~ treatment)
res.kruskal
#stat 2.16 df 3 pvalue= 0.54
res.kruskal2 <- parametersFragGPTSMo %>% kruskal_test(thermal_safety_margin ~ genotype)
res.kruskal2
# stat 2.01  df 2 p-value 0.367
#EFFECT SIZE
parametersFragGPTSMo %>% kruskal_effsize(thermal_safety_margin ~ treatment)
# -0.02400-- small
parametersFragGPTSMo %>% kruskal_effsize(thermal_safety_margin ~ genotype)
# 1.48e-4 -- small
# Pairwise comparisons
pwcCP <- parametersFragGPTSMo %>% 
  dunn_test(thermal_safety_margin ~ treatment, p.adjust.method = "bonferroni") 
pwcCP
#NA no differences between treatments
pwcCPg <- parametersFragGPTSMo %>% 
  dunn_test(thermal_safety_margin ~ genotype, p.adjust.method = "bonferroni") 
pwcCPg
#NA no differences between genotypes
pwcCP <- pwcCP %>% add_xy_position(x = "treatment")
pwcCPg <- pwcCPg %>% add_xy_position(x = "genotype")

mod<-lm(thermal_safety_margin~treatment*genotype,parametersFragGPTSMo)

effects::allEffects(mod)
summary(mod)
#F 0.5142 df 34 p-value- 0.8802
parametersFragGPTSMo$cat <- paste(parametersFragGPTSMo$treatment,parametersFragGPTSMo$genotype)

res.kruskalD <- parametersFragGPTSMo %>% kruskal_test(thermal_safety_margin ~ cat)
res.kruskalD
# stat 7.42 df 11 p-value 0.764
#EFFECT SIZE
parametersFragGPTSMo %>% kruskal_effsize(thermal_safety_margin ~ cat)
# -0.105 - moderate
dunn.test(parametersFragGPTSMo$thermal_safety_margin, parametersFragGPTSMo$cat, method="bh")
#Chi^2= 7.4177 df= 11 p-value= 0.76
pwcD <- parametersFragGPTSMo %>% 
  dunn_test(thermal_safety_margin ~ cat, p.adjust.method = "bonferroni") 
pwcD
pwcD <- pwcD %>% add_xy_position(x = "cat")
#NS
treaTSMGPP<-ggboxplot(parametersFragGPTSMo, x = "treatment", y = "thermal_safety_margin", color= "black", fill="treatment", outlier.shape = 1) +
  stat_boxplot(geom='errorbar', linetype=1, width=0.5)+  #whiskers
  ylab('Thermal Safety Margin')+
  xlab('Treatment')+
  ggtitle(' Thermal Safety Margin GP')+
  scale_fill_manual(values = c('#66CCFF','#FFFF00', '#FF00CC', '#66FF33'))+
  stat_summary(fun.y=mean, geom="point", size=2)+ #line is median, and closed circle is mean
  scale_x_discrete(breaks=c("T1", "T2", "T3", "TC"),
        labels=c("Sprinkler", "Feeding", "Interactive","Control"))+
   stat_pvalue_manual(pwcCP, hide.ns = TRUE) +
  labs(
    subtitle = get_test_label(res.kruskal, detailed = TRUE),
    caption = get_pwc_label(pwcCP)
    )
treaTSMGPP
ggexport(treaTSMGPP, filename = "TSMPKWplottrea.pdf")

genoTSMGPP<-ggboxplot(parametersFragGPTSMo, x = "genotype", y = "thermal_safety_margin", color= "black", fill="genotype", outlier.shape = 1) +
  stat_boxplot(geom='errorbar', linetype=1, width=0.5)+  #whiskers
  ylab('Thermal Safety Margin')+
  xlab('Genotype')+
  ggtitle('Thermal Safety Margin GP')+
  scale_fill_manual(values = c('red','green4', 'blue'))+
  stat_summary(fun.y=mean, geom="point", size=2)+ #line is median, and closed circle is mean
   stat_pvalue_manual(pwcCPg, hide.ns = TRUE) +
  labs(
    subtitle = get_test_label(res.kruskal2, detailed = TRUE),
    caption = get_pwc_label(pwcCPg)
    )
genoTSMGPP
ggexport(genoTSMGPP, filename = "TSMPKWplotgeno.pdf")


inteTSMGPPP<-ggboxplot(parametersFragGPTSMo, x = "cat", y = "thermal_safety_margin", color= "black", fill="genotype", outlier.shape = 1) +
  stat_boxplot(geom='errorbar', linetype=1, width=0.5)+  #whiskers
  ylab('Thermal Safety Margin')+
  xlab('')+
  ggtitle('Thermal Safety Margin GP')+
  scale_fill_manual(values = c('red','green4', 'blue'))+
  stat_summary(fun.y=mean, geom="point", size=2)+ #line is median, and closed circle is mean
   stat_pvalue_manual(pwcD, hide.ns = TRUE)+
  labs(
    subtitle = get_test_label(res.kruskalD, detailed = TRUE),
    caption = get_pwc_label(pwcD)
    )
inteTSMGPPP
ggexport(inteTSMGPPP, filename = "TSMPKWplot.interer.pdf")

ggboxplot(parametersFragGPTSMo, x = "treatment", y = "thermal_safety_margin", color= "black", fill="genotype", outlier.shape = 1) +
  ylab('Thermal Safety Margin')+
  xlab('Treatment')+
  scale_fill_manual(values = c('red','green4', 'blue'))+
  stat_summary(fun.y=mean, geom="point", size=2)+
  scale_x_discrete(breaks=c("T1", "T2", "T3", "TC"),
        labels=c("Sprinkler", "Feeding", "Interactive","Control"))

ggboxplot(parametersFragGPTSMo, x = "genotype", y = "thermal_safety_margin", color= "black", fill="treatment", outlier.shape = 1) +
  ylab('Thermal Safety Margin')+
  xlab('Genotype')+
  scale_fill_manual(values = c('#66CCFF','#FFFF00', '#FF00CC', '#66FF33'))
```

